{"ast":null,"code":"const utils = require(\"../utils/utils\");\n\nconst socketIO = require(\"socket.io-client\");\n\nexport function initSocket() {\n  if (!this.state.isLoggedIn) {\n    return false;\n  }\n\n  if (typeof window.customVariables.socket !== \"undefined\") {\n    return false;\n  }\n\n  let sock = undefined;\n  sock = socketIO(\"https://socket.filen.io\", {\n    path: \"\",\n    reconnect: true,\n    transports: [\"websocket\"]\n  });\n  console.log(sock);\n  sock.on(\"connect\", () => {\n    this.setState({\n      socketConnected: true\n    });\n    sock.emit(\"auth\", {\n      apiKey: this.state.userAPIKey || \"\"\n    });\n    clearInterval(window.customVariables.socketPingInterval);\n    window.customVariables.socketPingInterval = setInterval(() => {\n      sock.emit(\"heartbeat\");\n    }, 5000);\n    console.log(\"Connected to socket server\");\n  });\n  sock.on(\"disconnect\", err => {\n    console.log(err);\n    this.setState({\n      socketConnected: false\n    });\n    console.log(\"Disconnected from socket server\");\n  });\n  sock.on(\"new-event\", data => {\n    console.log(data);\n  });\n}\nexport function sendSocket(message, data) {\n  if (!this.state.isLoggedIn) {\n    return false;\n  }\n\n  if (typeof window.customVariables.socket == \"undefined\") {\n    return false;\n  }\n\n  window.customVariables.socket.emit(message, data);\n  return true;\n}","map":{"version":3,"sources":["/Users/jan/Documents/filen/app/src/components/socket.js"],"names":["utils","require","socketIO","initSocket","state","isLoggedIn","window","customVariables","socket","sock","undefined","path","reconnect","transports","console","log","on","setState","socketConnected","emit","apiKey","userAPIKey","clearInterval","socketPingInterval","setInterval","err","data","sendSocket","message"],"mappings":"AAAA,MAAMA,KAAK,GAAGC,OAAO,CAAC,gBAAD,CAArB;;AACA,MAAMC,QAAQ,GAAGD,OAAO,CAAC,kBAAD,CAAxB;;AAEA,OAAO,SAASE,UAAT,GAAqB;AACxB,MAAG,CAAC,KAAKC,KAAL,CAAWC,UAAf,EAA0B;AACtB,WAAO,KAAP;AACH;;AAED,MAAG,OAAOC,MAAM,CAACC,eAAP,CAAuBC,MAA9B,KAAyC,WAA5C,EAAwD;AACpD,WAAO,KAAP;AACH;;AAED,MAAIC,IAAI,GAAGC,SAAX;AAEAD,EAAAA,IAAI,GAAGP,QAAQ,CAAC,yBAAD,EAA4B;AAC7CS,IAAAA,IAAI,EAAE,EADuC;AAE7CC,IAAAA,SAAS,EAAE,IAFkC;AAG7CC,IAAAA,UAAU,EAAE,CACX,WADW;AAHiC,GAA5B,CAAf;AAQAC,EAAAA,OAAO,CAACC,GAAR,CAAYN,IAAZ;AAEAA,EAAAA,IAAI,CAACO,EAAL,CAAQ,SAAR,EAAmB,MAAM;AACrB,SAAKC,QAAL,CAAc;AACVC,MAAAA,eAAe,EAAE;AADP,KAAd;AAIAT,IAAAA,IAAI,CAACU,IAAL,CAAU,MAAV,EAAkB;AACvBC,MAAAA,MAAM,EAAE,KAAKhB,KAAL,CAAWiB,UAAX,IAAyB;AADV,KAAlB;AAIAC,IAAAA,aAAa,CAAChB,MAAM,CAACC,eAAP,CAAuBgB,kBAAxB,CAAb;AAEAjB,IAAAA,MAAM,CAACC,eAAP,CAAuBgB,kBAAvB,GAA4CC,WAAW,CAAC,MAAM;AAC1Df,MAAAA,IAAI,CAACU,IAAL,CAAU,WAAV;AACH,KAFsD,EAEpD,IAFoD,CAAvD;AAIAL,IAAAA,OAAO,CAACC,GAAR,CAAY,4BAAZ;AACH,GAhBD;AAkBAN,EAAAA,IAAI,CAACO,EAAL,CAAQ,YAAR,EAAuBS,GAAD,IAAS;AAC3BX,IAAAA,OAAO,CAACC,GAAR,CAAYU,GAAZ;AAEA,SAAKR,QAAL,CAAc;AACVC,MAAAA,eAAe,EAAE;AADP,KAAd;AAIAJ,IAAAA,OAAO,CAACC,GAAR,CAAY,iCAAZ;AACH,GARD;AAUAN,EAAAA,IAAI,CAACO,EAAL,CAAQ,WAAR,EAAsBU,IAAD,IAAU;AAC3BZ,IAAAA,OAAO,CAACC,GAAR,CAAYW,IAAZ;AACH,GAFD;AAGH;AAED,OAAO,SAASC,UAAT,CAAoBC,OAApB,EAA6BF,IAA7B,EAAkC;AACrC,MAAG,CAAC,KAAKtB,KAAL,CAAWC,UAAf,EAA0B;AACtB,WAAO,KAAP;AACH;;AAED,MAAG,OAAOC,MAAM,CAACC,eAAP,CAAuBC,MAA9B,IAAwC,WAA3C,EAAuD;AACnD,WAAO,KAAP;AACH;;AAEDF,EAAAA,MAAM,CAACC,eAAP,CAAuBC,MAAvB,CAA8BW,IAA9B,CAAmCS,OAAnC,EAA4CF,IAA5C;AAEA,SAAO,IAAP;AACH","sourcesContent":["const utils = require(\"../utils/utils\")\nconst socketIO = require(\"socket.io-client\")\n\nexport function initSocket(){\n    if(!this.state.isLoggedIn){\n        return false\n    }\n\n    if(typeof window.customVariables.socket !== \"undefined\"){\n        return false\n    }\n\n    let sock = undefined\n\n    sock = socketIO(\"https://socket.filen.io\", {\n\t\tpath: \"\",\n\t\treconnect: true,\n\t\ttransports: [\n\t\t\t\"websocket\"\n\t\t]\n\t})\n\n    console.log(sock)\n\n    sock.on(\"connect\", () => {\n        this.setState({\n            socketConnected: true\n        })\n\n        sock.emit(\"auth\", {\n\t\t\tapiKey: this.state.userAPIKey || \"\"\n\t\t})\n\n        clearInterval(window.customVariables.socketPingInterval)\n\n        window.customVariables.socketPingInterval = setInterval(() => {\n            sock.emit(\"heartbeat\")\n        }, 5000)\n\n        console.log(\"Connected to socket server\")\n    })\n\n    sock.on(\"disconnect\", (err) => {\n        console.log(err)\n\n        this.setState({\n            socketConnected: false\n        })\n\n        console.log(\"Disconnected from socket server\")\n    })\n\n    sock.on(\"new-event\", (data) => {\n        console.log(data)\n    })\n}\n\nexport function sendSocket(message, data){\n    if(!this.state.isLoggedIn){\n        return false\n    }\n\n    if(typeof window.customVariables.socket == \"undefined\"){\n        return false\n    }\n\n    window.customVariables.socket.emit(message, data)\n\n    return true\n}"]},"metadata":{},"sourceType":"module"}