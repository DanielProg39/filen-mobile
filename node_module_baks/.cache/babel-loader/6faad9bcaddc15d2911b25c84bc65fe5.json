{"ast":null,"code":"import _regeneratorRuntime from\"/Users/jan/Documents/filen/app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/jan/Documents/filen/app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import{Plugins,StatusBarStyle,Capacitor}from\"@capacitor/core\";import{modalController,popoverController,actionSheetController,loadingController,alertController}from\"@ionic/core\";import*as language from\"../utils/language\";export function setupListeners(){var _this=this;if(Capacitor.isNative){Plugins.App.addListener(\"backButton\",/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var goBackHistory,isModalActive,isPopoverActive,isActionSheetActive,isLoadingActive,isAlertActive,origin;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:goBackHistory=true;if(_this.state.searchbarOpen){_this.hideMainSearchbar(false);goBackHistory=false;}_context.next=4;return modalController.getTop();case 4:isModalActive=_context.sent;if(isModalActive&&_this.state.isLoggedIn){window.customFunctions.dismissModal();goBackHistory=false;}_context.next=8;return popoverController.getTop();case 8:isPopoverActive=_context.sent;if(isPopoverActive&&_this.state.isLoggedIn){window.customFunctions.dismissPopover();goBackHistory=false;}_context.next=12;return actionSheetController.getTop();case 12:isActionSheetActive=_context.sent;if(isActionSheetActive&&_this.state.isLoggedIn){window.customFunctions.dismissActionSheet();goBackHistory=false;}_context.next=16;return loadingController.getTop();case 16:isLoadingActive=_context.sent;if(isLoadingActive){goBackHistory=false;}if(_this.state.selectedItems>0&&_this.state.isLoggedIn){_this.clearSelectedItems();goBackHistory=false;}_context.next=21;return alertController.getTop();case 21:isAlertActive=_context.sent;if(isAlertActive&&_this.state.isLoggedIn){window.customFunctions.dismissAlert();goBackHistory=false;}origin=window.location.origin;if(window.location.href==origin||window.location.href==origin+\"/\"||window.location.href==origin+\"/#\"||window.location.href==origin+\"/#!\"||window.location.href==origin+\"/#/\"||window.location.href==origin+\"/index.html\"||window.location.href==origin+\"/index.html#!/\"||window.location.href==origin+\"/index.html#!\"||window.location.href==origin+\"/index.html#\"||window.location.href==origin+\"/#!/base\"||window.location.href==origin+\"/index.html#!/base\"||window.location.href==origin+\"/#!/shared-in\"||window.location.href==origin+\"/index.html#!/shared-in\"||window.location.href==origin+\"/#!/shared-out\"||window.location.href==origin+\"/index.html#!/shared-out\"||window.location.href==origin+\"/#!/trash\"||window.location.href==origin+\"/index.html#!/trash\"||window.location.href==origin+\"/#!/links\"||window.location.href==origin+\"/index.html#!/links\"){goBackHistory=false;}if(goBackHistory){window.history.back();}case 26:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}());}}export function setupStatusbar(){return _setupStatusbar.apply(this,arguments);}function _setupStatusbar(){_setupStatusbar=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var type,_args2=arguments;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:type=_args2.length>0&&_args2[0]!==undefined?_args2[0]:\"normal\";if(Capacitor.isNative){if(type==\"normal\"){if(this.state.darkMode){Plugins.StatusBar.setBackgroundColor({color:\"#1F1F1F\"});Plugins.StatusBar.setStyle({style:StatusBarStyle.Dark});if(Capacitor.platform==\"android\"){window.NavigationBar.backgroundColorByHexString(\"#1F1F1F\",false);}}else{Plugins.StatusBar.setBackgroundColor({color:\"#ffffff\"});Plugins.StatusBar.setStyle({style:StatusBarStyle.Light});if(Capacitor.platform==\"android\"){window.NavigationBar.backgroundColorByHexString(\"#ffffff\",true);}}}else if(type==\"image/video\"){Plugins.StatusBar.setBackgroundColor({color:\"#000000\"});Plugins.StatusBar.setStyle({style:StatusBarStyle.Dark});if(Capacitor.platform==\"android\"){window.NavigationBar.backgroundColorByHexString(\"#000000\",false);}}else if(type==\"login/register\"){if(this.state.darkMode){Plugins.StatusBar.setBackgroundColor({color:\"#121212\"});Plugins.StatusBar.setStyle({style:StatusBarStyle.Dark});if(Capacitor.platform==\"android\"){window.NavigationBar.backgroundColorByHexString(\"#121212\",false);}}else{Plugins.StatusBar.setBackgroundColor({color:\"#ffffff\"});Plugins.StatusBar.setStyle({style:StatusBarStyle.Light});if(Capacitor.platform==\"android\"){window.NavigationBar.backgroundColorByHexString(\"#ffffff\",true);}}}Plugins.StatusBar.setOverlaysWebView({overlay:false});}case 2:case\"end\":return _context2.stop();}}},_callee2,this);}));return _setupStatusbar.apply(this,arguments);}export function doSetup(){return _doSetup.apply(this,arguments);}function _doSetup(){_doSetup=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var _this2=this;var getLang,getDarkMode,getIsLoggedIn,getUserAPIKey,getUserEmail,getUserMasterKeys,getUserPublicKey,getUserPrivateKey,getOfflineSavedFiles,getAPICache,getSettings,getCachedFiles,getCachedFolders,getCachedMetadata,getThumbnailCache,getGetThumbnailErrors,deviceLang,defaultLang,settings;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return Plugins.Storage.get({key:\"lang\"});case 2:getLang=_context3.sent;_context3.next=5;return Plugins.Storage.get({key:\"darkMode\"});case 5:getDarkMode=_context3.sent;_context3.next=8;return Plugins.Storage.get({key:\"isLoggedIn\"});case 8:getIsLoggedIn=_context3.sent;_context3.next=11;return Plugins.Storage.get({key:\"userAPIKey\"});case 11:getUserAPIKey=_context3.sent;_context3.next=14;return Plugins.Storage.get({key:\"userEmail\"});case 14:getUserEmail=_context3.sent;_context3.next=17;return Plugins.Storage.get({key:\"userMasterKeys\"});case 17:getUserMasterKeys=_context3.sent;_context3.next=20;return Plugins.Storage.get({key:\"userPublicKey\"});case 20:getUserPublicKey=_context3.sent;_context3.next=23;return Plugins.Storage.get({key:\"userPrivateKey\"});case 23:getUserPrivateKey=_context3.sent;_context3.next=26;return Plugins.Storage.get({key:\"offlineSavedFiles\"});case 26:getOfflineSavedFiles=_context3.sent;_context3.next=29;return Plugins.Storage.get({key:\"apiCache\"});case 29:getAPICache=_context3.sent;_context3.next=32;return Plugins.Storage.get({key:\"settings\"});case 32:getSettings=_context3.sent;_context3.next=35;return Plugins.Storage.get({key:\"cachedFiles\"});case 35:getCachedFiles=_context3.sent;_context3.next=38;return Plugins.Storage.get({key:\"cachedFolders\"});case 38:getCachedFolders=_context3.sent;_context3.next=41;return Plugins.Storage.get({key:\"cachedMetadata\"});case 41:getCachedMetadata=_context3.sent;_context3.next=44;return Plugins.Storage.get({key:\"thumbnailCache\"});case 44:getThumbnailCache=_context3.sent;_context3.next=47;return Plugins.Storage.get({key:\"getThumbnailErrors\"});case 47:getGetThumbnailErrors=_context3.sent;if(!getLang.value){_context3.next=53;break;}this.setState({lang:getLang.value,mainToolbarTitle:language.get(getLang.value,\"myCloud\")});window.customVariables.lang=getLang.value;_context3.next=60;break;case 53:_context3.next=55;return Plugins.Device.getLanguageCode();case 55:deviceLang=_context3.sent;defaultLang=\"en\";if(language.isAvailable(deviceLang.value)){defaultLang=deviceLang.value;}this.setState({lang:defaultLang,mainToolbarTitle:language.get(defaultLang,\"myCloud\")});window.customVariables.lang=defaultLang;case 60:if(getDarkMode.value==null){document.body.classList.toggle(\"dark\",true);this.setState({darkMode:true});}else{if(getDarkMode.value==\"true\"){document.body.classList.toggle(\"dark\",true);this.setState({darkMode:true});}else{document.body.classList.toggle(\"dark\",false);this.setState({darkMode:false});}}this.setupStatusbar();if(!(getIsLoggedIn.value==null)){_context3.next=66;break;}return _context3.abrupt(\"return\",this.showLogin());case 66:if(!(getIsLoggedIn.value==\"true\")){_context3.next=79;break;}settings={onlyWifi:false};if(typeof getSettings.value==\"string\"){settings=JSON.parse(getSettings.value);}this.setState({userAPIKey:getUserAPIKey.value,userEmail:getUserEmail.value,userMasterKeys:JSON.parse(getUserMasterKeys.value),userPublicKey:getUserPublicKey.value,userPrivateKey:getUserPrivateKey.value,isLoggedIn:true,settings:settings});if(getOfflineSavedFiles.value==null){window.customVariables.offlineSavedFiles={};}else{window.customVariables.offlineSavedFiles=JSON.parse(getOfflineSavedFiles.value);}if(getAPICache.value==null){window.customVariables.apiCache={};}else{window.customVariables.apiCache=JSON.parse(getAPICache.value);}if(getCachedFiles.value==null){window.customVariables.cachedFiles={};}else{window.customVariables.cachedFiles=JSON.parse(getCachedFiles.value);}if(getCachedFolders.value==null){window.customVariables.cachedFolders={};}else{window.customVariables.cachedFolders=JSON.parse(getCachedFolders.value);}if(getCachedMetadata.value==null){window.customVariables.cachedMetadata={};}else{window.customVariables.cachedMetadata=JSON.parse(getCachedMetadata.value);}if(getThumbnailCache.value==null){window.customVariables.thumbnailCache={};}else{window.customVariables.thumbnailCache=JSON.parse(getThumbnailCache.value);}if(getGetThumbnailErrors.value==null){window.customVariables.getThumbnailErrors={};}else{window.customVariables.getThumbnailErrors=JSON.parse(getGetThumbnailErrors.value);}_context3.next=80;break;case 79:return _context3.abrupt(\"return\",this.showLogin());case 80:window.customVariables.apiKey=getUserAPIKey.value;this.updateUserKeys();this.updateUserUsage();clearInterval(window.customVariables.keyUpdateInterval);window.customVariables.keyUpdateInterval=setInterval(function(){_this2.updateUserKeys();},60000);clearInterval(window.customVariables.usageUpdateInterval);window.customVariables.usageUpdateInterval=setInterval(function(){_this2.updateUserUsage();},60000);clearInterval(window.customVariables.getNetworkInfoInterval);window.customVariables.getNetworkInfoInterval=setInterval(function(){window.customFunctions.getNetworkInfo();},60000);return _context3.abrupt(\"return\",this.routeTo(\"/base\"));case 90:case\"end\":return _context3.stop();}}},_callee3,this);}));return _doSetup.apply(this,arguments);}","map":{"version":3,"sources":["/Users/jan/Documents/filen/app/src/components/setup.js"],"names":["Plugins","StatusBarStyle","Capacitor","modalController","popoverController","actionSheetController","loadingController","alertController","language","setupListeners","isNative","App","addListener","e","goBackHistory","state","searchbarOpen","hideMainSearchbar","getTop","isModalActive","isLoggedIn","window","customFunctions","dismissModal","isPopoverActive","dismissPopover","isActionSheetActive","dismissActionSheet","isLoadingActive","selectedItems","clearSelectedItems","isAlertActive","dismissAlert","origin","location","href","history","back","setupStatusbar","type","darkMode","StatusBar","setBackgroundColor","color","setStyle","style","Dark","platform","NavigationBar","backgroundColorByHexString","Light","setOverlaysWebView","overlay","doSetup","Storage","get","key","getLang","getDarkMode","getIsLoggedIn","getUserAPIKey","getUserEmail","getUserMasterKeys","getUserPublicKey","getUserPrivateKey","getOfflineSavedFiles","getAPICache","getSettings","getCachedFiles","getCachedFolders","getCachedMetadata","getThumbnailCache","getGetThumbnailErrors","value","setState","lang","mainToolbarTitle","customVariables","Device","getLanguageCode","deviceLang","defaultLang","isAvailable","document","body","classList","toggle","showLogin","settings","onlyWifi","JSON","parse","userAPIKey","userEmail","userMasterKeys","userPublicKey","userPrivateKey","offlineSavedFiles","apiCache","cachedFiles","cachedFolders","cachedMetadata","thumbnailCache","getThumbnailErrors","apiKey","updateUserKeys","updateUserUsage","clearInterval","keyUpdateInterval","setInterval","usageUpdateInterval","getNetworkInfoInterval","getNetworkInfo","routeTo"],"mappings":"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","sourcesContent":["import { Plugins, StatusBarStyle, Capacitor } from \"@capacitor/core\"\r\nimport { modalController, popoverController, actionSheetController, loadingController, alertController } from \"@ionic/core\"\r\nimport * as language from \"../utils/language\"\r\n\r\nexport function setupListeners(){\r\n    if(Capacitor.isNative){\r\n        Plugins.App.addListener(\"backButton\", async (e) => {\r\n            let goBackHistory = true\r\n\r\n            if(this.state.searchbarOpen){\r\n                this.hideMainSearchbar(false)\r\n\r\n                goBackHistory = false\r\n            }\r\n\r\n            let isModalActive = await modalController.getTop()\r\n\r\n            if(isModalActive && this.state.isLoggedIn){\r\n                window.customFunctions.dismissModal()\r\n\r\n                goBackHistory = false\r\n            }\r\n\r\n            let isPopoverActive = await popoverController.getTop()\r\n\r\n            if(isPopoverActive && this.state.isLoggedIn){\r\n                window.customFunctions.dismissPopover()\r\n\r\n                goBackHistory = false\r\n            }\r\n\r\n            let isActionSheetActive = await actionSheetController.getTop()\r\n\r\n            if(isActionSheetActive && this.state.isLoggedIn){\r\n                window.customFunctions.dismissActionSheet()\r\n\r\n                goBackHistory = false\r\n            }\r\n\r\n            let isLoadingActive = await loadingController.getTop()\r\n\r\n            if(isLoadingActive){\r\n                goBackHistory = false\r\n            }\r\n\r\n            if(this.state.selectedItems > 0 && this.state.isLoggedIn){\r\n                this.clearSelectedItems()\r\n\r\n                goBackHistory = false\r\n            }\r\n\r\n            let isAlertActive = await alertController.getTop()\r\n\r\n            if(isAlertActive && this.state.isLoggedIn){\r\n                window.customFunctions.dismissAlert()\r\n\r\n                goBackHistory = false\r\n            }\r\n\r\n            let origin = window.location.origin\r\n\r\n            if(window.location.href == origin \r\n            || window.location.href == origin + \"/\" \r\n            || window.location.href == origin + \"/#\" \r\n            || window.location.href == origin + \"/#!\" \r\n            || window.location.href == origin + \"/#/\"\r\n            || window.location.href == origin + \"/index.html\"\r\n            || window.location.href == origin + \"/index.html#!/\"\r\n            || window.location.href == origin + \"/index.html#!\"\r\n            || window.location.href == origin + \"/index.html#\"\r\n            || window.location.href == origin + \"/#!/base\" \r\n            || window.location.href == origin + \"/index.html#!/base\"\r\n            || window.location.href == origin + \"/#!/shared-in\"\r\n            || window.location.href == origin + \"/index.html#!/shared-in\"\r\n            || window.location.href == origin + \"/#!/shared-out\"\r\n            || window.location.href == origin + \"/index.html#!/shared-out\"\r\n            || window.location.href == origin + \"/#!/trash\"\r\n            || window.location.href == origin + \"/index.html#!/trash\"\r\n            || window.location.href == origin + \"/#!/links\"\r\n            || window.location.href == origin + \"/index.html#!/links\"){\r\n                goBackHistory = false\r\n            }\r\n\r\n            if(goBackHistory){\r\n                window.history.back()\r\n            }\r\n        })\r\n    }\r\n}\r\n\r\nexport async function setupStatusbar(type = \"normal\"){\r\n    if(Capacitor.isNative){\r\n        if(type == \"normal\"){\r\n            if(this.state.darkMode){\r\n                Plugins.StatusBar.setBackgroundColor({\r\n                    color: \"#1F1F1F\"\r\n                })\r\n                \r\n                Plugins.StatusBar.setStyle({\r\n                    style: StatusBarStyle.Dark\r\n                })\r\n\r\n                if(Capacitor.platform == \"android\"){\r\n                    window.NavigationBar.backgroundColorByHexString(\"#1F1F1F\", false)\r\n                }\r\n            }\r\n            else{\r\n                Plugins.StatusBar.setBackgroundColor({\r\n                    color: \"#ffffff\"\r\n                })\r\n                \r\n                Plugins.StatusBar.setStyle({\r\n                    style: StatusBarStyle.Light\r\n                })\r\n\r\n                if(Capacitor.platform == \"android\"){\r\n                    window.NavigationBar.backgroundColorByHexString(\"#ffffff\", true)\r\n                }\r\n            }\r\n        }\r\n        else if(type == \"image/video\"){\r\n            Plugins.StatusBar.setBackgroundColor({\r\n                color: \"#000000\"\r\n            })\r\n            \r\n            Plugins.StatusBar.setStyle({\r\n                style: StatusBarStyle.Dark\r\n            })\r\n\r\n            if(Capacitor.platform == \"android\"){\r\n                window.NavigationBar.backgroundColorByHexString(\"#000000\", false)\r\n            }\r\n        }\r\n        else if(type == \"login/register\"){\r\n            if(this.state.darkMode){\r\n                Plugins.StatusBar.setBackgroundColor({\r\n                    color: \"#121212\"\r\n                })\r\n                \r\n                Plugins.StatusBar.setStyle({\r\n                    style: StatusBarStyle.Dark\r\n                })\r\n\r\n                if(Capacitor.platform == \"android\"){\r\n                    window.NavigationBar.backgroundColorByHexString(\"#121212\", false)\r\n                }\r\n            }\r\n            else{\r\n                Plugins.StatusBar.setBackgroundColor({\r\n                    color: \"#ffffff\"\r\n                })\r\n                \r\n                Plugins.StatusBar.setStyle({\r\n                    style: StatusBarStyle.Light\r\n                })\r\n\r\n                if(Capacitor.platform == \"android\"){\r\n                    window.NavigationBar.backgroundColorByHexString(\"#ffffff\", true)\r\n                }\r\n            }\r\n        }\r\n\r\n        Plugins.StatusBar.setOverlaysWebView({\r\n            overlay: false\r\n        })\r\n    }\r\n}\r\n\r\nexport async function doSetup(){\r\n    let getLang = await Plugins.Storage.get({ key: \"lang\" })\r\n    let getDarkMode = await Plugins.Storage.get({ key: \"darkMode\" })\r\n    let getIsLoggedIn = await Plugins.Storage.get({ key: \"isLoggedIn\" })\r\n    let getUserAPIKey = await Plugins.Storage.get({ key: \"userAPIKey\" })\r\n    let getUserEmail = await Plugins.Storage.get({ key: \"userEmail\" })\r\n    let getUserMasterKeys = await Plugins.Storage.get({ key: \"userMasterKeys\" })\r\n    let getUserPublicKey = await Plugins.Storage.get({ key: \"userPublicKey\" })\r\n    let getUserPrivateKey = await Plugins.Storage.get({ key: \"userPrivateKey\" })\r\n    let getOfflineSavedFiles = await Plugins.Storage.get({ key: \"offlineSavedFiles\" })\r\n    let getAPICache = await Plugins.Storage.get({ key: \"apiCache\" })\r\n    let getSettings = await Plugins.Storage.get({ key: \"settings\" })\r\n    let getCachedFiles = await Plugins.Storage.get({ key: \"cachedFiles\" })\r\n    let getCachedFolders = await Plugins.Storage.get({ key: \"cachedFolders\" })\r\n    let getCachedMetadata = await Plugins.Storage.get({ key: \"cachedMetadata\" })\r\n    let getThumbnailCache = await Plugins.Storage.get({ key: \"thumbnailCache\" })\r\n    let getGetThumbnailErrors = await Plugins.Storage.get({ key: \"getThumbnailErrors\" })\r\n\r\n    if(getLang.value){\r\n        this.setState({\r\n            lang: getLang.value,\r\n            mainToolbarTitle: language.get(getLang.value, \"myCloud\")\r\n        })\r\n\r\n        window.customVariables.lang = getLang.value\r\n    }\r\n    else{\r\n        let deviceLang = await Plugins.Device.getLanguageCode()\r\n        let defaultLang = \"en\"\r\n\r\n        if(language.isAvailable(deviceLang.value)){\r\n            defaultLang = deviceLang.value\r\n        }\r\n\r\n        this.setState({\r\n            lang: defaultLang,\r\n            mainToolbarTitle: language.get(defaultLang, \"myCloud\")\r\n        })\r\n\r\n        window.customVariables.lang = defaultLang\r\n    }\r\n\r\n    if(getDarkMode.value == null){\r\n        document.body.classList.toggle(\"dark\", true)\r\n\r\n        this.setState({\r\n            darkMode: true\r\n        })\r\n    }\r\n    else{\r\n        if(getDarkMode.value == \"true\"){\r\n            document.body.classList.toggle(\"dark\", true)\r\n\r\n            this.setState({\r\n                darkMode: true\r\n            })\r\n        }\r\n        else{\r\n            document.body.classList.toggle(\"dark\", false)\r\n\r\n            this.setState({\r\n                darkMode: false\r\n            })\r\n        }\r\n    }\r\n\r\n    this.setupStatusbar()\r\n\r\n    if(getIsLoggedIn.value == null){\r\n        return this.showLogin()\r\n    }\r\n    else{\r\n        if(getIsLoggedIn.value == \"true\"){\r\n            let settings = {\r\n                onlyWifi: false\r\n            }\r\n\r\n            if(typeof getSettings.value == \"string\"){\r\n                settings = JSON.parse(getSettings.value)\r\n            }\r\n\r\n            this.setState({\r\n                userAPIKey: getUserAPIKey.value,\r\n                userEmail: getUserEmail.value,\r\n                userMasterKeys: JSON.parse(getUserMasterKeys.value),\r\n                userPublicKey: getUserPublicKey.value,\r\n                userPrivateKey: getUserPrivateKey.value,\r\n                isLoggedIn: true,\r\n                settings: settings\r\n            })\r\n\r\n            if(getOfflineSavedFiles.value == null){\r\n                window.customVariables.offlineSavedFiles = {}\r\n            }\r\n            else{\r\n                window.customVariables.offlineSavedFiles = JSON.parse(getOfflineSavedFiles.value)\r\n            }\r\n\r\n            if(getAPICache.value == null){\r\n                window.customVariables.apiCache = {}\r\n            }\r\n            else{\r\n                window.customVariables.apiCache = JSON.parse(getAPICache.value)\r\n            }\r\n\r\n            if(getCachedFiles.value == null){\r\n                window.customVariables.cachedFiles = {}\r\n            }\r\n            else{\r\n                window.customVariables.cachedFiles = JSON.parse(getCachedFiles.value)\r\n            }\r\n\r\n            if(getCachedFolders.value == null){\r\n                window.customVariables.cachedFolders = {}\r\n            }\r\n            else{\r\n                window.customVariables.cachedFolders = JSON.parse(getCachedFolders.value)\r\n            }\r\n\r\n            if(getCachedMetadata.value == null){\r\n                window.customVariables.cachedMetadata = {}\r\n            }\r\n            else{\r\n                window.customVariables.cachedMetadata = JSON.parse(getCachedMetadata.value)\r\n            }\r\n\r\n            if(getThumbnailCache.value == null){\r\n                window.customVariables.thumbnailCache = {}\r\n            }\r\n            else{\r\n                window.customVariables.thumbnailCache = JSON.parse(getThumbnailCache.value)\r\n            }\r\n\r\n            if(getGetThumbnailErrors.value == null){\r\n                window.customVariables.getThumbnailErrors = {}\r\n            }\r\n            else{\r\n                window.customVariables.getThumbnailErrors = JSON.parse(getGetThumbnailErrors.value)\r\n            }\r\n        }\r\n        else{\r\n            return this.showLogin()\r\n        }\r\n    }\r\n\r\n    window.customVariables.apiKey = getUserAPIKey.value\r\n\r\n    this.updateUserKeys()\r\n    this.updateUserUsage()\r\n\r\n    clearInterval(window.customVariables.keyUpdateInterval)\r\n\r\n    window.customVariables.keyUpdateInterval = setInterval(() => {\r\n        this.updateUserKeys()\r\n    }, 60000)\r\n\r\n    clearInterval(window.customVariables.usageUpdateInterval)\r\n\r\n    window.customVariables.usageUpdateInterval = setInterval(() => {\r\n        this.updateUserUsage()\r\n    }, 60000)\r\n\r\n    clearInterval(window.customVariables.getNetworkInfoInterval)\r\n\r\n    window.customVariables.getNetworkInfoInterval = setInterval(() => {\r\n        window.customFunctions.getNetworkInfo()\r\n    }, 60000)\r\n\r\n    return this.routeTo(\"/base\")\r\n}"]},"metadata":{},"sourceType":"module"}