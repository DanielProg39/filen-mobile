{"ast":null,"code":"import _regeneratorRuntime from\"/Users/jan/Documents/filen/app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _createForOfIteratorHelper from\"/Users/jan/Documents/filen/app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";import _asyncToGenerator from\"/Users/jan/Documents/filen/app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import{Capacitor,Plugins}from\"@capacitor/core\";var CryptoJS=require(\"crypto-js\");var striptags=require(\"striptags\");export function sanitizeHTML(html){return striptags(html);}export function getRandomArbitrary(min,max){return Math.floor(Math.random()*(max-min)+min);}export function formatBytes(bytes){var decimals=arguments.length>1&&arguments[1]!==undefined?arguments[1]:2;if(bytes===0)return\"0 Bytes\";var k=1024;var dm=decimals<0?0:decimals;var sizes=[\"Bytes\",\"KB\",\"MB\",\"GB\",\"TB\",\"PB\",\"EB\",\"ZB\",\"YB\"];var i=Math.floor(Math.log(bytes)/Math.log(k));return parseFloat((bytes/Math.pow(k,i)).toFixed(dm))+\" \"+sizes[i];}export function uuidv4(){// Public Domain/MIT\nvar d=new Date().getTime();//Timestamp\nvar d2=performance&&performance.now&&performance.now()*1000||0;//Time in microseconds since page-load or 0 if unsupported\nreturn'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g,function(c){var r=Math.random()*16;//random number between 0 and 16\nif(d>0){//Use timestamp until depleted\nr=(d+r)%16|0;d=Math.floor(d/16);}else{//Use microseconds since page-load if supported\nr=(d2+r)%16|0;d2=Math.floor(d2/16);}return(c==='x'?r:r&0x3|0x8).toString(16);});}export function generateRandomString(){var length=arguments.length>0&&arguments[0]!==undefined?arguments[0]:32;var result=\"\";var characters=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\";for(var i=0;i<length;i++){result+=characters.charAt(Math.floor(Math.random()*characters.length));}return result;}export function generateRandomClassName(){var length=arguments.length>0&&arguments[0]!==undefined?arguments[0]:16;var result=\"\";var characters=\"abcdefghijklmnopqrstuvwxyz\";for(var i=0;i<length;i++){result+=characters.charAt(Math.floor(Math.random()*characters.length));}return result+\"-\"+result;}export function getAPIServer(){var servers=[\"https://api.filen.io\",\"https://api.filen-1.xyz\",\"https://api.filen-2.xyz\",\"https://api.filen-3.xyz\",\"https://api.filen-4.xyz\",\"https://api.filen-5.xyz\"];return servers[getRandomArbitrary(0,servers.length-1)];}export function fetchWithTimeout(ms,promise){return new Promise(function(resolve,reject){var timer=setTimeout(function(){return reject(new Error(\"Request timeout after \"+ms+\"ms\"));},ms);promise.then(function(value){clearTimeout(timer);return resolve(value);}).catch(function(err){clearTimeout(timer);return reject(err);});});}export function backgroundAPIRequest(method,endpoint){var data=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var cacheKey=method+endpoint;fetchWithTimeout(60000,fetch(getAPIServer()+endpoint,{method:method.toUpperCase(),cache:\"no-cache\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify(data)})).then(function(response){response.json().then(function(obj){window.customVariables.cachedAPIItemListRequests[cacheKey]=obj;return window.customFunctions.saveAPICache();}).catch(function(err){console.log(err);});}).catch(function(err){console.log(err);});}export function apiRequest(method,endpoint){var data=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};return new Promise(function(resolve,reject){var cacheKey=method+endpoint;/*let useFastCache = false\r\n\r\n        if(method.toUpperCase() == \"POST\"){\r\n            if(endpoint == \"/v1/dir/content\"\r\n            || endpoint == \"/v1/user/shared/in\"\r\n            || endpoint == \"/v1/user/shared/out\"){\r\n                useFastCache = true\r\n            }\r\n        }\r\n\r\n        if(useFastCache){\r\n            if(typeof window.customVariables.cachedAPIItemListRequests[cacheKey] !== \"undefined\"){\r\n                try{\r\n                    let obj = JSON.parse(window.customVariables.cachedAPIItemListRequests[cacheKey])\r\n\r\n                    delete window.customVariables.cachedAPIItemListRequests[cacheKey]\r\n\r\n                    backgroundAPIRequest(method, endpoint, data)\r\n\r\n                    return obj\r\n                }\r\n                catch(e){\r\n                    console.log(e)\r\n                }\r\n            }\r\n        }*/if(Capacitor.isNative){if(Plugins.Network.getStatus()==\"none\"){if(typeof window.customVariables.apiCache[cacheKey]!==\"undefined\"){return resolve(window.customVariables.apiCache[cacheKey]);}}}fetchWithTimeout(60000,fetch(getAPIServer()+endpoint,{method:method.toUpperCase(),cache:\"no-cache\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify(data)})).then(function(response){response.json().then(function(obj){if(endpoint==\"/v1/dir/content\"||endpoint==\"/v1/user/baseFolders\"||endpoint==\"/v1/user/shared/in\"||endpoint==\"/v1/user/shared/out\"||endpoint==\"/v1/user/keyPair/info\"){window.customVariables.apiCache[cacheKey]=obj;window.customFunctions.saveAPICache();}return resolve(obj);}).catch(function(err){console.log(err);if(typeof window.customVariables.apiCache[cacheKey]!==\"undefined\"){return resolve(window.customVariables.apiCache[cacheKey]);}return reject(err);});}).catch(function(err){console.log(err);if(typeof window.customVariables.apiCache[cacheKey]!==\"undefined\"){return resolve(window.customVariables.apiCache[cacheKey]);}return reject(err);});});}export function getDownloadServer(){var servers=[\"https://down.filen-1.xyz\",\"https://down.filen-2.xyz\",\"https://down.filen-3.xyz\",\"https://down.filen-4.xyz\",\"https://down.filen-5.xyz\"];return servers[getRandomArbitrary(0,servers.length-1)];}export function getUploadServer(){var servers=[\"https://up.filen-1.xyz\",\"https://up.filen-2.xyz\",\"https://up.filen-3.xyz\",\"https://up.filen-4.xyz\",\"https://up.filen-5.xyz\"];return servers[getRandomArbitrary(0,servers.length-1)];}export function hashFn(val){return CryptoJS.SHA1(CryptoJS.SHA512(val).toString()).toString();}export function cryptoJSEncrypt(val,key){return CryptoJS.AES.encrypt(val,key).toString();}export function cryptoJSDecrypt(val,key){return CryptoJS.AES.decrypt(val,key).toString(CryptoJS.enc.Utf8);}export function unixTimestamp(){return Math.floor(+new Date()/1000);}export function decryptCryptoJSFolderName(str,userMasterKeys){var uuid=arguments.length>2&&arguments[2]!==undefined?arguments[2]:undefined;var cacheKey=\"folder_\"+uuid+\"_\"+str;if(window.customVariables.cachedMetadata[cacheKey]){return window.customVariables.cachedMetadata[cacheKey].name;}var folderName=\"CON_NO_DECRYPT_POSSIBLE_NO_NAME_FOUND_FOR_FOLDER\";userMasterKeys=userMasterKeys.reverse();var obj=undefined;userMasterKeys.forEach(function(key){try{obj=JSON.parse(CryptoJS.AES.decrypt(str,key).toString(CryptoJS.enc.Utf8));if(obj&&typeof obj==\"object\"){folderName=obj.name;}}catch(e){return;}});if(folderName!==\"CON_NO_DECRYPT_POSSIBLE_NO_NAME_FOUND_FOR_FOLDER\"){window.customVariables.cachedMetadata[cacheKey]={name:folderName};}return folderName;}export function decryptFolderNamePrivateKey(_x,_x2){return _decryptFolderNamePrivateKey.apply(this,arguments);}function _decryptFolderNamePrivateKey(){_decryptFolderNamePrivateKey=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(str,usrPrivKey){var uuid,cacheKey,folderName,decrypted,_args=arguments;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:uuid=_args.length>2&&_args[2]!==undefined?_args[2]:undefined;cacheKey=\"folder_\"+uuid+\"_\"+str;if(!window.customVariables.cachedMetadata[cacheKey]){_context.next=4;break;}return _context.abrupt(\"return\",window.customVariables.cachedMetadata[cacheKey].name);case 4:folderName=\"CON_NO_DECRYPT_POSSIBLE_NO_NAME_FOUND_FOR_FOLDER\";_context.prev=5;_context.next=8;return window.crypto.subtle.decrypt({name:\"RSA-OAEP\"},usrPrivKey,_base64ToArrayBuffer(str));case 8:decrypted=_context.sent;decrypted=JSON.parse(new TextDecoder().decode(decrypted));if(decrypted&&typeof decrypted==\"object\"){folderName=decrypted.name;}_context.next=16;break;case 13:_context.prev=13;_context.t0=_context[\"catch\"](5);console.log(_context.t0);case 16:if(folderName!==\"CON_NO_DECRYPT_POSSIBLE_NO_NAME_FOUND_FOR_FOLDER\"){window.customVariables.cachedMetadata[cacheKey]={name:folderName};}return _context.abrupt(\"return\",folderName);case 18:case\"end\":return _context.stop();}}},_callee,null,[[5,13]]);}));return _decryptFolderNamePrivateKey.apply(this,arguments);}export function decryptFileMetadata(metadata,userMasterKeys){var uuid=arguments.length>2&&arguments[2]!==undefined?arguments[2]:undefined;var cacheKey=\"file_\"+uuid+\"_\"+metadata;if(window.customVariables.cachedMetadata[cacheKey]){var file=window.customVariables.cachedMetadata[cacheKey];return{name:file.name,size:file.size,mime:file.mime,key:file.key};}var fileName=\"\";var fileSize=0;var fileMime=\"\";var fileKey=\"\";userMasterKeys=userMasterKeys.reverse();userMasterKeys.forEach(function(key){try{var _obj=JSON.parse(CryptoJS.AES.decrypt(metadata,key).toString(CryptoJS.enc.Utf8));if(_obj&&typeof _obj==\"object\"){fileName=_obj.name;fileSize=parseInt(_obj.size);fileMime=_obj.mime;fileKey=_obj.key;}}catch(e){return;}});var obj={name:fileName,size:fileSize,mime:fileMime,key:fileKey};if(obj.name.length>=1){window.customVariables.cachedMetadata[cacheKey]=obj;}return obj;}export function decryptFileMetadataPrivateKey(_x3,_x4){return _decryptFileMetadataPrivateKey.apply(this,arguments);}function _decryptFileMetadataPrivateKey(){_decryptFileMetadataPrivateKey=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(str,usrPrivKey){var uuid,cacheKey,file,fileName,fileSize,fileMime,fileKey,decrypted,obj,_args2=arguments;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:uuid=_args2.length>2&&_args2[2]!==undefined?_args2[2]:undefined;cacheKey=\"file_\"+uuid+\"_\"+str;if(!window.customVariables.cachedMetadata[cacheKey]){_context2.next=5;break;}file=window.customVariables.cachedMetadata[cacheKey];return _context2.abrupt(\"return\",{name:file.name,size:file.size,mime:file.mime,key:file.key});case 5:fileName=\"\";fileSize=0;fileMime=\"\";fileKey=\"\";_context2.prev=9;_context2.next=12;return window.crypto.subtle.decrypt({name:\"RSA-OAEP\"},usrPrivKey,_base64ToArrayBuffer(str));case 12:decrypted=_context2.sent;decrypted=JSON.parse(new TextDecoder().decode(decrypted));if(decrypted&&typeof decrypted==\"object\"){fileName=decrypted.name;fileSize=parseInt(decrypted.size);fileMime=decrypted.mime;fileKey=decrypted.key;}_context2.next=20;break;case 17:_context2.prev=17;_context2.t0=_context2[\"catch\"](9);return _context2.abrupt(\"return\",{name:fileName,size:fileSize,mime:fileMime,key:fileKey});case 20:obj={name:fileName,size:fileSize,mime:fileMime,key:fileKey};if(obj.name.length>=1){window.customVariables.cachedMetadata[cacheKey]=obj;}return _context2.abrupt(\"return\",obj);case 23:case\"end\":return _context2.stop();}}},_callee2,null,[[9,17]]);}));return _decryptFileMetadataPrivateKey.apply(this,arguments);}export function base64ArrayBuffer(arrayBuffer){var base64='';var encodings='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';var bytes=new Uint8Array(arrayBuffer);var byteLength=bytes.byteLength;var byteRemainder=byteLength%3;var mainLength=byteLength-byteRemainder;var a,b,c,d;var chunk;// Main loop deals with bytes in chunks of 3\nfor(var i=0;i<mainLength;i=i+3){// Combine the three bytes into a single integer\nchunk=bytes[i]<<16|bytes[i+1]<<8|bytes[i+2];// Use bitmasks to extract 6-bit segments from the triplet\na=(chunk&16515072)>>18;// 16515072 = (2^6 - 1) << 18\nb=(chunk&258048)>>12;// 258048   = (2^6 - 1) << 12\nc=(chunk&4032)>>6;// 4032     = (2^6 - 1) << 6\nd=chunk&63;// 63       = 2^6 - 1\n// Convert the raw binary segments to the appropriate ASCII encoding\nbase64+=encodings[a]+encodings[b]+encodings[c]+encodings[d];}// Deal with the remaining bytes and padding\nif(byteRemainder==1){chunk=bytes[mainLength];a=(chunk&252)>>2;// 252 = (2^6 - 1) << 2\n// Set the 4 least significant bits to zero\nb=(chunk&3)<<4;// 3   = 2^2 - 1\nbase64+=encodings[a]+encodings[b]+'==';}else if(byteRemainder==2){chunk=bytes[mainLength]<<8|bytes[mainLength+1];a=(chunk&64512)>>10;// 64512 = (2^6 - 1) << 10\nb=(chunk&1008)>>4;// 1008  = (2^6 - 1) << 4\n// Set the 2 least significant bits to zero\nc=(chunk&15)<<2;// 15    = 2^4 - 1\nbase64+=encodings[a]+encodings[b]+encodings[c]+'=';}return base64;}export function selectedItemsDoesNotContainFolder(items){for(var i=0;i<items.length;i++){if(items[i].type==\"folder\"&&items[i].selected){return false;}}return true;}export function selectedItemsContainsFolder(items){for(var i=0;i<items.length;i++){if(items[i].type==\"folder\"&&items[i].selected){return true;}}return false;}export function _base64ToArrayBuffer(base64){var binary_string=window.atob(base64);var len=binary_string.length;var bytes=new Uint8Array(len);for(var i=0;i<len;i++){bytes[i]=binary_string.charCodeAt(i);}return bytes.buffer;}export function fileNameValidationRegex(name){if(/^(con|prn|aux|nul|com[0-9]|lpt[0-9])$|([<>:\"\\/\\\\|?*])|(\\.|\\s)$/ig.test(name)){return true;}return false;}export function checkIfNameIsBanned(name){var banned=[\"/\",\"\\\\\",\"?\",\"@\",\"$\",\"%\",\"[\",\"]\",\"{\",\"}\",\"&\",'\"',\"'\",\"`\",\"*\",\"=\",\"´\",\"<\",\">\",\":\",\";\",\"|\",\"§\",\"CON\",\"PRN\",\"AUX\",\"NUL\",\"COM1\",\"COM2\",\"COM3\",\"COM4\",\"COM5\",\"COM6\",\"COM7\",\"COM8\",\"COM9\",\"LPT1\",\"LPT2\",\"LPT3\",\"LPT4\",\"LPT5\",\"LPT6\",\"LPT7\",\"LPT8\",\"LPT9\"];var isBanned=false;banned.forEach(function(ban){if(name.indexOf(ban)!==-1){isBanned=true;}});return isBanned;}export function removeIllegalCharsFromString(str){str=str.split(\"'\").join(\"\");str=str.split('\"').join(\"\");str=str.split(\"´\").join(\"\");str=str.split(\"`\").join(\"\");str=str.split(\"<\").join(\"\");str=str.split(\">\").join(\"\");str=str.split(\"!\").join(\"\");str=str.split(\"^\").join(\"\");str=str.split(\":\").join(\"\");str=str.replace(/(<([^>]+)>)/ig,\"\");return str;}export function folderNameRegex(name){if(name.substring(0,1)==\".\"||name.substring(0,2)==\"..\"){return true;}return false;}export function nameRegex(name){return false;}export function isAlphaNumeric(str){var code,i,len;for(i=0,len=str.length;i<len;i++){code=str.charCodeAt(i);if(!(code>47&&code<58)&&// numeric (0-9)\n!(code>64&&code<91)&&// upper alpha (A-Z)\n!(code>96&&code<123)){// lower alpha (a-z)\nreturn false;}}return true;}export function convertWordArrayToUint8Array(wordArray){var arrayOfWords=wordArray.hasOwnProperty(\"words\")?wordArray.words:[];var length=wordArray.hasOwnProperty(\"sigBytes\")?wordArray.sigBytes:arrayOfWords.length*4;var uInt8Array=new Uint8Array(length),index=0,word,i;for(i=0;i<length;i++){word=arrayOfWords[i];uInt8Array[index++]=word>>24;uInt8Array[index++]=word>>16&0xff;uInt8Array[index++]=word>>8&0xff;uInt8Array[index++]=word&0xff;}return uInt8Array;}export function convertUint8ArrayToBinaryString(u8Array){var i,len=u8Array.length,b_str=\"\";for(i=0;i<len;i++){b_str+=String.fromCharCode(u8Array[i]);}return b_str;}export function Semaphore(max){var counter=0;var waiting=[];var take=function take(){if(waiting.length>0&&counter<max){counter++;var promise=waiting.shift();promise.resolve();}};this.acquire=function(){if(counter<max){counter++;return new Promise(function(resolve){resolve();});}else{return new Promise(function(resolve,err){waiting.push({resolve:resolve,err:err});});}};this.release=function(){counter--;take();};this.purge=function(){var unresolved=waiting.length;for(var i=0;i<unresolved;i++){waiting[i].err('Task has been purged.');}counter=0;waiting=[];return unresolved;};}/*export function checkIfItemParentIsBeingShared(parentUUID, type, metadata){\r\n    const checkIfIsSharing = async (parent, callback) => {\r\n        if(parent == \"default\" || parent == \"base\"){\r\n            return callback(false)\r\n        }\r\n\r\n        try{\r\n            var res = await apiRequest(\"POST\", \"/v1/share/dir/status\", {\r\n                apiKey: window.customVariables.apiKey,\r\n                uuid: parent\r\n            })\r\n        }\r\n        catch(e){\r\n            console.log(e)\r\n\r\n            return callback(false)\r\n        }\r\n\r\n        if(!res.status){\r\n            console.log(res.message)\r\n\r\n            return callback(false)\r\n        }\r\n\r\n        return callback(res.data.sharing, res.data.users)\r\n    }\r\n\r\n    checkIfIsSharing(parentUUID, async (status, users) => {\r\n        if(!status){\r\n            return false\r\n        }\r\n\r\n        for(let i = 0; i < users.length; i++){\r\n            let user = users[i]\r\n\r\n            try{\r\n                var usrPubKey = await window.crypto.subtle.importKey(\"spki\", _base64ToArrayBuffer(user.publicKey), {\r\n                    name: \"RSA-OAEP\",\r\n                    hash: \"SHA-512\"\r\n                }, true, [\"encrypt\"])\r\n            }\r\n            catch(e){\r\n                console.log(e)\r\n\r\n                return false\r\n            }\r\n\r\n            let mData = \"\"\r\n\r\n            if(type == \"file\"){\r\n                mData = JSON.stringify({\r\n                    name: metadata.name,\r\n                    size: parseInt(metadata.size),\r\n                    mime: metadata.mime,\r\n                    key: metadata.key\r\n                })\r\n            }\r\n            else{\r\n                mData = JSON.stringify({\r\n                    name: metadata.name\r\n                })\r\n            }\r\n            \r\n            try{\r\n                var encrypted = await window.crypto.subtle.encrypt({\r\n                    name: \"RSA-OAEP\"\r\n                }, usrPubKey, new TextEncoder().encode(mData))\r\n            }\r\n            catch(e){\r\n                console.log(e)\r\n\r\n                return false\r\n            }\r\n\r\n            try{\r\n                var res = await apiRequest(\"POST\", \"/v1/share\", {\r\n                    apiKey: window.customVariables.apiKey,\r\n                    uuid: metadata.uuid,\r\n                    parent: parentUUID,\r\n                    email: user.email,\r\n                    type,\r\n                    metadata: base64ArrayBuffer(encrypted)\r\n                })\r\n            }\r\n            catch(e){\r\n                console.log(e)\r\n\r\n                return false\r\n            }\r\n\r\n            if(!res.status){\r\n                console.log(res.message)\r\n\r\n                return false\r\n            }\r\n        }\r\n    })\r\n}\r\n\r\nexport function checkIfItemIsBeingSharedForRename(type, uuid, metadata){\r\n    const checkIfIsSharing = async (itemUUID, callback) => {\r\n        try{\r\n            var res = await apiRequest(\"POST\", \"/v1/user/shared/item/status\", {\r\n                apiKey: window.customVariables.apiKey,\r\n                uuid: itemUUID\r\n            })\r\n        }\r\n        catch(e){\r\n            console.log(e)\r\n\r\n            return callback(false)\r\n        }\r\n\r\n        if(!res.status){\r\n            console.log(res.message)\r\n\r\n            return callback(false)\r\n        }\r\n\r\n        return callback(res.data.sharing, res.data.users)\r\n    }\r\n\r\n    checkIfIsSharing(uuid, async (sharing, users) => {\r\n        if(!sharing){\r\n            return false\r\n        }\r\n\r\n        for(let i = 0; i < users.length; i++){\r\n            let user = users[i]\r\n\r\n            try{\r\n                var usrPubKey = await window.crypto.subtle.importKey(\"spki\", _base64ToArrayBuffer(user.publicKey), {\r\n                    name: \"RSA-OAEP\",\r\n                    hash: \"SHA-512\"\r\n                }, true, [\"encrypt\"])\r\n            }\r\n            catch(e){\r\n                console.log(e)\r\n\r\n                return false\r\n            }\r\n\r\n            let mData = \"\"\r\n\r\n            if(type == \"file\"){\r\n                mData = JSON.stringify({\r\n                    name: metadata.name,\r\n                    size: parseInt(metadata.size),\r\n                    mime: metadata.mime,\r\n                    key: metadata.key\r\n                })\r\n            }\r\n            else{\r\n                mData = JSON.stringify({\r\n                    name: metadata.name\r\n                })\r\n            }\r\n            \r\n            try{\r\n                var encrypted = await window.crypto.subtle.encrypt({\r\n                    name: \"RSA-OAEP\"\r\n                }, usrPubKey, new TextEncoder().encode(mData))\r\n            }\r\n            catch(e){\r\n                console.log(e)\r\n\r\n                return false\r\n            }\r\n\r\n            try{\r\n                var res = await apiRequest(\"POST\", \"/v1/user/shared/item/rename\", {\r\n                    apiKey: window.customVariables.apiKey,\r\n                    uuid,\r\n                    receiverId: user.id,\r\n                    metadata: base64ArrayBuffer(encrypted)\r\n                })\r\n            }\r\n            catch(e){\r\n                console.log(e)\r\n\r\n                return false\r\n            }\r\n\r\n            if(!res.status){\r\n                console.log(res.message)\r\n\r\n                return false\r\n            }\r\n        }\r\n    })\r\n}*/export function decryptFolderLinkKey(str,userMasterKeys){var link=\"\";if(userMasterKeys.length>1){userMasterKeys=userMasterKeys.reverse();}userMasterKeys.forEach(function(key){try{var obj=CryptoJS.AES.decrypt(str,key).toString(CryptoJS.enc.Utf8);if(obj&&typeof obj==\"string\"){if(obj.length>=16){link=obj;}}}catch(e){return;}});return link;}export function checkIfItemIsBeingSharedForRename(type,uuid,metaData,optionalCallback){var shareCheckDone=false;var linkCheckDone=false;var isItDoneInterval=undefined;var callbackFired=false;var isItDone=function isItDone(){if(shareCheckDone&&linkCheckDone){clearInterval(isItDoneInterval);if(typeof optionalCallback==\"function\"&&!callbackFired){callbackFired=true;optionalCallback();}return true;}};isItDoneInterval=setInterval(isItDone,100);var checkIfIsSharing=function checkIfIsSharing(itemUUID,tries,maxTries,callback){if(tries>=maxTries){return callback(false);}window.$.ajax({url:getAPIServer()+\"/v1/user/shared/item/status\",type:\"POST\",contentType:\"application/json\",data:JSON.stringify({apiKey:window.customVariables.apiKey,uuid:itemUUID}),processData:false,cache:false,timeout:300000,success:function success(res){if(!res){console.log(\"Request error\");return setTimeout(function(){checkIfIsSharing(itemUUID,tries+1,maxTries,callback);},1000);}if(!res.status){callback(false);return console.log(res.message);}return callback(res.data.sharing,res.data.users);},error:function error(err){console.log(err);return setTimeout(function(){checkIfIsSharing(itemUUID,tries+1,maxTries,callback);},1000);}});};var checkIfIsInFolderLink=function checkIfIsInFolderLink(itemUUID,tries,maxTries,callback){if(tries>=maxTries){return callback(false);}window.$.ajax({url:getAPIServer()+\"/v1/link/dir/item/status\",type:\"POST\",contentType:\"application/json\",data:JSON.stringify({apiKey:window.customVariables.apiKey,uuid:itemUUID}),processData:false,cache:false,timeout:300000,success:function success(res){if(!res){console.log(\"Request error\");return setTimeout(function(){checkIfIsInFolderLink(itemUUID,tries+1,maxTries,callback);},1000);}if(!res.status){callback(false);return console.log(res.message);}return callback(res.data.link,res.data.links);},error:function error(err){console.log(err);return setTimeout(function(){checkIfIsInFolderLink(itemUUID,tries+1,maxTries,callback);},1000);}});};var renameItem=function renameItem(data,tries,maxTries,callback){if(tries>=maxTries){return callback(new Error(\"Max requests reached\"));}window.$.ajax({url:getAPIServer()+\"/v1/link/dir/item/rename\",type:\"POST\",contentType:\"application/json\",data:data,processData:false,cache:false,timeout:300000,success:function success(res){if(!res){console.log(\"Request error\");return setTimeout(function(){renameItem(data,tries+1,maxTries,callback);},1000);}return callback(null);},error:function error(err){console.log(err);return setTimeout(function(){renameItem(data,tries+1,maxTries,callback);},1000);}});};var shareItem=function shareItem(data,tries,maxTries,callback){if(tries>=maxTries){return callback(new Error(\"Max requests reached\"));}window.$.ajax({url:getAPIServer()+\"/v1/user/shared/item/rename\",type:\"POST\",contentType:\"application/json\",data:data,processData:false,cache:false,timeout:300000,success:function success(res){if(!res){console.log(\"Request error\");return setTimeout(function(){shareItem(data,tries+1,maxTries,callback);},1000);}return callback(null);},error:function error(err){console.log(err);return setTimeout(function(){shareItem(data,tries+1,maxTries,callback);},1000);}});};checkIfIsSharing(uuid,0,32,function(isSharing,users){if(!isSharing){shareCheckDone=true;return isItDone();}var totalUsers=users.length;var doneUsers=0;var doneSharingToUsers=function doneSharingToUsers(){doneUsers+=1;if(doneUsers>=totalUsers){shareCheckDone=true;return isItDone();}};users.forEach(function(user){window.crypto.subtle.importKey(\"spki\",_base64ToArrayBuffer(user.publicKey),{name:\"RSA-OAEP\",hash:\"SHA-512\"},true,[\"encrypt\"]).then(function(usrPubKey){var mData=\"\";if(type==\"file\"){mData=JSON.stringify({name:metaData.name,size:parseInt(metaData.size),mime:metaData.mime,key:metaData.key});}else{mData=JSON.stringify({name:metaData.name});}window.crypto.subtle.encrypt({name:\"RSA-OAEP\"},usrPubKey,new TextEncoder().encode(mData)).then(function(encrypted){shareItem(JSON.stringify({apiKey:window.customVariables.apiKey,uuid:uuid,receiverId:user.id,metadata:base64ArrayBuffer(encrypted)}),0,32,function(err){if(err){console.log(err);}doneSharingToUsers();});}).catch(function(err){doneSharingToUsers();});}).catch(function(err){doneSharingToUsers();});});});checkIfIsInFolderLink(uuid,0,32,function(isLinking,links){if(!isLinking){linkCheckDone=true;return isItDone();}var userMasterKeys=window.customVariables.userMasterKeys;var totalLinks=links.length;var linksDone=0;var doneAddingToLink=function doneAddingToLink(){linksDone+=1;if(linksDone>=totalLinks){linkCheckDone=true;return isItDone();}};links.forEach(function(link){var key=decryptFolderLinkKey(link.linkKey,userMasterKeys);var mData=\"\";if(type==\"file\"){mData=JSON.stringify({name:metaData.name,size:parseInt(metaData.size),mime:metaData.mime,key:metaData.key});}else{mData=JSON.stringify({name:metaData.name});}mData=CryptoJS.AES.encrypt(mData,key).toString();renameItem(JSON.stringify({apiKey:window.customVariables.apiKey,uuid:uuid,linkUUID:link.linkUUID,metadata:mData}),0,32,function(err){if(err){console.log(err);}doneAddingToLink();});});});}export function checkIfItemParentIsBeingShared(parentUUID,type,metaData,optionalCallback){var shareCheckDone=false;var linkCheckDone=false;var isItDoneInterval=undefined;var callbackFired=false;var isItDone=function isItDone(){if(shareCheckDone&&linkCheckDone){clearInterval(isItDoneInterval);if(typeof optionalCallback==\"function\"&&!callbackFired){callbackFired=true;optionalCallback();}return true;}};isItDoneInterval=setInterval(isItDone,100);var checkIfIsSharing=function checkIfIsSharing(parent,tries,maxTries,callback){if(tries>=maxTries){return callback(false);}window.$.ajax({url:getAPIServer()+\"/v1/share/dir/status\",type:\"POST\",contentType:\"application/json\",data:JSON.stringify({apiKey:window.customVariables.apiKey,uuid:parent}),processData:false,cache:false,timeout:300000,success:function success(res){if(!res){console.log(\"Request error\");return setTimeout(function(){checkIfIsSharing(parent,tries+1,maxTries,callback);},1000);}if(!res.status){console.log(res.message);return callback(false);}return callback(res.data.sharing,res.data.users);},error:function error(err){console.log(err);return setTimeout(function(){checkIfIsSharing(parent,tries+1,maxTries,callback);},1000);}});};var checkIfIsInFolderLink=function checkIfIsInFolderLink(parent,tries,maxTries,callback){if(tries>=maxTries){return callback(false);}window.$.ajax({url:getAPIServer()+\"/v1/link/dir/status\",type:\"POST\",contentType:\"application/json\",data:JSON.stringify({apiKey:window.customVariables.apiKey,uuid:parent}),processData:false,cache:false,timeout:300000,success:function success(res){if(!res){console.log(\"Request error\");return setTimeout(function(){checkIfIsInFolderLink(parent,tries+1,maxTries,callback);},1000);}if(!res.status){console.log(res.message);return callback(false);}return callback(res.data.link,res.data.links);},error:function error(err){console.log(err);return setTimeout(function(){checkIfIsInFolderLink(parent,tries+1,maxTries,callback);},1000);}});};var addItem=function addItem(data,tries,maxTries,callback){if(tries>=maxTries){return callback(new Error(\"Max requests reached\"));}window.$.ajax({url:getAPIServer()+\"/v1/dir/link/add\",type:\"POST\",contentType:\"application/json\",data:data,processData:false,cache:false,timeout:300000,success:function success(res){if(!res){console.log(\"Request error\");return setTimeout(function(){addItem(data,tries+1,maxTries,callback);},1000);}return callback(null);},error:function error(err){console.log(err);return setTimeout(function(){addItem(data,tries+1,maxTries,callback);},1000);}});};var shareItem=function shareItem(data,tries,maxTries,callback){if(tries>=maxTries){return callback(new Error(\"Max requests reached\"));}window.$.ajax({url:getAPIServer()+\"/v1/share\",type:\"POST\",contentType:\"application/json\",data:data,processData:false,cache:false,timeout:300000,success:function success(res){if(!res){console.log(\"Request error\");return setTimeout(function(){shareItem(data,tries+1,maxTries,callback);},1000);}return callback(null);},error:function error(err){console.log(err);return setTimeout(function(){shareItem(data,tries+1,maxTries,callback);},1000);}});};checkIfIsSharing(parentUUID,0,32,function(status,users){if(!status){shareCheckDone=true;return isItDone();}var totalUsers=users.length;var doneUsers=0;var doneSharingToUsers=function doneSharingToUsers(){doneUsers+=1;if(doneUsers>=totalUsers){shareCheckDone=true;return isItDone();}};users.forEach(function(user){window.crypto.subtle.importKey(\"spki\",_base64ToArrayBuffer(user.publicKey),{name:\"RSA-OAEP\",hash:\"SHA-512\"},true,[\"encrypt\"]).then(function(usrPubKey){var mData=\"\";if(type==\"file\"){mData=JSON.stringify({name:metaData.name,size:parseInt(metaData.size),mime:metaData.mime,key:metaData.key});}else{mData=JSON.stringify({name:metaData.name});}window.crypto.subtle.encrypt({name:\"RSA-OAEP\"},usrPubKey,new TextEncoder().encode(mData)).then(function(encrypted){shareItem(JSON.stringify({apiKey:window.customVariables.apiKey,uuid:metaData.uuid,parent:parentUUID,email:user.email,type:type,metadata:base64ArrayBuffer(encrypted)}),0,32,function(err){if(err){console.log(err);}doneSharingToUsers();});}).catch(function(err){doneSharingToUsers();});}).catch(function(err){doneSharingToUsers();});});});checkIfIsInFolderLink(parentUUID,0,32,function(status,links){if(!status){linkCheckDone=true;return isItDone();}var userMasterKeys=window.customVariables.userMasterKeys;var totalLinks=links.length;var linksDone=0;var doneAddingToLink=function doneAddingToLink(){linksDone+=1;if(linksDone>=totalLinks){linkCheckDone=true;return isItDone();}};links.forEach(function(link){var key=decryptFolderLinkKey(link.linkKey,userMasterKeys);var mData=\"\";if(type==\"file\"){mData=JSON.stringify({name:metaData.name,size:parseInt(metaData.size),mime:metaData.mime,key:metaData.key});}else{mData=JSON.stringify({name:metaData.name});}mData=CryptoJS.AES.encrypt(mData,key).toString();addItem(JSON.stringify({apiKey:window.customVariables.apiKey,uuid:metaData.uuid,parent:parentUUID,linkUUID:link.linkUUID,type:type,metadata:mData,key:link.linkKey,expiration:\"never\",password:\"empty\",passwordHashed:hashFn(\"empty\"),downloadBtn:\"enable\"}),0,32,function(err){if(err){console.log(err);}doneAddingToLink();});});});}export function currentParentFolder(){var ex=window.location.href.split(\"/\");return ex[ex.length-1];}export function canCompressThumbnail(ext){switch(ext.toLowerCase()){case\"jpeg\":case\"jpg\":case\"png\":case\"gif\":return true;break;default:return false;break;}}export function canShowThumbnail(ext){switch(ext.toLowerCase()){case\"jpeg\":case\"jpg\":case\"png\":case\"gif\":case\"svg\":case\"mp4\":case\"webm\":case\"avi\":case\"mov\":case\"wmv\":return true;break;default:return false;break;}}export function getFilePreviewType(ext){switch(ext.toLowerCase()){case\"jpeg\":case\"jpg\":case\"png\":case\"gif\":case\"svg\":return\"image\";break;case\"mp3\":case\"mp2\":case\"wav\":case\"ogg\":case\"m4a\":case\"aac\":case\"flac\":case\"midi\":case\"xmf\":case\"rtx\":case\"ota\":case\"mpa\":case\"aif\":case\"rtttl\":case\"wma\":return\"audio\";break;case\"mp4\":case\"webm\":case\"mkv\":case\"flv\":case\"mov\":case\"ogv\":case\"3gp\":case\"avi\":return\"video\";break;case\"json\":case\"js\":case\"md\":case\"php\":case\"css\":case\"c\":case\"perl\":case\"html\":case\"html5\":case\"jsx\":case\"php5\":case\"yml\":case\"md\":case\"xml\":case\"sql\":case\"java\":case\"csharp\":case\"dist\":case\"py\":case\"cc\":case\"cpp\":case\"log\":case\"conf\":case\"cxx\":case\"ini\":case\"lock\":case\"bat\":case\"sh\":case\"properties\":case\"cfg\":case\"ahk\":case\"ts\":case\"tsx\":return\"code\";break;case\"txt\":case\"rtf\":return\"text\";break;case\"pdf\":return\"pdf\";break;default:return\"none\";break;}}export function escapeHTML(str){if(typeof str!==\"string\"){return str;}if(str.length==0){return str;}return str.replace(/(<([^>]+)>)/ig,\"\");}export function getFileIconFromName(name){var ex=name.split(\".\");return getFileIcon(ex[ex.length-1].toLowerCase());}export function getFileIcon(ext){switch(ext.toLowerCase()){case\"pdf\":return\"assets/img/types/pdf.svg\";break;case\"doc\":case\"docx\":return\"assets/img/types/doc.svg\";break;case\"exe\":return\"assets/img/types/exe.svg\";break;case\"mp3\":return\"assets/img/types/mp3.svg\";break;case\"json\":return\"assets/img/types/json-file.svg\";break;case\"png\":return\"assets/img/types/png.svg\";break;case\"ico\":return\"assets/img/types/ico.svg\";break;case\"txt\":return\"assets/img/types/txt.svg\";break;case\"jpg\":case\"jpeg\":return\"assets/img/types/jpg.svg\";break;case\"iso\":return\"assets/img/types/iso.svg\";break;case\"js\":return\"assets/img/types/javascript.svg\";break;case\"html\":return\"assets/img/types/html.svg\";break;case\"css\":return\"assets/img/types/css.svg\";break;case\"csv\":return\"assets/img/types/csv.svg\";break;case\"avi\":return\"assets/img/types/avi.svg\";break;case\"mp4\":return\"assets/img/types/mp4.svg\";break;case\"ppt\":return\"assets/img/types/ppt.svg\";break;case\"zip\":return\"assets/img/types/zip.svg\";break;case\"rar\":case\"tar\":case\"tgz\":case\"gz\":case\"gzip\":return\"assets/img/types/zip-1.svg\";break;case\"txt\":return\"assets/img/types/txt.svg\";break;case\"svg\":return\"assets/img/types/svg.svg\";break;case\"xml\":return\"assets/img/types/xml.svg\";break;case\"dwg\":return\"assets/img/types/dwg.svg\";break;case\"fla\":return\"assets/img/types/fla.svg\";break;case\"ai\":return\"assets/img/types/ai.svg\";break;default:return\"assets/img/types/file.svg\";break;}}export function uInt8ArrayConcat(arrays){// sum of individual array lengths\nvar totalLength=arrays.reduce(function(acc,value){return acc+value.length;},0);if(!arrays.length)return null;var result=new Uint8Array(totalLength);// for each array - copy it over result\n// next array is copied right after the previous one\nvar length=0;var _iterator=_createForOfIteratorHelper(arrays),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var array=_step.value;result.set(array,length);length+=array.length;}}catch(err){_iterator.e(err);}finally{_iterator.f();}return result;}export function orderItemsByType(items,type){var files=[];var folders=[];for(var i=0;i<items.length;i++){if(items[i].type==\"file\"){files.push(items[i]);}else{folders.push(items[i]);}}if(type==\"nameAsc\"){var sortedFiles=files.sort(function(a,b){return a.name.localeCompare(b.name);});var sortedFolders=folders.sort(function(a,b){return a.name.localeCompare(b.name);});return sortedFolders.concat(sortedFiles);}else if(type==\"sizeAsc\"){var _sortedFiles=files.sort(function(a,b){return a.size-b.size;});var _sortedFolders=folders.sort(function(a,b){return b.timestamp-a.timestamp;});return _sortedFolders.concat(_sortedFiles);}else if(type==\"dateAsc\"){var _sortedFiles2=files.sort(function(a,b){return a.timestamp-b.timestamp;});var _sortedFolders2=folders.sort(function(a,b){return a.timestamp-b.timestamp;});return _sortedFolders2.concat(_sortedFiles2);}else if(type==\"typeAsc\"){var _sortedFiles3=files.sort(function(a,b){if(typeof a.mime==\"undefined\"){a.mime=\"_\";}if(typeof b.mime==\"undefined\"){b.mime=\"_\";}if(a.mime.length<=1){a.mime=\"_\";}if(b.mime.length<=1){b.mime=\"_\";}return a.mime.localeCompare(b.mime);});var _sortedFolders3=folders.sort(function(a,b){return b.timestamp-a.timestamp;});return _sortedFolders3.concat(_sortedFiles3);}else if(type==\"nameDesc\"){var _sortedFiles4=files.sort(function(a,b){return b.name.localeCompare(a.name);});var _sortedFolders4=folders.sort(function(a,b){return b.name.localeCompare(a.name);});return _sortedFolders4.concat(_sortedFiles4);}else if(type==\"sizeDesc\"){var _sortedFiles5=files.sort(function(a,b){return b.size-a.size;});var _sortedFolders5=folders.sort(function(a,b){return b.timestamp-a.timestamp;});return _sortedFolders5.concat(_sortedFiles5);}else if(type==\"typeDesc\"){var _sortedFiles6=files.sort(function(a,b){if(typeof a.mime==\"undefined\"){a.mime=\"_\";}if(typeof b.mime==\"undefined\"){b.mime=\"_\";}if(a.mime.length<=1){a.mime=\"_\";}if(b.mime.length<=1){b.mime=\"_\";}return b.mime.localeCompare(a.mime);});var _sortedFolders6=folders.sort(function(a,b){return b.timestamp-a.timestamp;});return _sortedFolders6.concat(_sortedFiles6);}else{//default, dateDesc\nvar _sortedFiles7=files.sort(function(a,b){return b.timestamp-a.timestamp;});var _sortedFolders7=folders.sort(function(a,b){return b.timestamp-a.timestamp;});return _sortedFolders7.concat(_sortedFiles7);}}export function getVideoCover(file){var seekTo=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0.0;return new Promise(function(resolve,reject){// load the file to a video player\nvar videoPlayer=document.createElement('video');videoPlayer.setAttribute('src',URL.createObjectURL(file));videoPlayer.load();videoPlayer.addEventListener('error',function(ex){reject(\"error when loading video file\",ex);});// load metadata of the video to get video duration and dimensions\nvideoPlayer.addEventListener('loadedmetadata',function(){// seek to user defined timestamp (in seconds) if possible\nif(videoPlayer.duration<seekTo){reject(\"video is too short.\");return;}if(videoPlayer.duration>=1){seekTo=1.0;}// delay seeking or else 'seeked' event won't fire on Safari\nsetTimeout(function(){videoPlayer.currentTime=seekTo;},200);// extract video thumbnail once seeking is complete\nvideoPlayer.addEventListener('seeked',function(){// define a canvas to have the same dimension as the video\nvar canvas=document.createElement(\"canvas\");canvas.width=videoPlayer.videoWidth;canvas.height=videoPlayer.videoHeight;// draw the video frame to canvas\nvar ctx=canvas.getContext(\"2d\");ctx.drawImage(videoPlayer,0,0,canvas.width,canvas.height);// return the canvas image as a blob\nctx.canvas.toBlob(function(blob){resolve(blob);},\"image/jpeg\",0.1/* quality */);});});});}export function parseQuery(queryString){var query={};var pairs=(queryString[0]==='?'?queryString.substr(1):queryString).split('&');for(var i=0;i<pairs.length;i++){var pair=pairs[i].split('=');query[decodeURIComponent(pair[0])]=decodeURIComponent(pair[1]||'');}return query;}export function getQueryVariable(variable){var query=window.location.search.substring(1);var vars=query.split('&');for(var i=0;i<vars.length;i++){var pair=vars[i].split('=');if(decodeURIComponent(pair[0])==variable){return decodeURIComponent(pair[1]);}}console.log('Query variable %s not found',variable);}export function getLanguageSelection(){return\"\\n        <ion-select-option value=\\\"en\\\">English</ion-select-option>\\n        <ion-select-option value=\\\"de\\\">Deutsch</ion-select-option>\\n        <ion-select-option value=\\\"nl\\\">Nederlands</ion-select-option>\\n        <ion-select-option value=\\\"hi\\\">\\u0939\\u093F\\u0928\\u094D\\u0926\\u0940, \\u0939\\u093F\\u0902\\u0926\\u0940</ion-select-option>\\n        <ion-select-option value=\\\"fr\\\">Fran\\xE7ais</ion-select-option>\\n        <ion-select-option value=\\\"da\\\">Dansk</ion-select-option>\\n        <ion-select-option value=\\\"es\\\">Espa\\xF1ol</ion-select-option>\\n    \";}export function getFolderColorStyle(){var color=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;var onlyColor=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var folderColorStyle=\"\";switch(color){case\"default\":folderColorStyle=\"style='color: #F6C358;'\";if(onlyColor){folderColorStyle=\"#F6C358\";}break;case\"blue\":folderColorStyle=\"style='color: #2992E5;'\";if(onlyColor){folderColorStyle=\"#2992E5\";}break;case\"green\":folderColorStyle=\"style='color: #57A15B;'\";if(onlyColor){folderColorStyle=\"#57A15B\";}break;case\"purple\":folderColorStyle=\"style='color: #8E3A9D;'\";if(onlyColor){folderColorStyle=\"#8E3A9D\";}break;case\"red\":folderColorStyle=\"style='color: #CB2E35;'\";if(onlyColor){folderColorStyle=\"#CB2E35\";}break;case\"gray\":folderColorStyle=\"style='color: gray;'\";if(onlyColor){folderColorStyle=\"gray\";}break;default:folderColorStyle=\"style='color: #F6C358;'\";if(onlyColor){folderColorStyle=\"#F6C358\";}break;}return folderColorStyle;}export function copyTextToClipboardWeb(text){var textArea=document.createElement(\"textarea\");textArea.style.position=\"fixed\";textArea.style.top=0;textArea.style.left=0;textArea.style.width=\"2em\";textArea.style.height=\"2em\";textArea.style.padding=0;textArea.style.border=\"none\";textArea.style.outline=\"none\";textArea.style.boxShadow=\"none\";textArea.style.background=\"transparent\";textArea.value=text;document.body.appendChild(textArea);textArea.focus();textArea.select();try{document.execCommand(\"copy\");}catch(e){return console.log(e);}//alert(\"Link copied to clipboard!\")\nreturn document.body.removeChild(textArea);}","map":{"version":3,"sources":["/Users/jan/Documents/filen/app/src/utils/utils.js"],"names":["Capacitor","Plugins","CryptoJS","require","striptags","sanitizeHTML","html","getRandomArbitrary","min","max","Math","floor","random","formatBytes","bytes","decimals","k","dm","sizes","i","log","parseFloat","pow","toFixed","uuidv4","d","Date","getTime","d2","performance","now","replace","c","r","toString","generateRandomString","length","result","characters","charAt","generateRandomClassName","getAPIServer","servers","fetchWithTimeout","ms","promise","Promise","resolve","reject","timer","setTimeout","Error","then","value","clearTimeout","catch","err","backgroundAPIRequest","method","endpoint","data","cacheKey","fetch","toUpperCase","cache","headers","body","JSON","stringify","response","json","obj","window","customVariables","cachedAPIItemListRequests","customFunctions","saveAPICache","console","apiRequest","isNative","Network","getStatus","apiCache","getDownloadServer","getUploadServer","hashFn","val","SHA1","SHA512","cryptoJSEncrypt","key","AES","encrypt","cryptoJSDecrypt","decrypt","enc","Utf8","unixTimestamp","decryptCryptoJSFolderName","str","userMasterKeys","uuid","undefined","cachedMetadata","name","folderName","reverse","forEach","parse","e","decryptFolderNamePrivateKey","usrPrivKey","crypto","subtle","_base64ToArrayBuffer","decrypted","TextDecoder","decode","decryptFileMetadata","metadata","file","size","mime","fileName","fileSize","fileMime","fileKey","parseInt","decryptFileMetadataPrivateKey","base64ArrayBuffer","arrayBuffer","base64","encodings","Uint8Array","byteLength","byteRemainder","mainLength","a","b","chunk","selectedItemsDoesNotContainFolder","items","type","selected","selectedItemsContainsFolder","binary_string","atob","len","charCodeAt","buffer","fileNameValidationRegex","test","checkIfNameIsBanned","banned","isBanned","ban","indexOf","removeIllegalCharsFromString","split","join","folderNameRegex","substring","nameRegex","isAlphaNumeric","code","convertWordArrayToUint8Array","wordArray","arrayOfWords","hasOwnProperty","words","sigBytes","uInt8Array","index","word","convertUint8ArrayToBinaryString","u8Array","b_str","String","fromCharCode","Semaphore","counter","waiting","take","shift","acquire","push","release","purge","unresolved","decryptFolderLinkKey","link","checkIfItemIsBeingSharedForRename","metaData","optionalCallback","shareCheckDone","linkCheckDone","isItDoneInterval","callbackFired","isItDone","clearInterval","setInterval","checkIfIsSharing","itemUUID","tries","maxTries","callback","$","ajax","url","contentType","apiKey","processData","timeout","success","res","status","message","sharing","users","error","checkIfIsInFolderLink","links","renameItem","shareItem","isSharing","totalUsers","doneUsers","doneSharingToUsers","user","importKey","publicKey","hash","usrPubKey","mData","TextEncoder","encode","encrypted","receiverId","id","isLinking","totalLinks","linksDone","doneAddingToLink","linkKey","linkUUID","checkIfItemParentIsBeingShared","parentUUID","parent","addItem","email","expiration","password","passwordHashed","downloadBtn","currentParentFolder","ex","location","href","canCompressThumbnail","ext","toLowerCase","canShowThumbnail","getFilePreviewType","escapeHTML","getFileIconFromName","getFileIcon","uInt8ArrayConcat","arrays","totalLength","reduce","acc","array","set","orderItemsByType","files","folders","sortedFiles","sort","localeCompare","sortedFolders","concat","timestamp","getVideoCover","seekTo","videoPlayer","document","createElement","setAttribute","URL","createObjectURL","load","addEventListener","duration","currentTime","canvas","width","videoWidth","height","videoHeight","ctx","getContext","drawImage","toBlob","blob","parseQuery","queryString","query","pairs","substr","pair","decodeURIComponent","getQueryVariable","variable","search","vars","getLanguageSelection","getFolderColorStyle","color","onlyColor","folderColorStyle","copyTextToClipboardWeb","text","textArea","style","position","top","left","padding","border","outline","boxShadow","background","appendChild","focus","select","execCommand","removeChild"],"mappings":"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CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAEA,MAAO,SAASC,CAAAA,oBAAT,CAA8B1F,GAA9B,CAAmCC,cAAnC,CAAkD,CACxD,GAAI0F,CAAAA,IAAI,CAAG,EAAX,CAEG,GAAG1F,cAAc,CAAChE,MAAf,CAAwB,CAA3B,CAA6B,CAC1BgE,cAAc,CAAGA,cAAc,CAACM,OAAf,EAAjB,CACF,CAEDN,cAAc,CAACO,OAAf,CAAuB,SAACjB,GAAD,CAAS,CAC5B,GAAG,CACC,GAAInB,CAAAA,GAAG,CAAGrE,QAAQ,CAACyF,GAAT,CAAaG,OAAb,CAAqBK,GAArB,CAA0BT,GAA1B,EAA+BxD,QAA/B,CAAwChC,QAAQ,CAAC6F,GAAT,CAAaC,IAArD,CAAV,CAEA,GAAGzB,GAAG,EAAI,MAAOA,CAAAA,GAAP,EAAc,QAAxB,CAAiC,CAC7B,GAAGA,GAAG,CAACnC,MAAJ,EAAc,EAAjB,CAAoB,CACnB0J,IAAI,CAAGvH,GAAP,CACA,CACJ,CACJ,CACD,M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","sourcesContent":["import { Capacitor, Plugins } from \"@capacitor/core\";\r\n\r\nconst CryptoJS = require(\"crypto-js\")\r\nconst striptags = require(\"striptags\")\r\n\r\nexport function sanitizeHTML(html){\r\n    return striptags(html)\r\n}\r\n\r\nexport function getRandomArbitrary(min, max){\r\n    return Math.floor(Math.random() * (max - min) + min)\r\n}\r\n\r\nexport function formatBytes(bytes, decimals = 2){\r\n    if(bytes === 0) return \"0 Bytes\"\r\n\r\n    let k = 1024\r\n    let dm = decimals < 0 ? 0 : decimals\r\n    let sizes = [\"Bytes\", \"KB\", \"MB\", \"GB\", \"TB\", \"PB\", \"EB\", \"ZB\", \"YB\"]\r\n\r\n    let i = Math.floor(Math.log(bytes) / Math.log(k))\r\n\r\n    return parseFloat((bytes / Math.pow(k, i)).toFixed(dm)) + \" \" + sizes[i]\r\n}\r\n\r\nexport function uuidv4(){ // Public Domain/MIT\r\n    let d = new Date().getTime();//Timestamp\r\n    let d2 = (performance && performance.now && (performance.now()*1000)) || 0;//Time in microseconds since page-load or 0 if unsupported\r\n    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\r\n        let r = Math.random() * 16;//random number between 0 and 16\r\n        if(d > 0){//Use timestamp until depleted\r\n            r = (d + r)%16 | 0;\r\n            d = Math.floor(d/16);\r\n        } else {//Use microseconds since page-load if supported\r\n            r = (d2 + r)%16 | 0;\r\n            d2 = Math.floor(d2/16);\r\n        }\r\n        return (c === 'x' ? r : (r & 0x3 | 0x8)).toString(16);\r\n    });\r\n}\r\n\r\nexport function generateRandomString(length = 32){\r\n    let result = \"\"\r\n    let characters = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\"\r\n\r\n    for(let i = 0; i < length; i++){\r\n        result += characters.charAt(Math.floor(Math.random() * characters.length))\r\n    }\r\n\r\n    return result\r\n}\r\n\r\nexport function generateRandomClassName(length = 16){\r\n    let result = \"\"\r\n    let characters = \"abcdefghijklmnopqrstuvwxyz\"\r\n\r\n    for(let i = 0; i < length; i++){\r\n        result += characters.charAt(Math.floor(Math.random() * characters.length))\r\n    }\r\n\r\n    return result + \"-\" + result\r\n}\r\n\r\nexport function getAPIServer(){\r\n    let servers = [\r\n        \"https://api.filen.io\",\r\n        \"https://api.filen-1.xyz\",\r\n        \"https://api.filen-2.xyz\",\r\n        \"https://api.filen-3.xyz\",\r\n        \"https://api.filen-4.xyz\",\r\n        \"https://api.filen-5.xyz\"\r\n    ]\r\n\r\n    return servers[getRandomArbitrary(0, (servers.length - 1))]\r\n}\r\n\r\nexport function fetchWithTimeout(ms, promise) {\r\n    return new Promise((resolve, reject) => {\r\n        let timer = setTimeout(() => {\r\n            return reject(new Error(\"Request timeout after \" + ms + \"ms\"))\r\n        }, ms)\r\n\r\n        promise.then((value) => {\r\n            clearTimeout(timer)\r\n            \r\n            return resolve(value)\r\n        }).catch((err) => {\r\n            clearTimeout(timer)\r\n\r\n            return reject(err)\r\n        })\r\n    })\r\n}\r\n\r\nexport function backgroundAPIRequest(method, endpoint, data = {}){\r\n    let cacheKey = method + endpoint\r\n\r\n    fetchWithTimeout(60000, fetch(getAPIServer() + endpoint, {\r\n        method: method.toUpperCase(),\r\n        cache: \"no-cache\",\r\n        headers: {\r\n            \"Content-Type\": \"application/json\"\r\n        },\r\n        body: JSON.stringify(data)\r\n    })).then((response) => {\r\n        response.json().then((obj) => {\r\n            window.customVariables.cachedAPIItemListRequests[cacheKey] = obj\r\n\r\n            return window.customFunctions.saveAPICache()\r\n        }).catch((err) => {\r\n            console.log(err)\r\n        })\r\n    }).catch((err) => {\r\n        console.log(err)\r\n    })\r\n}\r\n\r\nexport function apiRequest(method, endpoint, data = {}){\r\n    return new Promise((resolve, reject) => {\r\n        let cacheKey = method + endpoint\r\n        \r\n        /*let useFastCache = false\r\n\r\n        if(method.toUpperCase() == \"POST\"){\r\n            if(endpoint == \"/v1/dir/content\"\r\n            || endpoint == \"/v1/user/shared/in\"\r\n            || endpoint == \"/v1/user/shared/out\"){\r\n                useFastCache = true\r\n            }\r\n        }\r\n\r\n        if(useFastCache){\r\n            if(typeof window.customVariables.cachedAPIItemListRequests[cacheKey] !== \"undefined\"){\r\n                try{\r\n                    let obj = JSON.parse(window.customVariables.cachedAPIItemListRequests[cacheKey])\r\n\r\n                    delete window.customVariables.cachedAPIItemListRequests[cacheKey]\r\n\r\n                    backgroundAPIRequest(method, endpoint, data)\r\n\r\n                    return obj\r\n                }\r\n                catch(e){\r\n                    console.log(e)\r\n                }\r\n            }\r\n        }*/\r\n\r\n        if(Capacitor.isNative){\r\n            if(Plugins.Network.getStatus() == \"none\"){\r\n                if(typeof window.customVariables.apiCache[cacheKey] !== \"undefined\"){\r\n                    return resolve(window.customVariables.apiCache[cacheKey])\r\n                }\r\n            }\r\n        }\r\n\r\n        fetchWithTimeout(60000, fetch(getAPIServer() + endpoint, {\r\n            method: method.toUpperCase(),\r\n            cache: \"no-cache\",\r\n            headers: {\r\n                \"Content-Type\": \"application/json\"\r\n            },\r\n            body: JSON.stringify(data)\r\n        })).then((response) => {\r\n            response.json().then((obj) => {\r\n                if(endpoint == \"/v1/dir/content\"\r\n                || endpoint == \"/v1/user/baseFolders\"\r\n                || endpoint == \"/v1/user/shared/in\"\r\n                || endpoint == \"/v1/user/shared/out\"\r\n                || endpoint == \"/v1/user/keyPair/info\"){\r\n                    window.customVariables.apiCache[cacheKey] = obj\r\n\r\n                    window.customFunctions.saveAPICache()\r\n                }\r\n\r\n                return resolve(obj)\r\n            }).catch((err) => {\r\n                console.log(err)\r\n\r\n                if(typeof window.customVariables.apiCache[cacheKey] !== \"undefined\"){\r\n                    return resolve(window.customVariables.apiCache[cacheKey])\r\n                }\r\n\r\n                return reject(err)\r\n            })\r\n        }).catch((err) => {\r\n            console.log(err)\r\n\r\n            if(typeof window.customVariables.apiCache[cacheKey] !== \"undefined\"){\r\n                return resolve(window.customVariables.apiCache[cacheKey])\r\n            }\r\n\r\n            return reject(err)\r\n        })\r\n    })\r\n}\r\n\r\nexport function getDownloadServer(){\r\n    let servers = [\r\n        \"https://down.filen-1.xyz\",\r\n        \"https://down.filen-2.xyz\",\r\n        \"https://down.filen-3.xyz\",\r\n        \"https://down.filen-4.xyz\",\r\n        \"https://down.filen-5.xyz\"\r\n    ]\r\n\r\n    return servers[getRandomArbitrary(0, (servers.length - 1))]\r\n}\r\n\r\nexport function getUploadServer(){\r\n    let servers = [\r\n        \"https://up.filen-1.xyz\",\r\n        \"https://up.filen-2.xyz\",\r\n        \"https://up.filen-3.xyz\",\r\n        \"https://up.filen-4.xyz\",\r\n        \"https://up.filen-5.xyz\"\r\n    ]\r\n\r\n    return servers[getRandomArbitrary(0, (servers.length - 1))]\r\n}\r\n\r\nexport function hashFn(val){\r\n    return CryptoJS.SHA1(CryptoJS.SHA512(val).toString()).toString()\r\n}\r\n\r\nexport function cryptoJSEncrypt(val, key){\r\n    return CryptoJS.AES.encrypt(val, key).toString()\r\n}\r\n\r\nexport function cryptoJSDecrypt(val, key){\r\n    return CryptoJS.AES.decrypt(val, key).toString(CryptoJS.enc.Utf8)\r\n}\r\n\r\nexport function unixTimestamp(){\r\n    return Math.floor((+new Date()) / 1000)\r\n}\r\n\r\nexport function decryptCryptoJSFolderName(str, userMasterKeys, uuid = undefined){\r\n    let cacheKey = \"folder_\" + uuid + \"_\" + str\r\n\r\n    if(window.customVariables.cachedMetadata[cacheKey]){\r\n        return window.customVariables.cachedMetadata[cacheKey].name\r\n    }\r\n\r\n    let folderName = \"CON_NO_DECRYPT_POSSIBLE_NO_NAME_FOUND_FOR_FOLDER\"\r\n\r\n    userMasterKeys = userMasterKeys.reverse()\r\n\r\n    let obj = undefined\r\n\r\n    userMasterKeys.forEach((key) => {\r\n        try{\r\n            obj = JSON.parse(CryptoJS.AES.decrypt(str, key).toString(CryptoJS.enc.Utf8))\r\n\r\n            if(obj && typeof obj == \"object\"){\r\n                folderName = obj.name\r\n            }\r\n        }\r\n        catch(e){\r\n            return\r\n        }\r\n    })\r\n\r\n    if(folderName !== \"CON_NO_DECRYPT_POSSIBLE_NO_NAME_FOUND_FOR_FOLDER\"){\r\n        window.customVariables.cachedMetadata[cacheKey] = {\r\n            name: folderName\r\n        }\r\n    }\r\n\r\n    return folderName\r\n}\r\n\r\nexport async function decryptFolderNamePrivateKey(str, usrPrivKey, uuid = undefined){\r\n    let cacheKey = \"folder_\" + uuid + \"_\" + str\r\n\r\n    if(window.customVariables.cachedMetadata[cacheKey]){\r\n        return window.customVariables.cachedMetadata[cacheKey].name\r\n    }\r\n\r\n    let folderName = \"CON_NO_DECRYPT_POSSIBLE_NO_NAME_FOUND_FOR_FOLDER\"\r\n\r\n    try{\r\n        let decrypted = await window.crypto.subtle.decrypt({\r\n            name: \"RSA-OAEP\"\r\n        }, usrPrivKey, _base64ToArrayBuffer(str))\r\n\r\n        decrypted = JSON.parse(new TextDecoder().decode(decrypted))\r\n\r\n        if(decrypted && typeof decrypted == \"object\"){\r\n            folderName = decrypted.name\r\n        }\r\n    }\r\n    catch(e){\r\n        console.log(e)\r\n    }\r\n\r\n    if(folderName !== \"CON_NO_DECRYPT_POSSIBLE_NO_NAME_FOUND_FOR_FOLDER\"){\r\n        window.customVariables.cachedMetadata[cacheKey] = {\r\n            name: folderName\r\n        }\r\n    }\r\n\r\n    return folderName\r\n}\r\n\r\nexport function decryptFileMetadata(metadata, userMasterKeys, uuid = undefined){\r\n    let cacheKey = \"file_\" + uuid + \"_\" + metadata\r\n\r\n    if(window.customVariables.cachedMetadata[cacheKey]){\r\n        let file = window.customVariables.cachedMetadata[cacheKey]\r\n\r\n        return {\r\n            name: file.name,\r\n            size: file.size,\r\n            mime: file.mime,\r\n            key: file.key\r\n        }\r\n    }\r\n\r\n    let fileName = \"\"\r\n    let fileSize = 0\r\n    let fileMime = \"\"\r\n    let fileKey = \"\"\r\n\r\n    userMasterKeys = userMasterKeys.reverse()\r\n\r\n    userMasterKeys.forEach((key) => {\r\n        try{\r\n            let obj = JSON.parse(CryptoJS.AES.decrypt(metadata, key).toString(CryptoJS.enc.Utf8))\r\n\r\n            if(obj && typeof obj == \"object\"){\r\n                fileName = obj.name\r\n                fileSize = parseInt(obj.size)\r\n                fileMime = obj.mime\r\n                fileKey = obj.key\r\n            }\r\n        }\r\n        catch(e){\r\n            return\r\n        }\r\n    })\r\n\r\n    let obj = {\r\n        name: fileName,\r\n        size: fileSize,\r\n        mime: fileMime,\r\n        key: fileKey\r\n    }\r\n\r\n    if(obj.name.length >= 1){\r\n        window.customVariables.cachedMetadata[cacheKey] = obj\r\n    }\r\n\r\n    return obj\r\n}\r\n\r\nexport async function decryptFileMetadataPrivateKey(str, usrPrivKey, uuid = undefined){\r\n    let cacheKey = \"file_\" + uuid + \"_\" + str\r\n\r\n    if(window.customVariables.cachedMetadata[cacheKey]){\r\n        let file = window.customVariables.cachedMetadata[cacheKey]\r\n\r\n        return {\r\n            name: file.name,\r\n            size: file.size,\r\n            mime: file.mime,\r\n            key: file.key\r\n        }\r\n    }\r\n\r\n    let fileName = \"\"\r\n    let fileSize = 0\r\n    let fileMime = \"\"\r\n    let fileKey = \"\"\r\n\r\n    try{\r\n        let decrypted = await window.crypto.subtle.decrypt({\r\n            name: \"RSA-OAEP\"\r\n        }, usrPrivKey, _base64ToArrayBuffer(str))\r\n\r\n        decrypted = JSON.parse(new TextDecoder().decode(decrypted))\r\n\r\n        if(decrypted && typeof decrypted == \"object\"){\r\n            fileName = decrypted.name\r\n            fileSize = parseInt(decrypted.size)\r\n            fileMime = decrypted.mime\r\n            fileKey = decrypted.key\r\n        }\r\n    }\r\n    catch(e){\r\n        return {\r\n            name: fileName,\r\n            size: fileSize,\r\n            mime: fileMime,\r\n            key: fileKey\r\n        }\r\n    }\r\n\r\n    let obj = {\r\n        name: fileName,\r\n        size: fileSize,\r\n        mime: fileMime,\r\n        key: fileKey\r\n    }\r\n\r\n    if(obj.name.length >= 1){\r\n        window.customVariables.cachedMetadata[cacheKey] = obj\r\n    }\r\n\r\n    return obj\r\n}\r\n\r\nexport function base64ArrayBuffer(arrayBuffer){\r\n    var base64    = ''\r\n    var encodings = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'\r\n  \r\n    var bytes         = new Uint8Array(arrayBuffer)\r\n    var byteLength    = bytes.byteLength\r\n    var byteRemainder = byteLength % 3\r\n    var mainLength    = byteLength - byteRemainder\r\n  \r\n    var a, b, c, d\r\n    var chunk\r\n  \r\n    // Main loop deals with bytes in chunks of 3\r\n    for (var i = 0; i < mainLength; i = i + 3) {\r\n      // Combine the three bytes into a single integer\r\n      chunk = (bytes[i] << 16) | (bytes[i + 1] << 8) | bytes[i + 2]\r\n  \r\n      // Use bitmasks to extract 6-bit segments from the triplet\r\n      a = (chunk & 16515072) >> 18 // 16515072 = (2^6 - 1) << 18\r\n      b = (chunk & 258048)   >> 12 // 258048   = (2^6 - 1) << 12\r\n      c = (chunk & 4032)     >>  6 // 4032     = (2^6 - 1) << 6\r\n      d = chunk & 63               // 63       = 2^6 - 1\r\n  \r\n      // Convert the raw binary segments to the appropriate ASCII encoding\r\n      base64 += encodings[a] + encodings[b] + encodings[c] + encodings[d]\r\n    }\r\n  \r\n    // Deal with the remaining bytes and padding\r\n    if (byteRemainder == 1) {\r\n      chunk = bytes[mainLength]\r\n  \r\n      a = (chunk & 252) >> 2 // 252 = (2^6 - 1) << 2\r\n  \r\n      // Set the 4 least significant bits to zero\r\n      b = (chunk & 3)   << 4 // 3   = 2^2 - 1\r\n  \r\n      base64 += encodings[a] + encodings[b] + '=='\r\n    } else if (byteRemainder == 2) {\r\n      chunk = (bytes[mainLength] << 8) | bytes[mainLength + 1]\r\n  \r\n      a = (chunk & 64512) >> 10 // 64512 = (2^6 - 1) << 10\r\n      b = (chunk & 1008)  >>  4 // 1008  = (2^6 - 1) << 4\r\n  \r\n      // Set the 2 least significant bits to zero\r\n      c = (chunk & 15)    <<  2 // 15    = 2^4 - 1\r\n  \r\n      base64 += encodings[a] + encodings[b] + encodings[c] + '='\r\n    }\r\n    \r\n    return base64\r\n}\r\n\r\nexport function selectedItemsDoesNotContainFolder(items){\r\n    for(let i = 0; i < items.length; i++){\r\n        if(items[i].type == \"folder\" && items[i].selected){\r\n            return false\r\n        }\r\n    }\r\n\r\n    return true\r\n}\r\n\r\nexport function selectedItemsContainsFolder(items){\r\n    for(let i = 0; i < items.length; i++){\r\n        if(items[i].type == \"folder\" && items[i].selected){\r\n            return true\r\n        }\r\n    }\r\n\r\n    return false\r\n}\r\n\r\nexport function _base64ToArrayBuffer(base64){\r\n    var binary_string = window.atob(base64);\r\n    var len = binary_string.length;\r\n    var bytes = new Uint8Array(len);\r\n    for (var i = 0; i < len; i++) {\r\n        bytes[i] = binary_string.charCodeAt(i);\r\n    }\r\n    return bytes.buffer;\r\n}\r\n\r\nexport function fileNameValidationRegex(name){\r\n\tif(/^(con|prn|aux|nul|com[0-9]|lpt[0-9])$|([<>:\"\\/\\\\|?*])|(\\.|\\s)$/ig.test(name)){\r\n\t\treturn true\r\n\t}\r\n\r\n\treturn false\r\n}\r\n\r\nexport function checkIfNameIsBanned(name){\r\n    let banned = [\r\n      \"/\",\r\n      \"\\\\\",\r\n      \"?\",\r\n      \"@\",\r\n      \"$\",\r\n      \"%\",\r\n      \"[\",\r\n      \"]\",\r\n      \"{\",\r\n      \"}\",\r\n      \"&\",\r\n      '\"',\r\n      \"'\",\r\n      \"`\",\r\n      \"*\",\r\n      \"=\",\r\n      \"´\",\r\n      \"<\",\r\n      \">\",\r\n      \":\",\r\n      \";\",\r\n      \"|\",\r\n      \"§\",\r\n      \"CON\", \"PRN\", \"AUX\", \"NUL\", \"COM1\", \"COM2\", \"COM3\", \"COM4\", \"COM5\", \"COM6\", \"COM7\", \"COM8\", \"COM9\",\r\n      \"LPT1\", \"LPT2\", \"LPT3\", \"LPT4\", \"LPT5\", \"LPT6\", \"LPT7\", \"LPT8\", \"LPT9\"\r\n    ]\r\n  \r\n    let isBanned = false\r\n  \r\n    banned.forEach((ban) => {\r\n      if(name.indexOf(ban) !== -1){\r\n        isBanned = true\r\n      }\r\n    })\r\n  \r\n    return isBanned\r\n  }\r\n\r\nexport function removeIllegalCharsFromString(str){\r\n    str = str.split(\"'\").join(\"\")\r\n    str = str.split('\"').join(\"\")\r\n    str = str.split(\"´\").join(\"\")\r\n    str = str.split(\"`\").join(\"\")\r\n    str = str.split(\"<\").join(\"\")\r\n    str = str.split(\">\").join(\"\")\r\n    str = str.split(\"!\").join(\"\")\r\n    str = str.split(\"^\").join(\"\")\r\n    str = str.split(\":\").join(\"\")\r\n    str = str.replace(/(<([^>]+)>)/ig, \"\")\r\n\r\n    return str\r\n}\r\n\r\nexport function folderNameRegex(name){\r\n    if(name.substring(0, 1) == \".\" || name.substring(0, 2) == \"..\"){\r\n        return true\r\n    }\r\n    \r\n    return false\r\n}\r\n\r\nexport function nameRegex(name){\r\n    return false\r\n}\r\n\r\nexport function isAlphaNumeric(str){\r\n    var code, i, len;\r\n    \r\n    for (i = 0, len = str.length; i < len; i++) {\r\n        code = str.charCodeAt(i);\r\n        if (!(code > 47 && code < 58) && // numeric (0-9)\r\n            !(code > 64 && code < 91) && // upper alpha (A-Z)\r\n            !(code > 96 && code < 123)) { // lower alpha (a-z)\r\n        return false;\r\n        }\r\n    }\r\n    return true;\r\n}\r\n\r\nexport function convertWordArrayToUint8Array(wordArray){\r\n    let arrayOfWords = wordArray.hasOwnProperty(\"words\") ? wordArray.words : []\r\n    let length = wordArray.hasOwnProperty(\"sigBytes\") ? wordArray.sigBytes : arrayOfWords.length * 4\r\n    let uInt8Array = new Uint8Array(length), index=0, word, i\r\n\r\n    for(i = 0; i < length; i++){\r\n        word = arrayOfWords[i]\r\n\r\n        uInt8Array[index++] = word >> 24\r\n        uInt8Array[index++] = (word >> 16) & 0xff\r\n        uInt8Array[index++] = (word >> 8) & 0xff\r\n        uInt8Array[index++] = word & 0xff\r\n    }\r\n\r\n    return uInt8Array\r\n}\r\n\r\nexport function convertUint8ArrayToBinaryString(u8Array){\r\n    let i, len = u8Array.length, b_str = \"\"\r\n\r\n    for (i = 0; i < len; i++){\r\n        b_str += String.fromCharCode(u8Array[i])\r\n    }\r\n\r\n    return b_str\r\n}\r\n\r\nexport function Semaphore(max){\r\n    var counter = 0;\r\n    var waiting = [];\r\n    \r\n    var take = function() {\r\n      if (waiting.length > 0 && counter < max){\r\n        counter++;\r\n        let promise = waiting.shift();\r\n        promise.resolve();\r\n      }\r\n    }\r\n    \r\n    this.acquire = function() {\r\n      if(counter < max) {\r\n        counter++\r\n        return new Promise(resolve => {\r\n        resolve();\r\n      });\r\n      } else {\r\n        return new Promise((resolve, err) => {\r\n          waiting.push({resolve: resolve, err: err});\r\n        });\r\n      }\r\n    }\r\n      \r\n    this.release = function() {\r\n     counter--;\r\n     take();\r\n    }\r\n    \r\n    this.purge = function() {\r\n      let unresolved = waiting.length;\r\n    \r\n      for (let i = 0; i < unresolved; i++) {\r\n        waiting[i].err('Task has been purged.');\r\n      }\r\n    \r\n      counter = 0;\r\n      waiting = [];\r\n      \r\n      return unresolved;\r\n    }\r\n}\r\n\r\n/*export function checkIfItemParentIsBeingShared(parentUUID, type, metadata){\r\n    const checkIfIsSharing = async (parent, callback) => {\r\n        if(parent == \"default\" || parent == \"base\"){\r\n            return callback(false)\r\n        }\r\n\r\n        try{\r\n            var res = await apiRequest(\"POST\", \"/v1/share/dir/status\", {\r\n                apiKey: window.customVariables.apiKey,\r\n                uuid: parent\r\n            })\r\n        }\r\n        catch(e){\r\n            console.log(e)\r\n\r\n            return callback(false)\r\n        }\r\n\r\n        if(!res.status){\r\n            console.log(res.message)\r\n\r\n            return callback(false)\r\n        }\r\n\r\n        return callback(res.data.sharing, res.data.users)\r\n    }\r\n\r\n    checkIfIsSharing(parentUUID, async (status, users) => {\r\n        if(!status){\r\n            return false\r\n        }\r\n\r\n        for(let i = 0; i < users.length; i++){\r\n            let user = users[i]\r\n\r\n            try{\r\n                var usrPubKey = await window.crypto.subtle.importKey(\"spki\", _base64ToArrayBuffer(user.publicKey), {\r\n                    name: \"RSA-OAEP\",\r\n                    hash: \"SHA-512\"\r\n                }, true, [\"encrypt\"])\r\n            }\r\n            catch(e){\r\n                console.log(e)\r\n\r\n                return false\r\n            }\r\n\r\n            let mData = \"\"\r\n\r\n            if(type == \"file\"){\r\n                mData = JSON.stringify({\r\n                    name: metadata.name,\r\n                    size: parseInt(metadata.size),\r\n                    mime: metadata.mime,\r\n                    key: metadata.key\r\n                })\r\n            }\r\n            else{\r\n                mData = JSON.stringify({\r\n                    name: metadata.name\r\n                })\r\n            }\r\n            \r\n            try{\r\n                var encrypted = await window.crypto.subtle.encrypt({\r\n                    name: \"RSA-OAEP\"\r\n                }, usrPubKey, new TextEncoder().encode(mData))\r\n            }\r\n            catch(e){\r\n                console.log(e)\r\n\r\n                return false\r\n            }\r\n\r\n            try{\r\n                var res = await apiRequest(\"POST\", \"/v1/share\", {\r\n                    apiKey: window.customVariables.apiKey,\r\n                    uuid: metadata.uuid,\r\n                    parent: parentUUID,\r\n                    email: user.email,\r\n                    type,\r\n                    metadata: base64ArrayBuffer(encrypted)\r\n                })\r\n            }\r\n            catch(e){\r\n                console.log(e)\r\n\r\n                return false\r\n            }\r\n\r\n            if(!res.status){\r\n                console.log(res.message)\r\n\r\n                return false\r\n            }\r\n        }\r\n    })\r\n}\r\n\r\nexport function checkIfItemIsBeingSharedForRename(type, uuid, metadata){\r\n    const checkIfIsSharing = async (itemUUID, callback) => {\r\n        try{\r\n            var res = await apiRequest(\"POST\", \"/v1/user/shared/item/status\", {\r\n                apiKey: window.customVariables.apiKey,\r\n                uuid: itemUUID\r\n            })\r\n        }\r\n        catch(e){\r\n            console.log(e)\r\n\r\n            return callback(false)\r\n        }\r\n\r\n        if(!res.status){\r\n            console.log(res.message)\r\n\r\n            return callback(false)\r\n        }\r\n\r\n        return callback(res.data.sharing, res.data.users)\r\n    }\r\n\r\n    checkIfIsSharing(uuid, async (sharing, users) => {\r\n        if(!sharing){\r\n            return false\r\n        }\r\n\r\n        for(let i = 0; i < users.length; i++){\r\n            let user = users[i]\r\n\r\n            try{\r\n                var usrPubKey = await window.crypto.subtle.importKey(\"spki\", _base64ToArrayBuffer(user.publicKey), {\r\n                    name: \"RSA-OAEP\",\r\n                    hash: \"SHA-512\"\r\n                }, true, [\"encrypt\"])\r\n            }\r\n            catch(e){\r\n                console.log(e)\r\n\r\n                return false\r\n            }\r\n\r\n            let mData = \"\"\r\n\r\n            if(type == \"file\"){\r\n                mData = JSON.stringify({\r\n                    name: metadata.name,\r\n                    size: parseInt(metadata.size),\r\n                    mime: metadata.mime,\r\n                    key: metadata.key\r\n                })\r\n            }\r\n            else{\r\n                mData = JSON.stringify({\r\n                    name: metadata.name\r\n                })\r\n            }\r\n            \r\n            try{\r\n                var encrypted = await window.crypto.subtle.encrypt({\r\n                    name: \"RSA-OAEP\"\r\n                }, usrPubKey, new TextEncoder().encode(mData))\r\n            }\r\n            catch(e){\r\n                console.log(e)\r\n\r\n                return false\r\n            }\r\n\r\n            try{\r\n                var res = await apiRequest(\"POST\", \"/v1/user/shared/item/rename\", {\r\n                    apiKey: window.customVariables.apiKey,\r\n                    uuid,\r\n                    receiverId: user.id,\r\n                    metadata: base64ArrayBuffer(encrypted)\r\n                })\r\n            }\r\n            catch(e){\r\n                console.log(e)\r\n\r\n                return false\r\n            }\r\n\r\n            if(!res.status){\r\n                console.log(res.message)\r\n\r\n                return false\r\n            }\r\n        }\r\n    })\r\n}*/\r\n\r\nexport function decryptFolderLinkKey(str, userMasterKeys){\r\n\tlet link = \"\"\r\n\r\n    if(userMasterKeys.length > 1){\r\n      \tuserMasterKeys = userMasterKeys.reverse()\r\n    }\r\n\r\n    userMasterKeys.forEach((key) => {\r\n        try{\r\n            let obj = CryptoJS.AES.decrypt(str, key).toString(CryptoJS.enc.Utf8)\r\n\r\n            if(obj && typeof obj == \"string\"){\r\n                if(obj.length >= 16){\r\n                \tlink = obj\r\n                }\r\n            }\r\n        }\r\n        catch(e){\r\n            return\r\n        }\r\n    })\r\n\r\n    return link\r\n}\r\n\r\nexport function checkIfItemIsBeingSharedForRename(type, uuid, metaData, optionalCallback){\r\n\tlet shareCheckDone = false\r\n\tlet linkCheckDone = false\r\n\r\n\tlet isItDoneInterval = undefined\r\n\tlet callbackFired = false\r\n\r\n\tconst isItDone = () => {\r\n\t\tif(shareCheckDone && linkCheckDone){\r\n\t\t\tclearInterval(isItDoneInterval)\r\n\r\n\t\t\tif(typeof optionalCallback == \"function\" && !callbackFired){\r\n\t\t\t\tcallbackFired = true\r\n\r\n\t\t\t \toptionalCallback()\r\n\t\t\t}\r\n\r\n\t\t\treturn true\r\n\t\t}\r\n\t}\r\n\r\n\tisItDoneInterval = setInterval(isItDone, 100)\r\n\r\n\tconst checkIfIsSharing = (itemUUID, tries, maxTries, callback) => {\r\n\t\tif(tries >= maxTries){\r\n\t\t\treturn callback(false)\r\n\t\t}\r\n\r\n\t\twindow.$.ajax({\r\n\t\t\turl: getAPIServer() + \"/v1/user/shared/item/status\",\r\n\t\t\ttype: \"POST\",\r\n\t\t\tcontentType: \"application/json\",\r\n\t\t\tdata: JSON.stringify({\r\n\t\t\t\tapiKey: window.customVariables.apiKey,\r\n\t\t\t\tuuid: itemUUID\r\n\t\t\t}),\r\n\t\t\tprocessData: false,\r\n\t\t\tcache: false,\r\n\t\t\ttimeout: 300000,\r\n\t\t\tsuccess: (res) => {\r\n\t\t\t\tif(!res){\r\n\t\t\t\t\tconsole.log(\"Request error\")\r\n\r\n\t\t\t\t\treturn setTimeout(() => {\r\n\t\t\t\t\t\tcheckIfIsSharing(itemUUID, (tries + 1), maxTries, callback)\r\n\t\t\t\t\t}, 1000)\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif(!res.status){\r\n\t\t\t\t\tcallback(false)\r\n\r\n\t\t\t\t\treturn console.log(res.message)\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn callback(res.data.sharing, res.data.users)\r\n\t\t\t},\r\n\t\t\terror: (err) => {\r\n\t\t\t\tconsole.log(err)\r\n\r\n\t\t\t\treturn setTimeout(() => {\r\n\t\t\t\t\tcheckIfIsSharing(itemUUID, (tries + 1), maxTries, callback)\r\n\t\t\t\t}, 1000)\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\tconst checkIfIsInFolderLink = (itemUUID, tries, maxTries, callback) => {\r\n\t\tif(tries >= maxTries){\r\n\t\t\treturn callback(false)\r\n\t\t}\r\n\r\n\t\twindow.$.ajax({\r\n\t\t\turl: getAPIServer() + \"/v1/link/dir/item/status\",\r\n\t\t\ttype: \"POST\",\r\n\t\t\tcontentType: \"application/json\",\r\n\t\t\tdata: JSON.stringify({\r\n\t\t\t\tapiKey: window.customVariables.apiKey,\r\n\t\t\t\tuuid: itemUUID\r\n\t\t\t}),\r\n\t\t\tprocessData: false,\r\n\t\t\tcache: false,\r\n\t\t\ttimeout: 300000,\r\n\t\t\tsuccess: (res) => {\r\n\t\t\t\tif(!res){\r\n\t\t\t\t\tconsole.log(\"Request error\")\r\n\r\n\t\t\t\t\treturn setTimeout(() => {\r\n\t\t\t\t\t\tcheckIfIsInFolderLink(itemUUID, (tries + 1), maxTries, callback)\r\n\t\t\t\t\t}, 1000)\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif(!res.status){\r\n\t\t\t\t\tcallback(false)\r\n\r\n\t\t\t\t\treturn console.log(res.message)\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn callback(res.data.link, res.data.links)\r\n\t\t\t},\r\n\t\t\terror: (err) => {\r\n\t\t\t\tconsole.log(err)\r\n\r\n\t\t\t\treturn setTimeout(() => {\r\n\t\t\t\t\tcheckIfIsInFolderLink(itemUUID, (tries + 1), maxTries, callback)\r\n\t\t\t\t}, 1000)\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\tconst renameItem = (data, tries, maxTries, callback) => {\r\n\t\tif(tries >= maxTries){\r\n\t\t\treturn callback(new Error(\"Max requests reached\"))\r\n\t\t}\r\n\r\n\t\twindow.$.ajax({\r\n\t\t\turl: getAPIServer() + \"/v1/link/dir/item/rename\",\r\n\t\t\ttype: \"POST\",\r\n\t\t\tcontentType: \"application/json\",\r\n\t\t\tdata: data,\r\n\t\t\tprocessData: false,\r\n\t\t\tcache: false,\r\n\t\t\ttimeout: 300000,\r\n\t\t\tsuccess: (res) => {\r\n\t\t\t\tif(!res){\r\n\t\t\t\t\tconsole.log(\"Request error\")\r\n\r\n\t\t\t\t\treturn setTimeout(() => {\r\n\t\t\t\t\t\trenameItem(data, (tries + 1), maxTries, callback)\r\n\t\t\t\t\t}, 1000)\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn callback(null)\r\n\t\t\t},\r\n\t\t\terror: (err) => {\r\n\t\t\t\tconsole.log(err)\r\n\r\n\t\t\t\treturn setTimeout(() => {\r\n\t\t\t\t\trenameItem(data, (tries + 1), maxTries, callback)\r\n\t\t\t\t}, 1000)\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\tconst shareItem = (data, tries, maxTries, callback) => {\r\n\t\tif(tries >= maxTries){\r\n\t\t\treturn callback(new Error(\"Max requests reached\"))\r\n\t\t}\r\n\r\n\t\twindow.$.ajax({\r\n\t\t\turl: getAPIServer() + \"/v1/user/shared/item/rename\",\r\n\t\t\ttype: \"POST\",\r\n\t\t\tcontentType: \"application/json\",\r\n\t\t\tdata: data,\r\n\t\t\tprocessData: false,\r\n\t\t\tcache: false,\r\n\t\t\ttimeout: 300000,\r\n\t\t\tsuccess: (res) => {\r\n\t\t\t\tif(!res){\r\n\t\t\t\t\tconsole.log(\"Request error\")\r\n\r\n\t\t\t\t\treturn setTimeout(() => {\r\n\t\t\t\t\t\tshareItem(data, (tries + 1), maxTries, callback)\r\n\t\t\t\t\t}, 1000)\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn callback(null)\r\n\t\t\t},\r\n\t\t\terror: (err) => {\r\n\t\t\t\tconsole.log(err)\r\n\r\n\t\t\t\treturn setTimeout(() => {\r\n\t\t\t\t\tshareItem(data, (tries + 1), maxTries, callback)\r\n\t\t\t\t}, 1000)\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\tcheckIfIsSharing(uuid, 0, 32, (isSharing, users) => {\r\n\t\tif(!isSharing){\r\n\t\t\tshareCheckDone = true\r\n\r\n\t\t\treturn isItDone()\r\n\t\t}\r\n\r\n\t\tlet totalUsers = users.length\r\n\t\tlet doneUsers = 0\r\n\r\n\t\tconst doneSharingToUsers = () => {\r\n\t\t\tdoneUsers += 1\r\n\r\n\t\t\tif(doneUsers >= totalUsers){\r\n\t\t\t\tshareCheckDone = true\r\n\r\n\t\t\t\treturn isItDone()\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tusers.forEach((user) => {\r\n\t\t\twindow.crypto.subtle.importKey(\"spki\", _base64ToArrayBuffer(user.publicKey), {\r\n      \t\t\tname: \"RSA-OAEP\",\r\n        \t\thash: \"SHA-512\"\r\n    \t\t}, true, [\"encrypt\"]).then((usrPubKey) => {\r\n    \t\t\tlet mData = \"\"\r\n\r\n    \t\t\tif(type == \"file\"){\r\n    \t\t\t\tmData = JSON.stringify({\r\n\t    \t\t\t\tname: metaData.name,\r\n\t    \t\t\t\tsize: parseInt(metaData.size),\r\n\t    \t\t\t\tmime: metaData.mime,\r\n\t    \t\t\t\tkey: metaData.key\r\n\t    \t\t\t})\r\n\t\t\t\t}\r\n\t\t\t\telse{\r\n\t\t\t\t\tmData = JSON.stringify({\r\n\t\t\t\t\t\tname: metaData.name\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\r\n\t\t\t\twindow.crypto.subtle.encrypt({\r\n    \t\t\t\tname: \"RSA-OAEP\"\r\n    \t\t\t}, usrPubKey, new TextEncoder().encode(mData)).then((encrypted) => {\r\n    \t\t\t\tshareItem(JSON.stringify({\r\n\t\t\t\t\t\tapiKey: window.customVariables.apiKey,\r\n\t\t\t\t\t\tuuid: uuid,\r\n\t\t\t\t\t\treceiverId: user.id,\r\n\t\t\t\t\t\tmetadata: base64ArrayBuffer(encrypted)\r\n\t\t\t\t\t}), 0, 32, (err) => {\r\n    \t\t\t\t\tif(err){\r\n    \t\t\t\t\t\tconsole.log(err)\r\n    \t\t\t\t\t}\r\n\r\n    \t\t\t\t\tdoneSharingToUsers()\r\n    \t\t\t\t})\r\n    \t\t\t}).catch((err) => {\r\n\t    \t\t\tdoneSharingToUsers()\r\n\t    \t\t})\r\n    \t\t}).catch((err) => {\r\n    \t\t\tdoneSharingToUsers()\r\n    \t\t})\r\n\t\t})\r\n\t})\r\n\r\n\tcheckIfIsInFolderLink(uuid, 0, 32, (isLinking, links) => {\r\n\t\tif(!isLinking){\r\n\t\t\tlinkCheckDone = true\r\n\r\n\t\t\treturn isItDone()\r\n\t\t}\r\n\r\n\t\tlet userMasterKeys = window.customVariables.userMasterKeys\r\n\r\n\t\tlet totalLinks = links.length\r\n\t\tlet linksDone = 0\r\n\r\n\t\tconst doneAddingToLink = () => {\r\n\t\t\tlinksDone += 1\r\n\r\n\t\t\tif(linksDone >= totalLinks){\r\n\t\t\t\tlinkCheckDone = true\r\n\r\n\t\t\t\treturn isItDone()\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tlinks.forEach((link) => {\r\n\t\t\tlet key = decryptFolderLinkKey(link.linkKey, userMasterKeys)\r\n\r\n\t\t\tlet mData = \"\"\r\n\r\n\t\t\tif(type == \"file\"){\r\n\t\t\t\tmData = JSON.stringify({\r\n    \t\t\t\tname: metaData.name,\r\n    \t\t\t\tsize: parseInt(metaData.size),\r\n    \t\t\t\tmime: metaData.mime,\r\n    \t\t\t\tkey: metaData.key\r\n    \t\t\t})\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\tmData = JSON.stringify({\r\n\t\t\t\t\tname: metaData.name\r\n\t\t\t\t})\r\n\t\t\t}\r\n\r\n\t\t\tmData = CryptoJS.AES.encrypt(mData, key).toString()\r\n\r\n\t\t\trenameItem(JSON.stringify({\r\n\t\t\t\tapiKey: window.customVariables.apiKey,\r\n\t\t\t\tuuid: uuid,\r\n\t\t\t\tlinkUUID: link.linkUUID,\r\n\t\t\t\tmetadata: mData\r\n\t\t\t}), 0, 32, (err) => {\r\n\t\t\t\tif(err){\r\n\t\t\t\t\tconsole.log(err)\r\n\t\t\t\t}\r\n\r\n\t\t\t\tdoneAddingToLink()\r\n\t\t\t})\r\n\t\t})\r\n\t})\r\n}\r\n\r\nexport function checkIfItemParentIsBeingShared(parentUUID, type, metaData, optionalCallback){\r\n\tlet shareCheckDone = false\r\n\tlet linkCheckDone = false\r\n\r\n\tlet isItDoneInterval = undefined\r\n\tlet callbackFired = false\r\n\r\n\tconst isItDone = () => {\r\n\t\tif(shareCheckDone && linkCheckDone){\r\n\t\t\tclearInterval(isItDoneInterval)\r\n\r\n\t\t\tif(typeof optionalCallback == \"function\" && !callbackFired){\r\n\t\t\t\tcallbackFired = true\r\n\t\t\t\t\r\n\t\t\t \toptionalCallback()\r\n\t\t\t}\r\n\r\n\t\t\treturn true\r\n\t\t}\r\n\t}\r\n\r\n\tisItDoneInterval = setInterval(isItDone, 100)\r\n\r\n\tconst checkIfIsSharing = (parent, tries, maxTries, callback) => {\r\n\t\tif(tries >= maxTries){\r\n\t\t\treturn callback(false)\r\n\t\t}\r\n\r\n\t\twindow.$.ajax({\r\n\t\t\turl: getAPIServer() + \"/v1/share/dir/status\",\r\n\t\t\ttype: \"POST\",\r\n\t\t\tcontentType: \"application/json\",\r\n\t\t\tdata: JSON.stringify({\r\n\t\t\t\tapiKey: window.customVariables.apiKey,\r\n\t\t\t\tuuid: parent\r\n\t\t\t}),\r\n\t\t\tprocessData: false,\r\n\t\t\tcache: false,\r\n\t\t\ttimeout: 300000,\r\n\t\t\tsuccess: (res) => {\r\n\t\t\t\tif(!res){\r\n\t\t\t\t\tconsole.log(\"Request error\")\r\n\r\n\t\t\t\t\treturn setTimeout(() => {\r\n\t\t\t\t\t\tcheckIfIsSharing(parent, (tries + 1), maxTries, callback)\r\n\t\t\t\t\t}, 1000)\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif(!res.status){\r\n\t\t\t\t\tconsole.log(res.message)\r\n\r\n\t\t\t\t\treturn callback(false)\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn callback(res.data.sharing, res.data.users)\r\n\t\t\t},\r\n\t\t\terror: (err) => {\r\n\t\t\t\tconsole.log(err)\r\n\r\n\t\t\t\treturn setTimeout(() => {\r\n\t\t\t\t\tcheckIfIsSharing(parent, (tries + 1), maxTries, callback)\r\n\t\t\t\t}, 1000)\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\tconst checkIfIsInFolderLink = (parent, tries, maxTries, callback) => {\r\n\t\tif(tries >= maxTries){\r\n\t\t\treturn callback(false)\r\n\t\t}\r\n\r\n\t\twindow.$.ajax({\r\n\t\t\turl: getAPIServer() + \"/v1/link/dir/status\",\r\n\t\t\ttype: \"POST\",\r\n\t\t\tcontentType: \"application/json\",\r\n\t\t\tdata: JSON.stringify({\r\n\t\t\t\tapiKey: window.customVariables.apiKey,\r\n\t\t\t\tuuid: parent\r\n\t\t\t}),\r\n\t\t\tprocessData: false,\r\n\t\t\tcache: false,\r\n\t\t\ttimeout: 300000,\r\n\t\t\tsuccess: (res) => {\r\n\t\t\t\tif(!res){\r\n\t\t\t\t\tconsole.log(\"Request error\")\r\n\r\n\t\t\t\t\treturn setTimeout(() => {\r\n\t\t\t\t\t\tcheckIfIsInFolderLink(parent, (tries + 1), maxTries, callback)\r\n\t\t\t\t\t}, 1000)\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif(!res.status){\r\n\t\t\t\t\tconsole.log(res.message)\r\n\r\n\t\t\t\t\treturn callback(false)\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn callback(res.data.link, res.data.links)\r\n\t\t\t},\r\n\t\t\terror: (err) => {\r\n\t\t\t\tconsole.log(err)\r\n\r\n\t\t\t\treturn setTimeout(() => {\r\n\t\t\t\t\tcheckIfIsInFolderLink(parent, (tries + 1), maxTries, callback)\r\n\t\t\t\t}, 1000)\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\tconst addItem = (data, tries, maxTries, callback) => {\r\n\t\tif(tries >= maxTries){\r\n\t\t\treturn callback(new Error(\"Max requests reached\"))\r\n\t\t}\r\n\r\n\t\twindow.$.ajax({\r\n\t\t\turl: getAPIServer() + \"/v1/dir/link/add\",\r\n\t\t\ttype: \"POST\",\r\n\t\t\tcontentType: \"application/json\",\r\n\t\t\tdata: data,\r\n\t\t\tprocessData: false,\r\n\t\t\tcache: false,\r\n\t\t\ttimeout: 300000,\r\n\t\t\tsuccess: (res) => {\r\n\t\t\t\tif(!res){\r\n\t\t\t\t\tconsole.log(\"Request error\")\r\n\r\n\t\t\t\t\treturn setTimeout(() => {\r\n\t\t\t\t\t\taddItem(data, (tries + 1), maxTries, callback)\r\n\t\t\t\t\t}, 1000)\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn callback(null)\r\n\t\t\t},\r\n\t\t\terror: (err) => {\r\n\t\t\t\tconsole.log(err)\r\n\r\n\t\t\t\treturn setTimeout(() => {\r\n\t\t\t\t\taddItem(data, (tries + 1), maxTries, callback)\r\n\t\t\t\t}, 1000)\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\tconst shareItem = (data, tries, maxTries, callback) => {\r\n\t\tif(tries >= maxTries){\r\n\t\t\treturn callback(new Error(\"Max requests reached\"))\r\n\t\t}\r\n\r\n\t\twindow.$.ajax({\r\n\t\t\turl: getAPIServer() + \"/v1/share\",\r\n\t\t\ttype: \"POST\",\r\n\t\t\tcontentType: \"application/json\",\r\n\t\t\tdata: data,\r\n\t\t\tprocessData: false,\r\n\t\t\tcache: false,\r\n\t\t\ttimeout: 300000,\r\n\t\t\tsuccess: (res) => {\r\n\t\t\t\tif(!res){\r\n\t\t\t\t\tconsole.log(\"Request error\")\r\n\r\n\t\t\t\t\treturn setTimeout(() => {\r\n\t\t\t\t\t\tshareItem(data, (tries + 1), maxTries, callback)\r\n\t\t\t\t\t}, 1000)\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn callback(null)\r\n\t\t\t},\r\n\t\t\terror: (err) => {\r\n\t\t\t\tconsole.log(err)\r\n\r\n\t\t\t\treturn setTimeout(() => {\r\n\t\t\t\t\tshareItem(data, (tries + 1), maxTries, callback)\r\n\t\t\t\t}, 1000)\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\tcheckIfIsSharing(parentUUID, 0, 32, (status, users) => {\r\n\t\tif(!status){\r\n\t\t\tshareCheckDone = true\r\n\r\n\t\t\treturn isItDone()\r\n\t\t}\r\n\r\n\t\tlet totalUsers = users.length\r\n\t\tlet doneUsers = 0\r\n\r\n\t\tconst doneSharingToUsers = () => {\r\n\t\t\tdoneUsers += 1\r\n\r\n\t\t\tif(doneUsers >= totalUsers){\r\n\t\t\t\tshareCheckDone = true\r\n\r\n\t\t\t\treturn isItDone()\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tusers.forEach((user) => {\r\n\t\t\twindow.crypto.subtle.importKey(\"spki\", _base64ToArrayBuffer(user.publicKey), {\r\n      \t\t\tname: \"RSA-OAEP\",\r\n        \t\thash: \"SHA-512\"\r\n    \t\t}, true, [\"encrypt\"]).then((usrPubKey) => {\r\n    \t\t\tlet mData = \"\"\r\n\r\n    \t\t\tif(type == \"file\"){\r\n    \t\t\t\tmData = JSON.stringify({\r\n\t    \t\t\t\tname: metaData.name,\r\n\t    \t\t\t\tsize: parseInt(metaData.size),\r\n\t    \t\t\t\tmime: metaData.mime,\r\n\t    \t\t\t\tkey: metaData.key\r\n\t    \t\t\t})\r\n\t\t\t\t}\r\n\t\t\t\telse{\r\n\t\t\t\t\tmData = JSON.stringify({\r\n\t\t\t\t\t\tname: metaData.name\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\r\n\t\t\t\twindow.crypto.subtle.encrypt({\r\n    \t\t\t\tname: \"RSA-OAEP\"\r\n    \t\t\t}, usrPubKey, new TextEncoder().encode(mData)).then((encrypted) => {\r\n    \t\t\t\tshareItem(JSON.stringify({\r\n\t\t\t\t\t\tapiKey: window.customVariables.apiKey,\r\n\t\t\t\t\t\tuuid: metaData.uuid,\r\n\t\t\t\t\t\tparent: parentUUID,\r\n\t\t\t\t\t\temail: user.email,\r\n\t\t\t\t\t\ttype: type,\r\n\t\t\t\t\t\tmetadata: base64ArrayBuffer(encrypted)\r\n\t\t\t\t\t}), 0, 32, (err) => {\r\n    \t\t\t\t\tif(err){\r\n    \t\t\t\t\t\tconsole.log(err)\r\n    \t\t\t\t\t}\r\n\r\n    \t\t\t\t\tdoneSharingToUsers()\r\n\t\t\t\t\t})\r\n    \t\t\t}).catch((err) => {\r\n\t    \t\t\tdoneSharingToUsers()\r\n\t    \t\t})\r\n    \t\t}).catch((err) => {\r\n    \t\t\tdoneSharingToUsers()\r\n    \t\t})\r\n\t\t})\r\n\t})\r\n\r\n\tcheckIfIsInFolderLink(parentUUID, 0, 32, (status, links) => {\r\n\t\tif(!status){\r\n\t\t\tlinkCheckDone = true\r\n\r\n\t\t\treturn isItDone()\r\n\t\t}\r\n\r\n\t\tlet userMasterKeys = window.customVariables.userMasterKeys\r\n\r\n\t\tlet totalLinks = links.length\r\n\t\tlet linksDone = 0\r\n\r\n\t\tconst doneAddingToLink = () => {\r\n\t\t\tlinksDone += 1\r\n\r\n\t\t\tif(linksDone >= totalLinks){\r\n\t\t\t\tlinkCheckDone = true\r\n\r\n\t\t\t\treturn isItDone()\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tlinks.forEach((link) => {\r\n\t\t\tlet key = decryptFolderLinkKey(link.linkKey, userMasterKeys)\r\n\r\n\t\t\tlet mData = \"\"\r\n\r\n\t\t\tif(type == \"file\"){\r\n\t\t\t\tmData = JSON.stringify({\r\n\t\t\t\t\tname: metaData.name,\r\n\t\t\t\t\tsize: parseInt(metaData.size),\r\n\t\t\t\t\tmime: metaData.mime,\r\n\t\t\t\t\tkey: metaData.key\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\tmData = JSON.stringify({\r\n\t\t\t\t\tname: metaData.name\r\n\t\t\t\t})\r\n\t\t\t}\r\n\r\n\t\t\tmData = CryptoJS.AES.encrypt(mData, key).toString()\r\n\r\n\t\t\taddItem(JSON.stringify({\r\n\t\t\t\tapiKey: window.customVariables.apiKey,\r\n\t\t\t\tuuid: metaData.uuid,\r\n\t\t\t\tparent: parentUUID,\r\n\t\t\t\tlinkUUID: link.linkUUID,\r\n\t\t\t\ttype: type,\r\n\t\t\t\tmetadata: mData,\r\n\t\t\t\tkey: link.linkKey,\r\n\t\t\t\texpiration: \"never\",\r\n\t\t\t\tpassword: \"empty\",\r\n\t\t\t\tpasswordHashed: hashFn(\"empty\"),\r\n\t\t\t\tdownloadBtn: \"enable\"\r\n\t\t\t}), 0, 32, (err) => {\r\n\t\t\t\tif(err){\r\n\t\t\t\t\tconsole.log(err)\r\n\t\t\t\t}\r\n\r\n\t\t\t\tdoneAddingToLink()\r\n\t\t\t})\r\n\t\t})\r\n\t})\r\n}\r\n\r\nexport function currentParentFolder(){\r\n    let ex = window.location.href.split(\"/\")\r\n\r\n    return ex[ex.length - 1]\r\n}\r\n\r\nexport function canCompressThumbnail(ext){\r\n    switch(ext.toLowerCase()){\r\n        case \"jpeg\":\r\n        case \"jpg\":\r\n        case \"png\":\r\n        case \"gif\":\r\n            return true\r\n        break\r\n        default:\r\n            return false\r\n        break\r\n    }\r\n}\r\n\r\nexport function canShowThumbnail(ext){\r\n    switch(ext.toLowerCase()){\r\n        case \"jpeg\":\r\n        case \"jpg\":\r\n        case \"png\":\r\n        case \"gif\":\r\n        case \"svg\":\r\n        case \"mp4\":\r\n        case \"webm\":\r\n        case \"avi\":\r\n        case \"mov\":\r\n        case \"wmv\":\r\n            return true\r\n        break\r\n        default:\r\n            return false\r\n        break\r\n    }\r\n}\r\n\r\nexport function getFilePreviewType(ext){\r\n    switch(ext.toLowerCase()){\r\n      case \"jpeg\":\r\n      case \"jpg\":\r\n      case \"png\":\r\n      case \"gif\":\r\n      case \"svg\":\r\n        return \"image\"\r\n      break\r\n      case \"mp3\":\r\n      case \"mp2\":\r\n      case \"wav\":\r\n      case \"ogg\":\r\n      case \"m4a\":\r\n      case \"aac\":\r\n      case \"flac\":\r\n      case \"midi\":\r\n      case \"xmf\":\r\n      case \"rtx\":\r\n      case \"ota\":\r\n      case \"mpa\":\r\n      case \"aif\":\r\n      case \"rtttl\":\r\n      case \"wma\":\r\n        return \"audio\"\r\n      break\r\n      case \"mp4\":\r\n      case \"webm\":\r\n      case \"mkv\":\r\n      case \"flv\":\r\n      case \"mov\":\r\n      case \"ogv\":\r\n      case \"3gp\":\r\n      case \"avi\":\r\n        return \"video\"\r\n      break\r\n      case \"json\":\r\n      case \"js\":\r\n      case \"md\":\r\n      case \"php\":\r\n      case \"css\":\r\n      case \"c\":\r\n      case \"perl\":\r\n      case \"html\":\r\n      case \"html5\":\r\n      case \"jsx\":\r\n      case \"php5\":\r\n      case \"yml\":\r\n      case \"md\":\r\n      case \"xml\":\r\n      case \"sql\":\r\n      case \"java\":\r\n      case \"csharp\":\r\n      case \"dist\":\r\n      case \"py\":\r\n      case \"cc\":\r\n      case \"cpp\":\r\n      case \"log\":\r\n      case \"conf\":\r\n      case \"cxx\":\r\n      case \"ini\":\r\n      case \"lock\":\r\n      case \"bat\":\r\n      case \"sh\":\r\n      case \"properties\":\r\n      case \"cfg\":\r\n      case \"ahk\":\r\n      case \"ts\":\r\n      case \"tsx\":\r\n        return \"code\"\r\n      break\r\n      case \"txt\":\r\n      case \"rtf\":\r\n        return \"text\"\r\n      break\r\n      case \"pdf\":\r\n        return \"pdf\"\r\n      break\r\n      default:\r\n        return \"none\"\r\n      break\r\n    }\r\n}\r\n\r\nexport function escapeHTML(str){\r\n    if(typeof str !== \"string\"){\r\n      return str\r\n    }\r\n  \r\n    if(str.length == 0){\r\n      return str\r\n    }\r\n  \r\n    return str.replace(/(<([^>]+)>)/ig, \"\")\r\n}\r\n\r\nexport function getFileIconFromName(name){\r\n    let ex = name.split(\".\")\r\n\r\n    return getFileIcon(ex[ex.length - 1].toLowerCase())\r\n}\r\n\r\nexport function getFileIcon(ext){\r\n    switch(ext.toLowerCase()){\r\n      case \"pdf\":\r\n        return `assets/img/types/pdf.svg`\r\n      break\r\n      case \"doc\":\r\n      case \"docx\":\r\n        return `assets/img/types/doc.svg`\r\n      break\r\n      case \"exe\":\r\n        return `assets/img/types/exe.svg`\r\n      break\r\n      case \"mp3\":\r\n        return `assets/img/types/mp3.svg`\r\n      break\r\n      case \"json\":\r\n        return `assets/img/types/json-file.svg`\r\n      break\r\n      case \"png\":\r\n        return `assets/img/types/png.svg`\r\n      break\r\n      case \"ico\":\r\n        return `assets/img/types/ico.svg`\r\n      break\r\n      case \"txt\":\r\n        return `assets/img/types/txt.svg`\r\n      break\r\n      case \"jpg\":\r\n      case \"jpeg\":\r\n        return `assets/img/types/jpg.svg`\r\n      break\r\n      case \"iso\":\r\n        return `assets/img/types/iso.svg`\r\n      break\r\n      case \"js\":\r\n        return `assets/img/types/javascript.svg`\r\n      break\r\n      case \"html\":\r\n        return `assets/img/types/html.svg`\r\n      break\r\n      case \"css\":\r\n        return `assets/img/types/css.svg`\r\n      break\r\n      case \"csv\":\r\n        return `assets/img/types/csv.svg`\r\n      break\r\n      case \"avi\":\r\n        return `assets/img/types/avi.svg`\r\n      break\r\n      case \"mp4\":\r\n        return `assets/img/types/mp4.svg`\r\n      break\r\n      case \"ppt\":\r\n        return `assets/img/types/ppt.svg`\r\n      break\r\n      case \"zip\":\r\n        return `assets/img/types/zip.svg`\r\n      break\r\n      case \"rar\":\r\n      case \"tar\":\r\n      case \"tgz\":\r\n      case \"gz\":\r\n      case \"gzip\":\r\n        return `assets/img/types/zip-1.svg`\r\n      break\r\n      case \"txt\":\r\n        return `assets/img/types/txt.svg`\r\n      break\r\n      case \"svg\":\r\n        return `assets/img/types/svg.svg`\r\n      break\r\n      case \"xml\":\r\n        return `assets/img/types/xml.svg`\r\n      break\r\n      case \"dwg\":\r\n        return `assets/img/types/dwg.svg`\r\n      break\r\n      case \"fla\":\r\n        return `assets/img/types/fla.svg`\r\n      break\r\n      case \"ai\":\r\n        return `assets/img/types/ai.svg`\r\n      break\r\n      default:\r\n        return `assets/img/types/file.svg`\r\n      break\r\n    }\r\n}\r\n\r\nexport function uInt8ArrayConcat(arrays){\r\n    // sum of individual array lengths\r\n    let totalLength = arrays.reduce((acc, value) => acc + value.length, 0);\r\n  \r\n    if (!arrays.length) return null;\r\n  \r\n    let result = new Uint8Array(totalLength);\r\n  \r\n    // for each array - copy it over result\r\n    // next array is copied right after the previous one\r\n    let length = 0;\r\n    for(let array of arrays) {\r\n      result.set(array, length);\r\n      length += array.length;\r\n    }\r\n  \r\n    return result;\r\n}\r\n\r\nexport function orderItemsByType(items, type){\r\n    let files = []\r\n    let folders = []\r\n\r\n    for(let i = 0; i < items.length; i++){\r\n        if(items[i].type == \"file\"){\r\n            files.push(items[i])\r\n        }\r\n        else{\r\n            folders.push(items[i])\r\n        }\r\n    }\r\n\r\n    if(type == \"nameAsc\"){\r\n        let sortedFiles = files.sort((a, b) => {\r\n            return a.name.localeCompare(b.name)\r\n        })\r\n\r\n        let sortedFolders = folders.sort((a, b) => {\r\n            return a.name.localeCompare(b.name)\r\n        })\r\n\r\n        return sortedFolders.concat(sortedFiles)\r\n    }\r\n    else if(type == \"sizeAsc\"){\r\n        let sortedFiles = files.sort((a, b) => {\r\n            return a.size - b.size\r\n        })\r\n\r\n        let sortedFolders = folders.sort((a, b) => {\r\n            return b.timestamp - a.timestamp\r\n        })\r\n\r\n        return sortedFolders.concat(sortedFiles)\r\n    }\r\n    else if(type == \"dateAsc\"){\r\n        let sortedFiles = files.sort((a, b) => {\r\n            return a.timestamp - b.timestamp\r\n        })\r\n\r\n        let sortedFolders = folders.sort((a, b) => {\r\n            return a.timestamp - b.timestamp\r\n        })\r\n\r\n        return sortedFolders.concat(sortedFiles)\r\n    }\r\n    else if(type == \"typeAsc\"){\r\n        let sortedFiles = files.sort((a, b) => {\r\n            if(typeof a.mime == \"undefined\"){\r\n                a.mime = \"_\"\r\n            }\r\n\r\n            if(typeof b.mime == \"undefined\"){\r\n                b.mime = \"_\"\r\n            }\r\n\r\n            if(a.mime.length <= 1){\r\n                a.mime = \"_\"\r\n            }\r\n\r\n            if(b.mime.length <= 1){\r\n                b.mime = \"_\"\r\n            }\r\n\r\n            return a.mime.localeCompare(b.mime)\r\n        })\r\n\r\n        let sortedFolders = folders.sort((a, b) => {\r\n            return b.timestamp - a.timestamp\r\n        })\r\n\r\n        return sortedFolders.concat(sortedFiles)\r\n    }\r\n    else if(type == \"nameDesc\"){\r\n        let sortedFiles = files.sort((a, b) => {\r\n            return b.name.localeCompare(a.name)\r\n        })\r\n\r\n        let sortedFolders = folders.sort((a, b) => {\r\n            return b.name.localeCompare(a.name)\r\n        })\r\n\r\n        return sortedFolders.concat(sortedFiles)\r\n    }\r\n    else if(type == \"sizeDesc\"){\r\n        let sortedFiles = files.sort((a, b) => {\r\n            return b.size - a.size\r\n        })\r\n\r\n        let sortedFolders = folders.sort((a, b) => {\r\n            return b.timestamp - a.timestamp\r\n        })\r\n\r\n        return sortedFolders.concat(sortedFiles)\r\n    }\r\n    else if(type == \"typeDesc\"){\r\n        let sortedFiles = files.sort((a, b) => {\r\n            if(typeof a.mime == \"undefined\"){\r\n                a.mime = \"_\"\r\n            }\r\n\r\n            if(typeof b.mime == \"undefined\"){\r\n                b.mime = \"_\"\r\n            }\r\n\r\n            if(a.mime.length <= 1){\r\n                a.mime = \"_\"\r\n            }\r\n\r\n            if(b.mime.length <= 1){\r\n                b.mime = \"_\"\r\n            }\r\n\r\n            return b.mime.localeCompare(a.mime)\r\n        })\r\n\r\n        let sortedFolders = folders.sort((a, b) => {\r\n            return b.timestamp - a.timestamp\r\n        })\r\n\r\n        return sortedFolders.concat(sortedFiles)\r\n    }\r\n    else{\r\n        //default, dateDesc\r\n\r\n        let sortedFiles = files.sort((a, b) => {\r\n            return b.timestamp - a.timestamp\r\n        })\r\n\r\n        let sortedFolders = folders.sort((a, b) => {\r\n            return b.timestamp - a.timestamp\r\n        })\r\n\r\n        return sortedFolders.concat(sortedFiles)\r\n    }\r\n}\r\n\r\nexport function getVideoCover(file, seekTo = 0.0) {\r\n    return new Promise((resolve, reject) => {\r\n        // load the file to a video player\r\n        const videoPlayer = document.createElement('video');\r\n        videoPlayer.setAttribute('src', URL.createObjectURL(file));\r\n        videoPlayer.load();\r\n        videoPlayer.addEventListener('error', (ex) => {\r\n            reject(\"error when loading video file\", ex);\r\n        });\r\n        // load metadata of the video to get video duration and dimensions\r\n        videoPlayer.addEventListener('loadedmetadata', () => {\r\n            // seek to user defined timestamp (in seconds) if possible\r\n            if (videoPlayer.duration < seekTo) {\r\n                reject(\"video is too short.\");\r\n                return;\r\n            }\r\n\r\n            if(videoPlayer.duration >= 1){\r\n            \tseekTo = 1.0\r\n            }\r\n\r\n            // delay seeking or else 'seeked' event won't fire on Safari\r\n            setTimeout(() => {\r\n              videoPlayer.currentTime = seekTo;\r\n            }, 200);\r\n            // extract video thumbnail once seeking is complete\r\n            videoPlayer.addEventListener('seeked', () => {\r\n                // define a canvas to have the same dimension as the video\r\n                const canvas = document.createElement(\"canvas\");\r\n                canvas.width = videoPlayer.videoWidth;\r\n                canvas.height = videoPlayer.videoHeight;\r\n                // draw the video frame to canvas\r\n                const ctx = canvas.getContext(\"2d\");\r\n                ctx.drawImage(videoPlayer, 0, 0, canvas.width, canvas.height);\r\n                // return the canvas image as a blob\r\n                ctx.canvas.toBlob(\r\n                    blob => {\r\n                        resolve(blob);\r\n                    },\r\n                    \"image/jpeg\",\r\n                    0.1 /* quality */\r\n                );\r\n            });\r\n        });\r\n    });\r\n}\r\n\r\nexport function parseQuery(queryString) {\r\n    var query = {};\r\n    var pairs = (queryString[0] === '?' ? queryString.substr(1) : queryString).split('&');\r\n    for (var i = 0; i < pairs.length; i++) {\r\n        var pair = pairs[i].split('=');\r\n        query[decodeURIComponent(pair[0])] = decodeURIComponent(pair[1] || '');\r\n    }\r\n    return query;\r\n}\r\n\r\nexport function getQueryVariable(variable) {\r\n    var query = window.location.search.substring(1);\r\n    var vars = query.split('&');\r\n    for (var i = 0; i < vars.length; i++) {\r\n        var pair = vars[i].split('=');\r\n        if (decodeURIComponent(pair[0]) == variable) {\r\n            return decodeURIComponent(pair[1]);\r\n        }\r\n    }\r\n    console.log('Query variable %s not found', variable);\r\n}\r\n\r\nexport function getLanguageSelection(){\r\n    return `\r\n        <ion-select-option value=\"en\">English</ion-select-option>\r\n        <ion-select-option value=\"de\">Deutsch</ion-select-option>\r\n        <ion-select-option value=\"nl\">Nederlands</ion-select-option>\r\n        <ion-select-option value=\"hi\">हिन्दी, हिंदी</ion-select-option>\r\n        <ion-select-option value=\"fr\">Français</ion-select-option>\r\n        <ion-select-option value=\"da\">Dansk</ion-select-option>\r\n        <ion-select-option value=\"es\">Español</ion-select-option>\r\n    `\r\n}\r\n\r\nexport function getFolderColorStyle(color = null, onlyColor = false){\r\n\tlet folderColorStyle = \"\"\r\n\r\n\tswitch(color){\r\n\t\tcase \"default\":\r\n            folderColorStyle = \"style='color: #F6C358;'\"\r\n            \r\n            if(onlyColor){\r\n                folderColorStyle = \"#F6C358\"\r\n            }\r\n\t\tbreak\r\n\t\tcase \"blue\":\r\n            folderColorStyle = \"style='color: #2992E5;'\"\r\n            \r\n            if(onlyColor){\r\n                folderColorStyle = \"#2992E5\"\r\n            }\r\n\t\tbreak\r\n\t\tcase \"green\":\r\n            folderColorStyle = \"style='color: #57A15B;'\"\r\n            \r\n            if(onlyColor){\r\n                folderColorStyle = \"#57A15B\"\r\n            }\r\n\t\tbreak\r\n\t\tcase \"purple\":\r\n            folderColorStyle = \"style='color: #8E3A9D;'\"\r\n            \r\n            if(onlyColor){\r\n                folderColorStyle = \"#8E3A9D\"\r\n            }\r\n\t\tbreak\r\n\t\tcase \"red\":\r\n            folderColorStyle = \"style='color: #CB2E35;'\"\r\n            \r\n            if(onlyColor){\r\n                folderColorStyle = \"#CB2E35\"\r\n            }\r\n\t\tbreak\r\n\t\tcase \"gray\":\r\n            folderColorStyle = \"style='color: gray;'\"\r\n            \r\n            if(onlyColor){\r\n                folderColorStyle = \"gray\"\r\n            }\r\n\t\tbreak\r\n\t\tdefault:\r\n            folderColorStyle = \"style='color: #F6C358;'\"\r\n            \r\n            if(onlyColor){\r\n                folderColorStyle = \"#F6C358\"\r\n            }\r\n\t\tbreak\r\n\t}\r\n\r\n\treturn folderColorStyle\r\n}\r\n\r\nexport function copyTextToClipboardWeb(text){\r\n\tvar textArea = document.createElement(\"textarea\")\r\n\r\n\ttextArea.style.position = \"fixed\"\r\n\ttextArea.style.top = 0\r\n\ttextArea.style.left = 0\r\n\ttextArea.style.width = \"2em\"\r\n\ttextArea.style.height = \"2em\"\r\n\ttextArea.style.padding = 0\r\n\ttextArea.style.border = \"none\"\r\n\ttextArea.style.outline = \"none\"\r\n\ttextArea.style.boxShadow = \"none\"\r\n\ttextArea.style.background = \"transparent\"\r\n\r\n\ttextArea.value = text\r\n\r\n\tdocument.body.appendChild(textArea)\r\n\r\n\ttextArea.focus()\r\n\ttextArea.select()\r\n\r\n\ttry{\r\n\t\tdocument.execCommand(\"copy\")\r\n\t}\r\n\tcatch(e){\r\n\t\treturn console.log(e)\r\n\t}\r\n\r\n\t//alert(\"Link copied to clipboard!\")\r\n\r\n\treturn document.body.removeChild(textArea)\r\n}"]},"metadata":{},"sourceType":"module"}