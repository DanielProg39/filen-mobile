{"ast":null,"code":"import _createForOfIteratorHelper from\"/Users/jan/Documents/filen/app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";import _regeneratorRuntime from\"/Users/jan/Documents/filen/app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/jan/Documents/filen/app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import{Capacitor,Plugins}from\"@capacitor/core\";var CryptoJS=require(\"crypto-js\");var striptags=require(\"striptags\");export function sanitizeHTML(html){return striptags(html);}export function getRandomArbitrary(min,max){return Math.floor(Math.random()*(max-min)+min);}export function formatBytes(bytes){var decimals=arguments.length>1&&arguments[1]!==undefined?arguments[1]:2;if(bytes===0)return\"0 Bytes\";var k=1024;var dm=decimals<0?0:decimals;var sizes=[\"Bytes\",\"KB\",\"MB\",\"GB\",\"TB\",\"PB\",\"EB\",\"ZB\",\"YB\"];var i=Math.floor(Math.log(bytes)/Math.log(k));return parseFloat((bytes/Math.pow(k,i)).toFixed(dm))+\" \"+sizes[i];}export function uuidv4(){// Public Domain/MIT\nvar d=new Date().getTime();//Timestamp\nvar d2=performance&&performance.now&&performance.now()*1000||0;//Time in microseconds since page-load or 0 if unsupported\nreturn'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g,function(c){var r=Math.random()*16;//random number between 0 and 16\nif(d>0){//Use timestamp until depleted\nr=(d+r)%16|0;d=Math.floor(d/16);}else{//Use microseconds since page-load if supported\nr=(d2+r)%16|0;d2=Math.floor(d2/16);}return(c==='x'?r:r&0x3|0x8).toString(16);});}export function generateRandomString(){var length=arguments.length>0&&arguments[0]!==undefined?arguments[0]:32;var result=\"\";var characters=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\";for(var i=0;i<length;i++){result+=characters.charAt(Math.floor(Math.random()*characters.length));}return result;}export function generateRandomClassName(){var length=arguments.length>0&&arguments[0]!==undefined?arguments[0]:16;var result=\"\";var characters=\"abcdefghijklmnopqrstuvwxyz\";for(var i=0;i<length;i++){result+=characters.charAt(Math.floor(Math.random()*characters.length));}return result+\"-\"+result;}export function getAPIServer(){var servers=[\"https://api.filen.io\",\"https://api.filen-1.xyz\",\"https://api.filen-2.xyz\",\"https://api.filen-3.xyz\",\"https://api.filen-4.xyz\",\"https://api.filen-5.xyz\"];return servers[getRandomArbitrary(0,servers.length-1)];}export function fetchWithTimeout(ms,promise){return new Promise(function(resolve,reject){var timer=setTimeout(function(){return reject(new Error(\"Request timeout after \"+ms+\"ms\"));},ms);promise.then(function(value){clearTimeout(timer);return resolve(value);}).catch(function(err){clearTimeout(timer);return reject(err);});});}export function apiRequest(method,endpoint){var data=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};return new Promise(function(resolve,reject){var cacheKey=method+endpoint;if(Capacitor.isNative){if(Plugins.Network.getStatus()==\"none\"){if(typeof window.customVariables.apiCache[cacheKey]!==\"undefined\"){return resolve(window.customVariables.apiCache[cacheKey]);}}}fetchWithTimeout(30000,fetch(getAPIServer()+endpoint,{method:method.toUpperCase(),cache:\"no-cache\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify(data)})).then(function(response){response.json().then(function(obj){if(endpoint==\"/v1/dir/content\"||endpoint==\"/v1/user/baseFolders\"||endpoint==\"/v1/user/shared/in\"||endpoint==\"/v1/user/shared/out\"||endpoint==\"/v1/user/usage\"||endpoint==\"/v1/user/keyPair/info\"){window.customVariables.apiCache[cacheKey]=obj;window.customFunctions.saveAPICache();}return resolve(obj);}).catch(function(err){console.log(err);if(typeof window.customVariables.apiCache[cacheKey]!==\"undefined\"){return resolve(window.customVariables.apiCache[cacheKey]);}return reject(err);});}).catch(function(err){console.log(err);if(typeof window.customVariables.apiCache[cacheKey]!==\"undefined\"){return resolve(window.customVariables.apiCache[cacheKey]);}return reject(err);});});}export function getDownloadServer(){var servers=[\"https://down.filen-1.xyz\",\"https://down.filen-2.xyz\",\"https://down.filen-3.xyz\",\"https://down.filen-4.xyz\",\"https://down.filen-5.xyz\"];return servers[getRandomArbitrary(0,servers.length-1)];}export function getUploadServer(){var servers=[\"https://up.filen-1.xyz\",\"https://up.filen-2.xyz\",\"https://up.filen-3.xyz\",\"https://up.filen-4.xyz\",\"https://up.filen-5.xyz\"];return servers[getRandomArbitrary(0,servers.length-1)];}export function hashFn(val){return CryptoJS.SHA1(CryptoJS.SHA512(val).toString()).toString();}export function cryptoJSEncrypt(val,key){return CryptoJS.AES.encrypt(val,key).toString();}export function cryptoJSDecrypt(val,key){return CryptoJS.AES.decrypt(val,key).toString(CryptoJS.enc.Utf8);}export function unixTimestamp(){return Math.floor(+new Date()/1000);}export function decryptCryptoJSFolderName(str,userMasterKeys){var uuid=arguments.length>2&&arguments[2]!==undefined?arguments[2]:undefined;var cacheKey=\"folder_\"+uuid+\"_\"+str;if(window.customVariables.cachedMetadata[cacheKey]){return window.customVariables.cachedMetadata[cacheKey].name;}var folderName=\"CON_NO_DECRYPT_POSSIBLE_NO_NAME_FOUND_FOR_FOLDER\";userMasterKeys=userMasterKeys.reverse();var obj=undefined;userMasterKeys.forEach(function(key){try{obj=JSON.parse(CryptoJS.AES.decrypt(str,key).toString(CryptoJS.enc.Utf8));if(obj&&typeof obj==\"object\"){folderName=obj.name;}}catch(e){return;}});if(folderName!==\"CON_NO_DECRYPT_POSSIBLE_NO_NAME_FOUND_FOR_FOLDER\"){window.customVariables.cachedMetadata[cacheKey]={name:folderName};}return folderName;}export function decryptFolderNamePrivateKey(_x,_x2){return _decryptFolderNamePrivateKey.apply(this,arguments);}function _decryptFolderNamePrivateKey(){_decryptFolderNamePrivateKey=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(str,usrPrivKey){var uuid,cacheKey,folderName,decrypted,_args5=arguments;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:uuid=_args5.length>2&&_args5[2]!==undefined?_args5[2]:undefined;cacheKey=\"folder_\"+uuid+\"_\"+str;if(!window.customVariables.cachedMetadata[cacheKey]){_context5.next=4;break;}return _context5.abrupt(\"return\",window.customVariables.cachedMetadata[cacheKey].name);case 4:folderName=\"CON_NO_DECRYPT_POSSIBLE_NO_NAME_FOUND_FOR_FOLDER\";_context5.prev=5;_context5.next=8;return window.crypto.subtle.decrypt({name:\"RSA-OAEP\"},usrPrivKey,_base64ToArrayBuffer(str));case 8:decrypted=_context5.sent;decrypted=JSON.parse(new TextDecoder().decode(decrypted));if(decrypted&&typeof decrypted==\"object\"){folderName=decrypted.name;}_context5.next=16;break;case 13:_context5.prev=13;_context5.t0=_context5[\"catch\"](5);console.log(_context5.t0);case 16:if(folderName!==\"CON_NO_DECRYPT_POSSIBLE_NO_NAME_FOUND_FOR_FOLDER\"){window.customVariables.cachedMetadata[cacheKey]={name:folderName};}return _context5.abrupt(\"return\",folderName);case 18:case\"end\":return _context5.stop();}}},_callee5,null,[[5,13]]);}));return _decryptFolderNamePrivateKey.apply(this,arguments);}export function decryptFileMetadata(metadata,userMasterKeys){var uuid=arguments.length>2&&arguments[2]!==undefined?arguments[2]:undefined;var cacheKey=\"folder_\"+uuid+\"_\"+metadata;if(window.customVariables.cachedMetadata[cacheKey]){var file=window.customVariables.cachedMetadata[cacheKey];return{name:file.name,size:file.size,mime:file.mime,key:file.key};}var fileName=\"\";var fileSize=0;var fileMime=\"\";var fileKey=\"\";userMasterKeys=userMasterKeys.reverse();userMasterKeys.forEach(function(key){try{var _obj=JSON.parse(CryptoJS.AES.decrypt(metadata,key).toString(CryptoJS.enc.Utf8));if(_obj&&typeof _obj==\"object\"){fileName=_obj.name;fileSize=parseInt(_obj.size);fileMime=_obj.mime;fileKey=_obj.key;}}catch(e){return;}});var obj={name:fileName,size:fileSize,mime:fileMime,key:fileKey};if(obj.name.length>=1){window.customVariables.cachedMetadata[cacheKey]=obj;}return obj;}export function decryptFileMetadataPrivateKey(_x3,_x4){return _decryptFileMetadataPrivateKey.apply(this,arguments);}function _decryptFileMetadataPrivateKey(){_decryptFileMetadataPrivateKey=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(str,usrPrivKey){var uuid,cacheKey,file,fileName,fileSize,fileMime,fileKey,decrypted,obj,_args6=arguments;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:uuid=_args6.length>2&&_args6[2]!==undefined?_args6[2]:undefined;cacheKey=\"folder_\"+uuid+\"_\"+str;if(!window.customVariables.cachedMetadata[cacheKey]){_context6.next=5;break;}file=window.customVariables.cachedMetadata[cacheKey];return _context6.abrupt(\"return\",{name:file.name,size:file.size,mime:file.mime,key:file.key});case 5:fileName=\"\";fileSize=0;fileMime=\"\";fileKey=\"\";_context6.prev=9;_context6.next=12;return window.crypto.subtle.decrypt({name:\"RSA-OAEP\"},usrPrivKey,_base64ToArrayBuffer(str));case 12:decrypted=_context6.sent;decrypted=JSON.parse(new TextDecoder().decode(decrypted));if(decrypted&&typeof decrypted==\"object\"){fileName=decrypted.name;fileSize=parseInt(decrypted.size);fileMime=decrypted.mime;fileKey=decrypted.key;}_context6.next=20;break;case 17:_context6.prev=17;_context6.t0=_context6[\"catch\"](9);return _context6.abrupt(\"return\",{name:fileName,size:fileSize,mime:fileMime,key:fileKey});case 20:obj={name:fileName,size:fileSize,mime:fileMime,key:fileKey};if(obj.name.length>=1){window.customVariables.cachedMetadata[cacheKey]=obj;}return _context6.abrupt(\"return\",obj);case 23:case\"end\":return _context6.stop();}}},_callee6,null,[[9,17]]);}));return _decryptFileMetadataPrivateKey.apply(this,arguments);}export function base64ArrayBuffer(arrayBuffer){var base64='';var encodings='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';var bytes=new Uint8Array(arrayBuffer);var byteLength=bytes.byteLength;var byteRemainder=byteLength%3;var mainLength=byteLength-byteRemainder;var a,b,c,d;var chunk;// Main loop deals with bytes in chunks of 3\nfor(var i=0;i<mainLength;i=i+3){// Combine the three bytes into a single integer\nchunk=bytes[i]<<16|bytes[i+1]<<8|bytes[i+2];// Use bitmasks to extract 6-bit segments from the triplet\na=(chunk&16515072)>>18;// 16515072 = (2^6 - 1) << 18\nb=(chunk&258048)>>12;// 258048   = (2^6 - 1) << 12\nc=(chunk&4032)>>6;// 4032     = (2^6 - 1) << 6\nd=chunk&63;// 63       = 2^6 - 1\n// Convert the raw binary segments to the appropriate ASCII encoding\nbase64+=encodings[a]+encodings[b]+encodings[c]+encodings[d];}// Deal with the remaining bytes and padding\nif(byteRemainder==1){chunk=bytes[mainLength];a=(chunk&252)>>2;// 252 = (2^6 - 1) << 2\n// Set the 4 least significant bits to zero\nb=(chunk&3)<<4;// 3   = 2^2 - 1\nbase64+=encodings[a]+encodings[b]+'==';}else if(byteRemainder==2){chunk=bytes[mainLength]<<8|bytes[mainLength+1];a=(chunk&64512)>>10;// 64512 = (2^6 - 1) << 10\nb=(chunk&1008)>>4;// 1008  = (2^6 - 1) << 4\n// Set the 2 least significant bits to zero\nc=(chunk&15)<<2;// 15    = 2^4 - 1\nbase64+=encodings[a]+encodings[b]+encodings[c]+'=';}return base64;}export function selectedItemsDoesNotContainFolder(items){for(var i=0;i<items.length;i++){if(items[i].type==\"folder\"&&items[i].selected){return false;}}return true;}export function selectedItemsContainsFolder(items){for(var i=0;i<items.length;i++){if(items[i].type==\"folder\"&&items[i].selected){return true;}}return false;}export function _base64ToArrayBuffer(base64){var binary_string=window.atob(base64);var len=binary_string.length;var bytes=new Uint8Array(len);for(var i=0;i<len;i++){bytes[i]=binary_string.charCodeAt(i);}return bytes.buffer;}export function fileNameValidationRegex(name){if(/^(con|prn|aux|nul|com[0-9]|lpt[0-9])$|([<>:\"\\/\\\\|?*])|(\\.|\\s)$/ig.test(name)){return true;}return false;}export function checkIfNameIsBanned(name){var banned=[\"/\",\"\\\\\",\"?\",\"@\",\"$\",\"%\",\"[\",\"]\",\"{\",\"}\",\"&\",'\"',\"'\",\"`\",\"*\",\"=\",\"´\",\"<\",\">\",\":\",\";\",\"|\",\"§\",\"CON\",\"PRN\",\"AUX\",\"NUL\",\"COM1\",\"COM2\",\"COM3\",\"COM4\",\"COM5\",\"COM6\",\"COM7\",\"COM8\",\"COM9\",\"LPT1\",\"LPT2\",\"LPT3\",\"LPT4\",\"LPT5\",\"LPT6\",\"LPT7\",\"LPT8\",\"LPT9\"];var isBanned=false;banned.forEach(function(ban){if(name.indexOf(ban)!==-1){isBanned=true;}});return isBanned;}export function removeIllegalCharsFromString(str){str=str.split(\"'\").join(\"\");str=str.split('\"').join(\"\");str=str.split(\"´\").join(\"\");str=str.split(\"`\").join(\"\");str=str.split(\"<\").join(\"\");str=str.split(\">\").join(\"\");str=str.split(\"!\").join(\"\");str=str.split(\"^\").join(\"\");str=str.split(\":\").join(\"\");str=str.replace(/(<([^>]+)>)/ig,\"\");return str;}export function folderNameRegex(name){if(name.substring(0,1)==\".\"||name.substring(0,2)==\"..\"){return true;}return false;}export function nameRegex(name){return false;}export function isAlphaNumeric(str){var code,i,len;for(i=0,len=str.length;i<len;i++){code=str.charCodeAt(i);if(!(code>47&&code<58)&&// numeric (0-9)\n!(code>64&&code<91)&&// upper alpha (A-Z)\n!(code>96&&code<123)){// lower alpha (a-z)\nreturn false;}}return true;}export function convertWordArrayToUint8Array(wordArray){var arrayOfWords=wordArray.hasOwnProperty(\"words\")?wordArray.words:[];var length=wordArray.hasOwnProperty(\"sigBytes\")?wordArray.sigBytes:arrayOfWords.length*4;var uInt8Array=new Uint8Array(length),index=0,word,i;for(i=0;i<length;i++){word=arrayOfWords[i];uInt8Array[index++]=word>>24;uInt8Array[index++]=word>>16&0xff;uInt8Array[index++]=word>>8&0xff;uInt8Array[index++]=word&0xff;}return uInt8Array;}export function convertUint8ArrayToBinaryString(u8Array){var i,len=u8Array.length,b_str=\"\";for(i=0;i<len;i++){b_str+=String.fromCharCode(u8Array[i]);}return b_str;}export function Semaphore(max){var counter=0;var waiting=[];var take=function take(){if(waiting.length>0&&counter<max){counter++;var promise=waiting.shift();promise.resolve();}};this.acquire=function(){if(counter<max){counter++;return new Promise(function(resolve){resolve();});}else{return new Promise(function(resolve,err){waiting.push({resolve:resolve,err:err});});}};this.release=function(){counter--;take();};this.purge=function(){var unresolved=waiting.length;for(var i=0;i<unresolved;i++){waiting[i].err('Task has been purged.');}counter=0;waiting=[];return unresolved;};}export function checkIfItemParentIsBeingShared(parentUUID,type,metadata){var checkIfIsSharing=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(parent,callback){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(parent==\"default\"||parent==\"base\")){_context.next=2;break;}return _context.abrupt(\"return\",callback(false));case 2:_context.prev=2;_context.next=5;return apiRequest(\"POST\",\"/v1/share/dir/status\",{apiKey:window.customVariables.apiKey,uuid:parent});case 5:res=_context.sent;_context.next=12;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](2);console.log(_context.t0);return _context.abrupt(\"return\",callback(false));case 12:if(res.status){_context.next=15;break;}console.log(res.message);return _context.abrupt(\"return\",callback(false));case 15:return _context.abrupt(\"return\",callback(res.data.sharing,res.data.users));case 16:case\"end\":return _context.stop();}}},_callee,null,[[2,8]]);}));return function checkIfIsSharing(_x5,_x6){return _ref.apply(this,arguments);};}();checkIfIsSharing(parentUUID,/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(status,users){var i,user,usrPubKey,mData,encrypted,res;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(status){_context2.next=2;break;}return _context2.abrupt(\"return\",false);case 2:i=0;case 3:if(!(i<users.length)){_context2.next=43;break;}user=users[i];_context2.prev=5;_context2.next=8;return window.crypto.subtle.importKey(\"spki\",_base64ToArrayBuffer(user.publicKey),{name:\"RSA-OAEP\",hash:\"SHA-512\"},true,[\"encrypt\"]);case 8:usrPubKey=_context2.sent;_context2.next=15;break;case 11:_context2.prev=11;_context2.t0=_context2[\"catch\"](5);console.log(_context2.t0);return _context2.abrupt(\"return\",false);case 15:mData=\"\";if(type==\"file\"){mData=JSON.stringify({name:metadata.name,size:parseInt(metadata.size),mime:metadata.mime,key:metadata.key});}else{mData=JSON.stringify({name:metadata.name});}_context2.prev=17;_context2.next=20;return window.crypto.subtle.encrypt({name:\"RSA-OAEP\"},usrPubKey,new TextEncoder().encode(mData));case 20:encrypted=_context2.sent;_context2.next=27;break;case 23:_context2.prev=23;_context2.t1=_context2[\"catch\"](17);console.log(_context2.t1);return _context2.abrupt(\"return\",false);case 27:_context2.prev=27;_context2.next=30;return apiRequest(\"POST\",\"/v1/share\",{apiKey:window.customVariables.apiKey,uuid:metadata.uuid,parent:parentUUID,email:user.email,type:type,metadata:base64ArrayBuffer(encrypted)});case 30:res=_context2.sent;_context2.next=37;break;case 33:_context2.prev=33;_context2.t2=_context2[\"catch\"](27);console.log(_context2.t2);return _context2.abrupt(\"return\",false);case 37:if(res.status){_context2.next=40;break;}console.log(res.message);return _context2.abrupt(\"return\",false);case 40:i++;_context2.next=3;break;case 43:case\"end\":return _context2.stop();}}},_callee2,null,[[5,11],[17,23],[27,33]]);}));return function(_x7,_x8){return _ref2.apply(this,arguments);};}());}export function checkIfItemIsBeingSharedForRename(type,uuid,metadata){var checkIfIsSharing=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(itemUUID,callback){var res;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return apiRequest(\"POST\",\"/v1/user/shared/item/status\",{apiKey:window.customVariables.apiKey,uuid:itemUUID});case 3:res=_context3.sent;_context3.next=10;break;case 6:_context3.prev=6;_context3.t0=_context3[\"catch\"](0);console.log(_context3.t0);return _context3.abrupt(\"return\",callback(false));case 10:if(res.status){_context3.next=13;break;}console.log(res.message);return _context3.abrupt(\"return\",callback(false));case 13:return _context3.abrupt(\"return\",callback(res.data.sharing,res.data.users));case 14:case\"end\":return _context3.stop();}}},_callee3,null,[[0,6]]);}));return function checkIfIsSharing(_x9,_x10){return _ref3.apply(this,arguments);};}();checkIfIsSharing(uuid,/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(sharing,users){var i,user,usrPubKey,mData,encrypted,res;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:if(sharing){_context4.next=2;break;}return _context4.abrupt(\"return\",false);case 2:i=0;case 3:if(!(i<users.length)){_context4.next=43;break;}user=users[i];_context4.prev=5;_context4.next=8;return window.crypto.subtle.importKey(\"spki\",_base64ToArrayBuffer(user.publicKey),{name:\"RSA-OAEP\",hash:\"SHA-512\"},true,[\"encrypt\"]);case 8:usrPubKey=_context4.sent;_context4.next=15;break;case 11:_context4.prev=11;_context4.t0=_context4[\"catch\"](5);console.log(_context4.t0);return _context4.abrupt(\"return\",false);case 15:mData=\"\";if(type==\"file\"){mData=JSON.stringify({name:metadata.name,size:parseInt(metadata.size),mime:metadata.mime,key:metadata.key});}else{mData=JSON.stringify({name:metadata.name});}_context4.prev=17;_context4.next=20;return window.crypto.subtle.encrypt({name:\"RSA-OAEP\"},usrPubKey,new TextEncoder().encode(mData));case 20:encrypted=_context4.sent;_context4.next=27;break;case 23:_context4.prev=23;_context4.t1=_context4[\"catch\"](17);console.log(_context4.t1);return _context4.abrupt(\"return\",false);case 27:_context4.prev=27;_context4.next=30;return apiRequest(\"POST\",\"/v1/user/shared/item/rename\",{apiKey:window.customVariables.apiKey,uuid:uuid,receiverId:user.id,metadata:base64ArrayBuffer(encrypted)});case 30:res=_context4.sent;_context4.next=37;break;case 33:_context4.prev=33;_context4.t2=_context4[\"catch\"](27);console.log(_context4.t2);return _context4.abrupt(\"return\",false);case 37:if(res.status){_context4.next=40;break;}console.log(res.message);return _context4.abrupt(\"return\",false);case 40:i++;_context4.next=3;break;case 43:case\"end\":return _context4.stop();}}},_callee4,null,[[5,11],[17,23],[27,33]]);}));return function(_x11,_x12){return _ref4.apply(this,arguments);};}());}export function currentParentFolder(){var ex=window.location.href.split(\"/\");return ex[ex.length-1];}export function canCompressThumbnail(ext){switch(ext.toLowerCase()){case\"jpeg\":case\"jpg\":case\"png\":case\"gif\":return true;break;default:return false;break;}}export function canShowThumbnail(ext){switch(ext.toLowerCase()){case\"jpeg\":case\"jpg\":case\"png\":case\"gif\":case\"svg\":case\"mp4\":case\"webm\":case\"avi\":case\"mov\":case\"wmv\":return true;break;default:return false;break;}}export function getFilePreviewType(ext){switch(ext.toLowerCase()){case\"jpeg\":case\"jpg\":case\"png\":case\"gif\":case\"svg\":return\"image\";break;case\"mp3\":case\"mp2\":case\"wav\":case\"ogg\":case\"m4a\":case\"aac\":case\"flac\":case\"midi\":case\"xmf\":case\"rtx\":case\"ota\":case\"mpa\":case\"aif\":case\"rtttl\":case\"wma\":return\"audio\";break;case\"mp4\":case\"webm\":case\"mkv\":case\"flv\":case\"mov\":case\"ogv\":case\"3gp\":case\"avi\":return\"video\";break;case\"json\":case\"js\":case\"md\":case\"php\":case\"css\":case\"c\":case\"perl\":case\"html\":case\"html5\":case\"jsx\":case\"php5\":case\"yml\":case\"md\":case\"xml\":case\"sql\":case\"java\":case\"csharp\":case\"dist\":case\"py\":case\"cc\":case\"cpp\":case\"log\":case\"conf\":case\"cxx\":case\"ini\":case\"lock\":case\"bat\":case\"sh\":case\"properties\":case\"cfg\":case\"ahk\":case\"ts\":case\"tsx\":return\"code\";break;case\"txt\":case\"rtf\":return\"text\";break;case\"pdf\":return\"pdf\";break;default:return\"none\";break;}}export function escapeHTML(str){if(typeof str!==\"string\"){return str;}if(str.length==0){return str;}return str.replace(/(<([^>]+)>)/ig,\"\");}export function getFileIconFromName(name){var ex=name.split(\".\");return getFileIcon(ex[ex.length-1].toLowerCase());}export function getFileIcon(ext){switch(ext.toLowerCase()){case\"pdf\":return\"assets/img/types/pdf.svg\";break;case\"doc\":case\"docx\":return\"assets/img/types/doc.svg\";break;case\"exe\":return\"assets/img/types/exe.svg\";break;case\"mp3\":return\"assets/img/types/mp3.svg\";break;case\"json\":return\"assets/img/types/json-file.svg\";break;case\"png\":return\"assets/img/types/png.svg\";break;case\"ico\":return\"assets/img/types/ico.svg\";break;case\"txt\":return\"assets/img/types/txt.svg\";break;case\"jpg\":case\"jpeg\":return\"assets/img/types/jpg.svg\";break;case\"iso\":return\"assets/img/types/iso.svg\";break;case\"js\":return\"assets/img/types/javascript.svg\";break;case\"html\":return\"assets/img/types/html.svg\";break;case\"css\":return\"assets/img/types/css.svg\";break;case\"csv\":return\"assets/img/types/csv.svg\";break;case\"avi\":return\"assets/img/types/avi.svg\";break;case\"mp4\":return\"assets/img/types/mp4.svg\";break;case\"ppt\":return\"assets/img/types/ppt.svg\";break;case\"zip\":return\"assets/img/types/zip.svg\";break;case\"rar\":case\"tar\":case\"tgz\":case\"gz\":case\"gzip\":return\"assets/img/types/zip-1.svg\";break;case\"txt\":return\"assets/img/types/txt.svg\";break;case\"svg\":return\"assets/img/types/svg.svg\";break;case\"xml\":return\"assets/img/types/xml.svg\";break;case\"dwg\":return\"assets/img/types/dwg.svg\";break;case\"fla\":return\"assets/img/types/fla.svg\";break;case\"ai\":return\"assets/img/types/ai.svg\";break;default:return\"assets/img/types/file.svg\";break;}}export function uInt8ArrayConcat(arrays){// sum of individual array lengths\nvar totalLength=arrays.reduce(function(acc,value){return acc+value.length;},0);if(!arrays.length)return null;var result=new Uint8Array(totalLength);// for each array - copy it over result\n// next array is copied right after the previous one\nvar length=0;var _iterator=_createForOfIteratorHelper(arrays),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var array=_step.value;result.set(array,length);length+=array.length;}}catch(err){_iterator.e(err);}finally{_iterator.f();}return result;}export function orderItemsByType(items,type){var files=[];var folders=[];for(var i=0;i<items.length;i++){if(items[i].type==\"file\"){files.push(items[i]);}else{folders.push(items[i]);}}if(type==\"nameAsc\"){var sortedFiles=files.sort(function(a,b){return a.name.localeCompare(b.name);});var sortedFolders=folders.sort(function(a,b){return a.name.localeCompare(b.name);});return sortedFolders.concat(sortedFiles);}else if(type==\"sizeAsc\"){var _sortedFiles=files.sort(function(a,b){return a.size-b.size;});var _sortedFolders=folders.sort(function(a,b){return b.timestamp-a.timestamp;});return _sortedFolders.concat(_sortedFiles);}else if(type==\"dateAsc\"){var _sortedFiles2=files.sort(function(a,b){return a.timestamp-b.timestamp;});var _sortedFolders2=folders.sort(function(a,b){return a.timestamp-b.timestamp;});return _sortedFolders2.concat(_sortedFiles2);}else if(type==\"typeAsc\"){var _sortedFiles3=files.sort(function(a,b){if(typeof a.mime==\"undefined\"){a.mime=\"_\";}if(typeof b.mime==\"undefined\"){b.mime=\"_\";}if(a.mime.length<=1){a.mime=\"_\";}if(b.mime.length<=1){b.mime=\"_\";}return a.mime.localeCompare(b.mime);});var _sortedFolders3=folders.sort(function(a,b){return b.timestamp-a.timestamp;});return _sortedFolders3.concat(_sortedFiles3);}else if(type==\"nameDesc\"){var _sortedFiles4=files.sort(function(a,b){return b.name.localeCompare(a.name);});var _sortedFolders4=folders.sort(function(a,b){return b.name.localeCompare(a.name);});return _sortedFolders4.concat(_sortedFiles4);}else if(type==\"sizeDesc\"){var _sortedFiles5=files.sort(function(a,b){return b.size-a.size;});var _sortedFolders5=folders.sort(function(a,b){return b.timestamp-a.timestamp;});return _sortedFolders5.concat(_sortedFiles5);}else if(type==\"typeDesc\"){var _sortedFiles6=files.sort(function(a,b){if(typeof a.mime==\"undefined\"){a.mime=\"_\";}if(typeof b.mime==\"undefined\"){b.mime=\"_\";}if(a.mime.length<=1){a.mime=\"_\";}if(b.mime.length<=1){b.mime=\"_\";}return b.mime.localeCompare(a.mime);});var _sortedFolders6=folders.sort(function(a,b){return b.timestamp-a.timestamp;});return _sortedFolders6.concat(_sortedFiles6);}else{//default, dateDesc\nvar _sortedFiles7=files.sort(function(a,b){return b.timestamp-a.timestamp;});var _sortedFolders7=folders.sort(function(a,b){return b.timestamp-a.timestamp;});return _sortedFolders7.concat(_sortedFiles7);}}export function getVideoCover(file){var seekTo=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0.0;return new Promise(function(resolve,reject){// load the file to a video player\nvar videoPlayer=document.createElement('video');videoPlayer.setAttribute('src',URL.createObjectURL(file));videoPlayer.load();videoPlayer.addEventListener('error',function(ex){reject(\"error when loading video file\",ex);});// load metadata of the video to get video duration and dimensions\nvideoPlayer.addEventListener('loadedmetadata',function(){// seek to user defined timestamp (in seconds) if possible\nif(videoPlayer.duration<seekTo){reject(\"video is too short.\");return;}if(videoPlayer.duration>=1){seekTo=1.0;}// delay seeking or else 'seeked' event won't fire on Safari\nsetTimeout(function(){videoPlayer.currentTime=seekTo;},200);// extract video thumbnail once seeking is complete\nvideoPlayer.addEventListener('seeked',function(){// define a canvas to have the same dimension as the video\nvar canvas=document.createElement(\"canvas\");canvas.width=videoPlayer.videoWidth;canvas.height=videoPlayer.videoHeight;// draw the video frame to canvas\nvar ctx=canvas.getContext(\"2d\");ctx.drawImage(videoPlayer,0,0,canvas.width,canvas.height);// return the canvas image as a blob\nctx.canvas.toBlob(function(blob){resolve(blob);},\"image/jpeg\",0.1/* quality */);});});});}export function getLanguageSelection(){return\"\\n        <ion-select-option value=\\\"en\\\">English</ion-select-option>\\n        <ion-select-option value=\\\"de\\\">Deutsch</ion-select-option>\\n        <ion-select-option value=\\\"nl\\\">Nederlands</ion-select-option>\\n        <ion-select-option value=\\\"hi\\\">\\u0939\\u093F\\u0928\\u094D\\u0926\\u0940, \\u0939\\u093F\\u0902\\u0926\\u0940</ion-select-option>\\n    \";}","map":{"version":3,"sources":["/Users/jan/Documents/filen/app/src/utils/utils.js"],"names":["Capacitor","Plugins","CryptoJS","require","striptags","sanitizeHTML","html","getRandomArbitrary","min","max","Math","floor","random","formatBytes","bytes","decimals","k","dm","sizes","i","log","parseFloat","pow","toFixed","uuidv4","d","Date","getTime","d2","performance","now","replace","c","r","toString","generateRandomString","length","result","characters","charAt","generateRandomClassName","getAPIServer","servers","fetchWithTimeout","ms","promise","Promise","resolve","reject","timer","setTimeout","Error","then","value","clearTimeout","catch","err","apiRequest","method","endpoint","data","cacheKey","isNative","Network","getStatus","window","customVariables","apiCache","fetch","toUpperCase","cache","headers","body","JSON","stringify","response","json","obj","customFunctions","saveAPICache","console","getDownloadServer","getUploadServer","hashFn","val","SHA1","SHA512","cryptoJSEncrypt","key","AES","encrypt","cryptoJSDecrypt","decrypt","enc","Utf8","unixTimestamp","decryptCryptoJSFolderName","str","userMasterKeys","uuid","undefined","cachedMetadata","name","folderName","reverse","forEach","parse","e","decryptFolderNamePrivateKey","usrPrivKey","crypto","subtle","_base64ToArrayBuffer","decrypted","TextDecoder","decode","decryptFileMetadata","metadata","file","size","mime","fileName","fileSize","fileMime","fileKey","parseInt","decryptFileMetadataPrivateKey","base64ArrayBuffer","arrayBuffer","base64","encodings","Uint8Array","byteLength","byteRemainder","mainLength","a","b","chunk","selectedItemsDoesNotContainFolder","items","type","selected","selectedItemsContainsFolder","binary_string","atob","len","charCodeAt","buffer","fileNameValidationRegex","test","checkIfNameIsBanned","banned","isBanned","ban","indexOf","removeIllegalCharsFromString","split","join","folderNameRegex","substring","nameRegex","isAlphaNumeric","code","convertWordArrayToUint8Array","wordArray","arrayOfWords","hasOwnProperty","words","sigBytes","uInt8Array","index","word","convertUint8ArrayToBinaryString","u8Array","b_str","String","fromCharCode","Semaphore","counter","waiting","take","shift","acquire","push","release","purge","unresolved","checkIfItemParentIsBeingShared","parentUUID","checkIfIsSharing","parent","callback","apiKey","res","status","message","sharing","users","user","importKey","publicKey","hash","usrPubKey","mData","TextEncoder","encode","encrypted","email","checkIfItemIsBeingSharedForRename","itemUUID","receiverId","id","currentParentFolder","ex","location","href","canCompressThumbnail","ext","toLowerCase","canShowThumbnail","getFilePreviewType","escapeHTML","getFileIconFromName","getFileIcon","uInt8ArrayConcat","arrays","totalLength","reduce","acc","array","set","orderItemsByType","files","folders","sortedFiles","sort","localeCompare","sortedFolders","concat","timestamp","getVideoCover","seekTo","videoPlayer","document","createElement","setAttribute","URL","createObjectURL","load","addEventListener","duration","currentTime","canvas","width","videoWidth","height","videoHeight","ctx","getContext","drawImage","toBlob","blob","getLanguageSelection"],"mappings":"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","sourcesContent":["import { Capacitor, Plugins } from \"@capacitor/core\";\r\n\r\nconst CryptoJS = require(\"crypto-js\")\r\nconst striptags = require(\"striptags\")\r\n\r\nexport function sanitizeHTML(html){\r\n    return striptags(html)\r\n}\r\n\r\nexport function getRandomArbitrary(min, max){\r\n    return Math.floor(Math.random() * (max - min) + min)\r\n}\r\n\r\nexport function formatBytes(bytes, decimals = 2){\r\n    if(bytes === 0) return \"0 Bytes\"\r\n\r\n    let k = 1024\r\n    let dm = decimals < 0 ? 0 : decimals\r\n    let sizes = [\"Bytes\", \"KB\", \"MB\", \"GB\", \"TB\", \"PB\", \"EB\", \"ZB\", \"YB\"]\r\n\r\n    let i = Math.floor(Math.log(bytes) / Math.log(k))\r\n\r\n    return parseFloat((bytes / Math.pow(k, i)).toFixed(dm)) + \" \" + sizes[i]\r\n}\r\n\r\nexport function uuidv4(){ // Public Domain/MIT\r\n    let d = new Date().getTime();//Timestamp\r\n    let d2 = (performance && performance.now && (performance.now()*1000)) || 0;//Time in microseconds since page-load or 0 if unsupported\r\n    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\r\n        let r = Math.random() * 16;//random number between 0 and 16\r\n        if(d > 0){//Use timestamp until depleted\r\n            r = (d + r)%16 | 0;\r\n            d = Math.floor(d/16);\r\n        } else {//Use microseconds since page-load if supported\r\n            r = (d2 + r)%16 | 0;\r\n            d2 = Math.floor(d2/16);\r\n        }\r\n        return (c === 'x' ? r : (r & 0x3 | 0x8)).toString(16);\r\n    });\r\n}\r\n\r\nexport function generateRandomString(length = 32){\r\n    let result = \"\"\r\n    let characters = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\"\r\n\r\n    for(let i = 0; i < length; i++){\r\n        result += characters.charAt(Math.floor(Math.random() * characters.length))\r\n    }\r\n\r\n    return result\r\n}\r\n\r\nexport function generateRandomClassName(length = 16){\r\n    let result = \"\"\r\n    let characters = \"abcdefghijklmnopqrstuvwxyz\"\r\n\r\n    for(let i = 0; i < length; i++){\r\n        result += characters.charAt(Math.floor(Math.random() * characters.length))\r\n    }\r\n\r\n    return result + \"-\" + result\r\n}\r\n\r\nexport function getAPIServer(){\r\n    let servers = [\r\n        \"https://api.filen.io\",\r\n        \"https://api.filen-1.xyz\",\r\n        \"https://api.filen-2.xyz\",\r\n        \"https://api.filen-3.xyz\",\r\n        \"https://api.filen-4.xyz\",\r\n        \"https://api.filen-5.xyz\"\r\n    ]\r\n\r\n    return servers[getRandomArbitrary(0, (servers.length - 1))]\r\n}\r\n\r\nexport function fetchWithTimeout(ms, promise) {\r\n    return new Promise((resolve, reject) => {\r\n        let timer = setTimeout(() => {\r\n            return reject(new Error(\"Request timeout after \" + ms + \"ms\"))\r\n        }, ms)\r\n\r\n        promise.then((value) => {\r\n            clearTimeout(timer)\r\n            \r\n            return resolve(value)\r\n        }).catch((err) => {\r\n            clearTimeout(timer)\r\n\r\n            return reject(err)\r\n        })\r\n    })\r\n}\r\n\r\nexport function apiRequest(method, endpoint, data = {}){\r\n    return new Promise((resolve, reject) => {\r\n        let cacheKey = method + endpoint\r\n\r\n        if(Capacitor.isNative){\r\n            if(Plugins.Network.getStatus() == \"none\"){\r\n                if(typeof window.customVariables.apiCache[cacheKey] !== \"undefined\"){\r\n                    return resolve(window.customVariables.apiCache[cacheKey])\r\n                }\r\n            }\r\n        }\r\n\r\n        fetchWithTimeout(30000, fetch(getAPIServer() + endpoint, {\r\n            method: method.toUpperCase(),\r\n            cache: \"no-cache\",\r\n            headers: {\r\n                \"Content-Type\": \"application/json\"\r\n            },\r\n            body: JSON.stringify(data)\r\n        })).then((response) => {\r\n            response.json().then((obj) => {\r\n                if(endpoint == \"/v1/dir/content\"\r\n                || endpoint == \"/v1/user/baseFolders\"\r\n                || endpoint == \"/v1/user/shared/in\"\r\n                || endpoint == \"/v1/user/shared/out\"\r\n                || endpoint == \"/v1/user/usage\"\r\n                || endpoint == \"/v1/user/keyPair/info\"){\r\n                    window.customVariables.apiCache[cacheKey] = obj\r\n\r\n                    window.customFunctions.saveAPICache()\r\n                }\r\n\r\n                return resolve(obj)\r\n            }).catch((err) => {\r\n                console.log(err)\r\n\r\n                if(typeof window.customVariables.apiCache[cacheKey] !== \"undefined\"){\r\n                    return resolve(window.customVariables.apiCache[cacheKey])\r\n                }\r\n\r\n                return reject(err)\r\n            })\r\n        }).catch((err) => {\r\n            console.log(err)\r\n\r\n            if(typeof window.customVariables.apiCache[cacheKey] !== \"undefined\"){\r\n                return resolve(window.customVariables.apiCache[cacheKey])\r\n            }\r\n\r\n            return reject(err)\r\n        })\r\n    })\r\n}\r\n\r\nexport function getDownloadServer(){\r\n    let servers = [\r\n        \"https://down.filen-1.xyz\",\r\n        \"https://down.filen-2.xyz\",\r\n        \"https://down.filen-3.xyz\",\r\n        \"https://down.filen-4.xyz\",\r\n        \"https://down.filen-5.xyz\"\r\n    ]\r\n\r\n    return servers[getRandomArbitrary(0, (servers.length - 1))]\r\n}\r\n\r\nexport function getUploadServer(){\r\n    let servers = [\r\n        \"https://up.filen-1.xyz\",\r\n        \"https://up.filen-2.xyz\",\r\n        \"https://up.filen-3.xyz\",\r\n        \"https://up.filen-4.xyz\",\r\n        \"https://up.filen-5.xyz\"\r\n    ]\r\n\r\n    return servers[getRandomArbitrary(0, (servers.length - 1))]\r\n}\r\n\r\nexport function hashFn(val){\r\n    return CryptoJS.SHA1(CryptoJS.SHA512(val).toString()).toString()\r\n}\r\n\r\nexport function cryptoJSEncrypt(val, key){\r\n    return CryptoJS.AES.encrypt(val, key).toString()\r\n}\r\n\r\nexport function cryptoJSDecrypt(val, key){\r\n    return CryptoJS.AES.decrypt(val, key).toString(CryptoJS.enc.Utf8)\r\n}\r\n\r\nexport function unixTimestamp(){\r\n    return Math.floor((+new Date()) / 1000)\r\n}\r\n\r\nexport function decryptCryptoJSFolderName(str, userMasterKeys, uuid = undefined){\r\n    let cacheKey = \"folder_\" + uuid + \"_\" + str\r\n\r\n    if(window.customVariables.cachedMetadata[cacheKey]){\r\n        return window.customVariables.cachedMetadata[cacheKey].name\r\n    }\r\n\r\n    let folderName = \"CON_NO_DECRYPT_POSSIBLE_NO_NAME_FOUND_FOR_FOLDER\"\r\n\r\n    userMasterKeys = userMasterKeys.reverse()\r\n\r\n    let obj = undefined\r\n\r\n    userMasterKeys.forEach((key) => {\r\n        try{\r\n            obj = JSON.parse(CryptoJS.AES.decrypt(str, key).toString(CryptoJS.enc.Utf8))\r\n\r\n            if(obj && typeof obj == \"object\"){\r\n                folderName = obj.name\r\n            }\r\n        }\r\n        catch(e){\r\n            return\r\n        }\r\n    })\r\n\r\n    if(folderName !== \"CON_NO_DECRYPT_POSSIBLE_NO_NAME_FOUND_FOR_FOLDER\"){\r\n        window.customVariables.cachedMetadata[cacheKey] = {\r\n            name: folderName\r\n        }\r\n    }\r\n\r\n    return folderName\r\n}\r\n\r\nexport async function decryptFolderNamePrivateKey(str, usrPrivKey, uuid = undefined){\r\n    let cacheKey = \"folder_\" + uuid + \"_\" + str\r\n\r\n    if(window.customVariables.cachedMetadata[cacheKey]){\r\n        return window.customVariables.cachedMetadata[cacheKey].name\r\n    }\r\n\r\n    let folderName = \"CON_NO_DECRYPT_POSSIBLE_NO_NAME_FOUND_FOR_FOLDER\"\r\n\r\n    try{\r\n        let decrypted = await window.crypto.subtle.decrypt({\r\n            name: \"RSA-OAEP\"\r\n        }, usrPrivKey, _base64ToArrayBuffer(str))\r\n\r\n        decrypted = JSON.parse(new TextDecoder().decode(decrypted))\r\n\r\n        if(decrypted && typeof decrypted == \"object\"){\r\n            folderName = decrypted.name\r\n        }\r\n    }\r\n    catch(e){\r\n        console.log(e)\r\n    }\r\n\r\n    if(folderName !== \"CON_NO_DECRYPT_POSSIBLE_NO_NAME_FOUND_FOR_FOLDER\"){\r\n        window.customVariables.cachedMetadata[cacheKey] = {\r\n            name: folderName\r\n        }\r\n    }\r\n\r\n    return folderName\r\n}\r\n\r\nexport function decryptFileMetadata(metadata, userMasterKeys, uuid = undefined){\r\n    let cacheKey = \"folder_\" + uuid + \"_\" + metadata\r\n\r\n    if(window.customVariables.cachedMetadata[cacheKey]){\r\n        let file = window.customVariables.cachedMetadata[cacheKey]\r\n\r\n        return {\r\n            name: file.name,\r\n            size: file.size,\r\n            mime: file.mime,\r\n            key: file.key\r\n        }\r\n    }\r\n\r\n    let fileName = \"\"\r\n    let fileSize = 0\r\n    let fileMime = \"\"\r\n    let fileKey = \"\"\r\n\r\n    userMasterKeys = userMasterKeys.reverse()\r\n\r\n    userMasterKeys.forEach((key) => {\r\n        try{\r\n            let obj = JSON.parse(CryptoJS.AES.decrypt(metadata, key).toString(CryptoJS.enc.Utf8))\r\n\r\n            if(obj && typeof obj == \"object\"){\r\n                fileName = obj.name\r\n                fileSize = parseInt(obj.size)\r\n                fileMime = obj.mime\r\n                fileKey = obj.key\r\n            }\r\n        }\r\n        catch(e){\r\n            return\r\n        }\r\n    })\r\n\r\n    let obj = {\r\n        name: fileName,\r\n        size: fileSize,\r\n        mime: fileMime,\r\n        key: fileKey\r\n    }\r\n\r\n    if(obj.name.length >= 1){\r\n        window.customVariables.cachedMetadata[cacheKey] = obj\r\n    }\r\n\r\n    return obj\r\n}\r\n\r\nexport async function decryptFileMetadataPrivateKey(str, usrPrivKey, uuid = undefined){\r\n    let cacheKey = \"folder_\" + uuid + \"_\" + str\r\n\r\n    if(window.customVariables.cachedMetadata[cacheKey]){\r\n        let file = window.customVariables.cachedMetadata[cacheKey]\r\n\r\n        return {\r\n            name: file.name,\r\n            size: file.size,\r\n            mime: file.mime,\r\n            key: file.key\r\n        }\r\n    }\r\n\r\n    let fileName = \"\"\r\n    let fileSize = 0\r\n    let fileMime = \"\"\r\n    let fileKey = \"\"\r\n\r\n    try{\r\n        let decrypted = await window.crypto.subtle.decrypt({\r\n            name: \"RSA-OAEP\"\r\n        }, usrPrivKey, _base64ToArrayBuffer(str))\r\n\r\n        decrypted = JSON.parse(new TextDecoder().decode(decrypted))\r\n\r\n        if(decrypted && typeof decrypted == \"object\"){\r\n            fileName = decrypted.name\r\n            fileSize = parseInt(decrypted.size)\r\n            fileMime = decrypted.mime\r\n            fileKey = decrypted.key\r\n        }\r\n    }\r\n    catch(e){\r\n        return {\r\n            name: fileName,\r\n            size: fileSize,\r\n            mime: fileMime,\r\n            key: fileKey\r\n        }\r\n    }\r\n\r\n    let obj = {\r\n        name: fileName,\r\n        size: fileSize,\r\n        mime: fileMime,\r\n        key: fileKey\r\n    }\r\n\r\n    if(obj.name.length >= 1){\r\n        window.customVariables.cachedMetadata[cacheKey] = obj\r\n    }\r\n\r\n    return obj\r\n}\r\n\r\nexport function base64ArrayBuffer(arrayBuffer){\r\n    var base64    = ''\r\n    var encodings = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'\r\n  \r\n    var bytes         = new Uint8Array(arrayBuffer)\r\n    var byteLength    = bytes.byteLength\r\n    var byteRemainder = byteLength % 3\r\n    var mainLength    = byteLength - byteRemainder\r\n  \r\n    var a, b, c, d\r\n    var chunk\r\n  \r\n    // Main loop deals with bytes in chunks of 3\r\n    for (var i = 0; i < mainLength; i = i + 3) {\r\n      // Combine the three bytes into a single integer\r\n      chunk = (bytes[i] << 16) | (bytes[i + 1] << 8) | bytes[i + 2]\r\n  \r\n      // Use bitmasks to extract 6-bit segments from the triplet\r\n      a = (chunk & 16515072) >> 18 // 16515072 = (2^6 - 1) << 18\r\n      b = (chunk & 258048)   >> 12 // 258048   = (2^6 - 1) << 12\r\n      c = (chunk & 4032)     >>  6 // 4032     = (2^6 - 1) << 6\r\n      d = chunk & 63               // 63       = 2^6 - 1\r\n  \r\n      // Convert the raw binary segments to the appropriate ASCII encoding\r\n      base64 += encodings[a] + encodings[b] + encodings[c] + encodings[d]\r\n    }\r\n  \r\n    // Deal with the remaining bytes and padding\r\n    if (byteRemainder == 1) {\r\n      chunk = bytes[mainLength]\r\n  \r\n      a = (chunk & 252) >> 2 // 252 = (2^6 - 1) << 2\r\n  \r\n      // Set the 4 least significant bits to zero\r\n      b = (chunk & 3)   << 4 // 3   = 2^2 - 1\r\n  \r\n      base64 += encodings[a] + encodings[b] + '=='\r\n    } else if (byteRemainder == 2) {\r\n      chunk = (bytes[mainLength] << 8) | bytes[mainLength + 1]\r\n  \r\n      a = (chunk & 64512) >> 10 // 64512 = (2^6 - 1) << 10\r\n      b = (chunk & 1008)  >>  4 // 1008  = (2^6 - 1) << 4\r\n  \r\n      // Set the 2 least significant bits to zero\r\n      c = (chunk & 15)    <<  2 // 15    = 2^4 - 1\r\n  \r\n      base64 += encodings[a] + encodings[b] + encodings[c] + '='\r\n    }\r\n    \r\n    return base64\r\n}\r\n\r\nexport function selectedItemsDoesNotContainFolder(items){\r\n    for(let i = 0; i < items.length; i++){\r\n        if(items[i].type == \"folder\" && items[i].selected){\r\n            return false\r\n        }\r\n    }\r\n\r\n    return true\r\n}\r\n\r\nexport function selectedItemsContainsFolder(items){\r\n    for(let i = 0; i < items.length; i++){\r\n        if(items[i].type == \"folder\" && items[i].selected){\r\n            return true\r\n        }\r\n    }\r\n\r\n    return false\r\n}\r\n\r\nexport function _base64ToArrayBuffer(base64){\r\n    var binary_string = window.atob(base64);\r\n    var len = binary_string.length;\r\n    var bytes = new Uint8Array(len);\r\n    for (var i = 0; i < len; i++) {\r\n        bytes[i] = binary_string.charCodeAt(i);\r\n    }\r\n    return bytes.buffer;\r\n}\r\n\r\nexport function fileNameValidationRegex(name){\r\n\tif(/^(con|prn|aux|nul|com[0-9]|lpt[0-9])$|([<>:\"\\/\\\\|?*])|(\\.|\\s)$/ig.test(name)){\r\n\t\treturn true\r\n\t}\r\n\r\n\treturn false\r\n}\r\n\r\nexport function checkIfNameIsBanned(name){\r\n    let banned = [\r\n      \"/\",\r\n      \"\\\\\",\r\n      \"?\",\r\n      \"@\",\r\n      \"$\",\r\n      \"%\",\r\n      \"[\",\r\n      \"]\",\r\n      \"{\",\r\n      \"}\",\r\n      \"&\",\r\n      '\"',\r\n      \"'\",\r\n      \"`\",\r\n      \"*\",\r\n      \"=\",\r\n      \"´\",\r\n      \"<\",\r\n      \">\",\r\n      \":\",\r\n      \";\",\r\n      \"|\",\r\n      \"§\",\r\n      \"CON\", \"PRN\", \"AUX\", \"NUL\", \"COM1\", \"COM2\", \"COM3\", \"COM4\", \"COM5\", \"COM6\", \"COM7\", \"COM8\", \"COM9\",\r\n      \"LPT1\", \"LPT2\", \"LPT3\", \"LPT4\", \"LPT5\", \"LPT6\", \"LPT7\", \"LPT8\", \"LPT9\"\r\n    ]\r\n  \r\n    let isBanned = false\r\n  \r\n    banned.forEach((ban) => {\r\n      if(name.indexOf(ban) !== -1){\r\n        isBanned = true\r\n      }\r\n    })\r\n  \r\n    return isBanned\r\n  }\r\n\r\nexport function removeIllegalCharsFromString(str){\r\n    str = str.split(\"'\").join(\"\")\r\n    str = str.split('\"').join(\"\")\r\n    str = str.split(\"´\").join(\"\")\r\n    str = str.split(\"`\").join(\"\")\r\n    str = str.split(\"<\").join(\"\")\r\n    str = str.split(\">\").join(\"\")\r\n    str = str.split(\"!\").join(\"\")\r\n    str = str.split(\"^\").join(\"\")\r\n    str = str.split(\":\").join(\"\")\r\n    str = str.replace(/(<([^>]+)>)/ig, \"\")\r\n\r\n    return str\r\n}\r\n\r\nexport function folderNameRegex(name){\r\n    if(name.substring(0, 1) == \".\" || name.substring(0, 2) == \"..\"){\r\n        return true\r\n    }\r\n    \r\n    return false\r\n}\r\n\r\nexport function nameRegex(name){\r\n    return false\r\n}\r\n\r\nexport function isAlphaNumeric(str){\r\n    var code, i, len;\r\n    \r\n    for (i = 0, len = str.length; i < len; i++) {\r\n        code = str.charCodeAt(i);\r\n        if (!(code > 47 && code < 58) && // numeric (0-9)\r\n            !(code > 64 && code < 91) && // upper alpha (A-Z)\r\n            !(code > 96 && code < 123)) { // lower alpha (a-z)\r\n        return false;\r\n        }\r\n    }\r\n    return true;\r\n}\r\n\r\nexport function convertWordArrayToUint8Array(wordArray){\r\n    let arrayOfWords = wordArray.hasOwnProperty(\"words\") ? wordArray.words : []\r\n    let length = wordArray.hasOwnProperty(\"sigBytes\") ? wordArray.sigBytes : arrayOfWords.length * 4\r\n    let uInt8Array = new Uint8Array(length), index=0, word, i\r\n\r\n    for(i = 0; i < length; i++){\r\n        word = arrayOfWords[i]\r\n\r\n        uInt8Array[index++] = word >> 24\r\n        uInt8Array[index++] = (word >> 16) & 0xff\r\n        uInt8Array[index++] = (word >> 8) & 0xff\r\n        uInt8Array[index++] = word & 0xff\r\n    }\r\n\r\n    return uInt8Array\r\n}\r\n\r\nexport function convertUint8ArrayToBinaryString(u8Array){\r\n    let i, len = u8Array.length, b_str = \"\"\r\n\r\n    for (i = 0; i < len; i++){\r\n        b_str += String.fromCharCode(u8Array[i])\r\n    }\r\n\r\n    return b_str\r\n}\r\n\r\nexport function Semaphore(max){\r\n    var counter = 0;\r\n    var waiting = [];\r\n    \r\n    var take = function() {\r\n      if (waiting.length > 0 && counter < max){\r\n        counter++;\r\n        let promise = waiting.shift();\r\n        promise.resolve();\r\n      }\r\n    }\r\n    \r\n    this.acquire = function() {\r\n      if(counter < max) {\r\n        counter++\r\n        return new Promise(resolve => {\r\n        resolve();\r\n      });\r\n      } else {\r\n        return new Promise((resolve, err) => {\r\n          waiting.push({resolve: resolve, err: err});\r\n        });\r\n      }\r\n    }\r\n      \r\n    this.release = function() {\r\n     counter--;\r\n     take();\r\n    }\r\n    \r\n    this.purge = function() {\r\n      let unresolved = waiting.length;\r\n    \r\n      for (let i = 0; i < unresolved; i++) {\r\n        waiting[i].err('Task has been purged.');\r\n      }\r\n    \r\n      counter = 0;\r\n      waiting = [];\r\n      \r\n      return unresolved;\r\n    }\r\n}\r\n\r\nexport function checkIfItemParentIsBeingShared(parentUUID, type, metadata){\r\n    const checkIfIsSharing = async (parent, callback) => {\r\n        if(parent == \"default\" || parent == \"base\"){\r\n            return callback(false)\r\n        }\r\n\r\n        try{\r\n            var res = await apiRequest(\"POST\", \"/v1/share/dir/status\", {\r\n                apiKey: window.customVariables.apiKey,\r\n                uuid: parent\r\n            })\r\n        }\r\n        catch(e){\r\n            console.log(e)\r\n\r\n            return callback(false)\r\n        }\r\n\r\n        if(!res.status){\r\n            console.log(res.message)\r\n\r\n            return callback(false)\r\n        }\r\n\r\n        return callback(res.data.sharing, res.data.users)\r\n    }\r\n\r\n    checkIfIsSharing(parentUUID, async (status, users) => {\r\n        if(!status){\r\n            return false\r\n        }\r\n\r\n        for(let i = 0; i < users.length; i++){\r\n            let user = users[i]\r\n\r\n            try{\r\n                var usrPubKey = await window.crypto.subtle.importKey(\"spki\", _base64ToArrayBuffer(user.publicKey), {\r\n                    name: \"RSA-OAEP\",\r\n                    hash: \"SHA-512\"\r\n                }, true, [\"encrypt\"])\r\n            }\r\n            catch(e){\r\n                console.log(e)\r\n\r\n                return false\r\n            }\r\n\r\n            let mData = \"\"\r\n\r\n            if(type == \"file\"){\r\n                mData = JSON.stringify({\r\n                    name: metadata.name,\r\n                    size: parseInt(metadata.size),\r\n                    mime: metadata.mime,\r\n                    key: metadata.key\r\n                })\r\n            }\r\n            else{\r\n                mData = JSON.stringify({\r\n                    name: metadata.name\r\n                })\r\n            }\r\n            \r\n            try{\r\n                var encrypted = await window.crypto.subtle.encrypt({\r\n                    name: \"RSA-OAEP\"\r\n                }, usrPubKey, new TextEncoder().encode(mData))\r\n            }\r\n            catch(e){\r\n                console.log(e)\r\n\r\n                return false\r\n            }\r\n\r\n            try{\r\n                var res = await apiRequest(\"POST\", \"/v1/share\", {\r\n                    apiKey: window.customVariables.apiKey,\r\n                    uuid: metadata.uuid,\r\n                    parent: parentUUID,\r\n                    email: user.email,\r\n                    type,\r\n                    metadata: base64ArrayBuffer(encrypted)\r\n                })\r\n            }\r\n            catch(e){\r\n                console.log(e)\r\n\r\n                return false\r\n            }\r\n\r\n            if(!res.status){\r\n                console.log(res.message)\r\n\r\n                return false\r\n            }\r\n        }\r\n    })\r\n}\r\n\r\nexport function checkIfItemIsBeingSharedForRename(type, uuid, metadata){\r\n    const checkIfIsSharing = async (itemUUID, callback) => {\r\n        try{\r\n            var res = await apiRequest(\"POST\", \"/v1/user/shared/item/status\", {\r\n                apiKey: window.customVariables.apiKey,\r\n                uuid: itemUUID\r\n            })\r\n        }\r\n        catch(e){\r\n            console.log(e)\r\n\r\n            return callback(false)\r\n        }\r\n\r\n        if(!res.status){\r\n            console.log(res.message)\r\n\r\n            return callback(false)\r\n        }\r\n\r\n        return callback(res.data.sharing, res.data.users)\r\n    }\r\n\r\n    checkIfIsSharing(uuid, async (sharing, users) => {\r\n        if(!sharing){\r\n            return false\r\n        }\r\n\r\n        for(let i = 0; i < users.length; i++){\r\n            let user = users[i]\r\n\r\n            try{\r\n                var usrPubKey = await window.crypto.subtle.importKey(\"spki\", _base64ToArrayBuffer(user.publicKey), {\r\n                    name: \"RSA-OAEP\",\r\n                    hash: \"SHA-512\"\r\n                }, true, [\"encrypt\"])\r\n            }\r\n            catch(e){\r\n                console.log(e)\r\n\r\n                return false\r\n            }\r\n\r\n            let mData = \"\"\r\n\r\n            if(type == \"file\"){\r\n                mData = JSON.stringify({\r\n                    name: metadata.name,\r\n                    size: parseInt(metadata.size),\r\n                    mime: metadata.mime,\r\n                    key: metadata.key\r\n                })\r\n            }\r\n            else{\r\n                mData = JSON.stringify({\r\n                    name: metadata.name\r\n                })\r\n            }\r\n            \r\n            try{\r\n                var encrypted = await window.crypto.subtle.encrypt({\r\n                    name: \"RSA-OAEP\"\r\n                }, usrPubKey, new TextEncoder().encode(mData))\r\n            }\r\n            catch(e){\r\n                console.log(e)\r\n\r\n                return false\r\n            }\r\n\r\n            try{\r\n                var res = await apiRequest(\"POST\", \"/v1/user/shared/item/rename\", {\r\n                    apiKey: window.customVariables.apiKey,\r\n                    uuid,\r\n                    receiverId: user.id,\r\n                    metadata: base64ArrayBuffer(encrypted)\r\n                })\r\n            }\r\n            catch(e){\r\n                console.log(e)\r\n\r\n                return false\r\n            }\r\n\r\n            if(!res.status){\r\n                console.log(res.message)\r\n\r\n                return false\r\n            }\r\n        }\r\n    })\r\n}\r\n\r\nexport function currentParentFolder(){\r\n    let ex = window.location.href.split(\"/\")\r\n\r\n    return ex[ex.length - 1]\r\n}\r\n\r\nexport function canCompressThumbnail(ext){\r\n    switch(ext.toLowerCase()){\r\n        case \"jpeg\":\r\n        case \"jpg\":\r\n        case \"png\":\r\n        case \"gif\":\r\n            return true\r\n        break\r\n        default:\r\n            return false\r\n        break\r\n    }\r\n}\r\n\r\nexport function canShowThumbnail(ext){\r\n    switch(ext.toLowerCase()){\r\n        case \"jpeg\":\r\n        case \"jpg\":\r\n        case \"png\":\r\n        case \"gif\":\r\n        case \"svg\":\r\n        case \"mp4\":\r\n        case \"webm\":\r\n        case \"avi\":\r\n        case \"mov\":\r\n        case \"wmv\":\r\n            return true\r\n        break\r\n        default:\r\n            return false\r\n        break\r\n    }\r\n}\r\n\r\nexport function getFilePreviewType(ext){\r\n    switch(ext.toLowerCase()){\r\n      case \"jpeg\":\r\n      case \"jpg\":\r\n      case \"png\":\r\n      case \"gif\":\r\n      case \"svg\":\r\n        return \"image\"\r\n      break\r\n      case \"mp3\":\r\n      case \"mp2\":\r\n      case \"wav\":\r\n      case \"ogg\":\r\n      case \"m4a\":\r\n      case \"aac\":\r\n      case \"flac\":\r\n      case \"midi\":\r\n      case \"xmf\":\r\n      case \"rtx\":\r\n      case \"ota\":\r\n      case \"mpa\":\r\n      case \"aif\":\r\n      case \"rtttl\":\r\n      case \"wma\":\r\n        return \"audio\"\r\n      break\r\n      case \"mp4\":\r\n      case \"webm\":\r\n      case \"mkv\":\r\n      case \"flv\":\r\n      case \"mov\":\r\n      case \"ogv\":\r\n      case \"3gp\":\r\n      case \"avi\":\r\n        return \"video\"\r\n      break\r\n      case \"json\":\r\n      case \"js\":\r\n      case \"md\":\r\n      case \"php\":\r\n      case \"css\":\r\n      case \"c\":\r\n      case \"perl\":\r\n      case \"html\":\r\n      case \"html5\":\r\n      case \"jsx\":\r\n      case \"php5\":\r\n      case \"yml\":\r\n      case \"md\":\r\n      case \"xml\":\r\n      case \"sql\":\r\n      case \"java\":\r\n      case \"csharp\":\r\n      case \"dist\":\r\n      case \"py\":\r\n      case \"cc\":\r\n      case \"cpp\":\r\n      case \"log\":\r\n      case \"conf\":\r\n      case \"cxx\":\r\n      case \"ini\":\r\n      case \"lock\":\r\n      case \"bat\":\r\n      case \"sh\":\r\n      case \"properties\":\r\n      case \"cfg\":\r\n      case \"ahk\":\r\n      case \"ts\":\r\n      case \"tsx\":\r\n        return \"code\"\r\n      break\r\n      case \"txt\":\r\n      case \"rtf\":\r\n        return \"text\"\r\n      break\r\n      case \"pdf\":\r\n        return \"pdf\"\r\n      break\r\n      default:\r\n        return \"none\"\r\n      break\r\n    }\r\n}\r\n\r\nexport function escapeHTML(str){\r\n    if(typeof str !== \"string\"){\r\n      return str\r\n    }\r\n  \r\n    if(str.length == 0){\r\n      return str\r\n    }\r\n  \r\n    return str.replace(/(<([^>]+)>)/ig, \"\")\r\n}\r\n\r\nexport function getFileIconFromName(name){\r\n    let ex = name.split(\".\")\r\n\r\n    return getFileIcon(ex[ex.length - 1].toLowerCase())\r\n}\r\n\r\nexport function getFileIcon(ext){\r\n    switch(ext.toLowerCase()){\r\n      case \"pdf\":\r\n        return `assets/img/types/pdf.svg`\r\n      break\r\n      case \"doc\":\r\n      case \"docx\":\r\n        return `assets/img/types/doc.svg`\r\n      break\r\n      case \"exe\":\r\n        return `assets/img/types/exe.svg`\r\n      break\r\n      case \"mp3\":\r\n        return `assets/img/types/mp3.svg`\r\n      break\r\n      case \"json\":\r\n        return `assets/img/types/json-file.svg`\r\n      break\r\n      case \"png\":\r\n        return `assets/img/types/png.svg`\r\n      break\r\n      case \"ico\":\r\n        return `assets/img/types/ico.svg`\r\n      break\r\n      case \"txt\":\r\n        return `assets/img/types/txt.svg`\r\n      break\r\n      case \"jpg\":\r\n      case \"jpeg\":\r\n        return `assets/img/types/jpg.svg`\r\n      break\r\n      case \"iso\":\r\n        return `assets/img/types/iso.svg`\r\n      break\r\n      case \"js\":\r\n        return `assets/img/types/javascript.svg`\r\n      break\r\n      case \"html\":\r\n        return `assets/img/types/html.svg`\r\n      break\r\n      case \"css\":\r\n        return `assets/img/types/css.svg`\r\n      break\r\n      case \"csv\":\r\n        return `assets/img/types/csv.svg`\r\n      break\r\n      case \"avi\":\r\n        return `assets/img/types/avi.svg`\r\n      break\r\n      case \"mp4\":\r\n        return `assets/img/types/mp4.svg`\r\n      break\r\n      case \"ppt\":\r\n        return `assets/img/types/ppt.svg`\r\n      break\r\n      case \"zip\":\r\n        return `assets/img/types/zip.svg`\r\n      break\r\n      case \"rar\":\r\n      case \"tar\":\r\n      case \"tgz\":\r\n      case \"gz\":\r\n      case \"gzip\":\r\n        return `assets/img/types/zip-1.svg`\r\n      break\r\n      case \"txt\":\r\n        return `assets/img/types/txt.svg`\r\n      break\r\n      case \"svg\":\r\n        return `assets/img/types/svg.svg`\r\n      break\r\n      case \"xml\":\r\n        return `assets/img/types/xml.svg`\r\n      break\r\n      case \"dwg\":\r\n        return `assets/img/types/dwg.svg`\r\n      break\r\n      case \"fla\":\r\n        return `assets/img/types/fla.svg`\r\n      break\r\n      case \"ai\":\r\n        return `assets/img/types/ai.svg`\r\n      break\r\n      default:\r\n        return `assets/img/types/file.svg`\r\n      break\r\n    }\r\n}\r\n\r\nexport function uInt8ArrayConcat(arrays){\r\n    // sum of individual array lengths\r\n    let totalLength = arrays.reduce((acc, value) => acc + value.length, 0);\r\n  \r\n    if (!arrays.length) return null;\r\n  \r\n    let result = new Uint8Array(totalLength);\r\n  \r\n    // for each array - copy it over result\r\n    // next array is copied right after the previous one\r\n    let length = 0;\r\n    for(let array of arrays) {\r\n      result.set(array, length);\r\n      length += array.length;\r\n    }\r\n  \r\n    return result;\r\n}\r\n\r\nexport function orderItemsByType(items, type){\r\n    let files = []\r\n    let folders = []\r\n\r\n    for(let i = 0; i < items.length; i++){\r\n        if(items[i].type == \"file\"){\r\n            files.push(items[i])\r\n        }\r\n        else{\r\n            folders.push(items[i])\r\n        }\r\n    }\r\n\r\n    if(type == \"nameAsc\"){\r\n        let sortedFiles = files.sort((a, b) => {\r\n            return a.name.localeCompare(b.name)\r\n        })\r\n\r\n        let sortedFolders = folders.sort((a, b) => {\r\n            return a.name.localeCompare(b.name)\r\n        })\r\n\r\n        return sortedFolders.concat(sortedFiles)\r\n    }\r\n    else if(type == \"sizeAsc\"){\r\n        let sortedFiles = files.sort((a, b) => {\r\n            return a.size - b.size\r\n        })\r\n\r\n        let sortedFolders = folders.sort((a, b) => {\r\n            return b.timestamp - a.timestamp\r\n        })\r\n\r\n        return sortedFolders.concat(sortedFiles)\r\n    }\r\n    else if(type == \"dateAsc\"){\r\n        let sortedFiles = files.sort((a, b) => {\r\n            return a.timestamp - b.timestamp\r\n        })\r\n\r\n        let sortedFolders = folders.sort((a, b) => {\r\n            return a.timestamp - b.timestamp\r\n        })\r\n\r\n        return sortedFolders.concat(sortedFiles)\r\n    }\r\n    else if(type == \"typeAsc\"){\r\n        let sortedFiles = files.sort((a, b) => {\r\n            if(typeof a.mime == \"undefined\"){\r\n                a.mime = \"_\"\r\n            }\r\n\r\n            if(typeof b.mime == \"undefined\"){\r\n                b.mime = \"_\"\r\n            }\r\n\r\n            if(a.mime.length <= 1){\r\n                a.mime = \"_\"\r\n            }\r\n\r\n            if(b.mime.length <= 1){\r\n                b.mime = \"_\"\r\n            }\r\n\r\n            return a.mime.localeCompare(b.mime)\r\n        })\r\n\r\n        let sortedFolders = folders.sort((a, b) => {\r\n            return b.timestamp - a.timestamp\r\n        })\r\n\r\n        return sortedFolders.concat(sortedFiles)\r\n    }\r\n    else if(type == \"nameDesc\"){\r\n        let sortedFiles = files.sort((a, b) => {\r\n            return b.name.localeCompare(a.name)\r\n        })\r\n\r\n        let sortedFolders = folders.sort((a, b) => {\r\n            return b.name.localeCompare(a.name)\r\n        })\r\n\r\n        return sortedFolders.concat(sortedFiles)\r\n    }\r\n    else if(type == \"sizeDesc\"){\r\n        let sortedFiles = files.sort((a, b) => {\r\n            return b.size - a.size\r\n        })\r\n\r\n        let sortedFolders = folders.sort((a, b) => {\r\n            return b.timestamp - a.timestamp\r\n        })\r\n\r\n        return sortedFolders.concat(sortedFiles)\r\n    }\r\n    else if(type == \"typeDesc\"){\r\n        let sortedFiles = files.sort((a, b) => {\r\n            if(typeof a.mime == \"undefined\"){\r\n                a.mime = \"_\"\r\n            }\r\n\r\n            if(typeof b.mime == \"undefined\"){\r\n                b.mime = \"_\"\r\n            }\r\n\r\n            if(a.mime.length <= 1){\r\n                a.mime = \"_\"\r\n            }\r\n\r\n            if(b.mime.length <= 1){\r\n                b.mime = \"_\"\r\n            }\r\n\r\n            return b.mime.localeCompare(a.mime)\r\n        })\r\n\r\n        let sortedFolders = folders.sort((a, b) => {\r\n            return b.timestamp - a.timestamp\r\n        })\r\n\r\n        return sortedFolders.concat(sortedFiles)\r\n    }\r\n    else{\r\n        //default, dateDesc\r\n\r\n        let sortedFiles = files.sort((a, b) => {\r\n            return b.timestamp - a.timestamp\r\n        })\r\n\r\n        let sortedFolders = folders.sort((a, b) => {\r\n            return b.timestamp - a.timestamp\r\n        })\r\n\r\n        return sortedFolders.concat(sortedFiles)\r\n    }\r\n}\r\n\r\nexport function getVideoCover(file, seekTo = 0.0) {\r\n    return new Promise((resolve, reject) => {\r\n        // load the file to a video player\r\n        const videoPlayer = document.createElement('video');\r\n        videoPlayer.setAttribute('src', URL.createObjectURL(file));\r\n        videoPlayer.load();\r\n        videoPlayer.addEventListener('error', (ex) => {\r\n            reject(\"error when loading video file\", ex);\r\n        });\r\n        // load metadata of the video to get video duration and dimensions\r\n        videoPlayer.addEventListener('loadedmetadata', () => {\r\n            // seek to user defined timestamp (in seconds) if possible\r\n            if (videoPlayer.duration < seekTo) {\r\n                reject(\"video is too short.\");\r\n                return;\r\n            }\r\n\r\n            if(videoPlayer.duration >= 1){\r\n            \tseekTo = 1.0\r\n            }\r\n\r\n            // delay seeking or else 'seeked' event won't fire on Safari\r\n            setTimeout(() => {\r\n              videoPlayer.currentTime = seekTo;\r\n            }, 200);\r\n            // extract video thumbnail once seeking is complete\r\n            videoPlayer.addEventListener('seeked', () => {\r\n                // define a canvas to have the same dimension as the video\r\n                const canvas = document.createElement(\"canvas\");\r\n                canvas.width = videoPlayer.videoWidth;\r\n                canvas.height = videoPlayer.videoHeight;\r\n                // draw the video frame to canvas\r\n                const ctx = canvas.getContext(\"2d\");\r\n                ctx.drawImage(videoPlayer, 0, 0, canvas.width, canvas.height);\r\n                // return the canvas image as a blob\r\n                ctx.canvas.toBlob(\r\n                    blob => {\r\n                        resolve(blob);\r\n                    },\r\n                    \"image/jpeg\",\r\n                    0.1 /* quality */\r\n                );\r\n            });\r\n        });\r\n    });\r\n}\r\n\r\nexport function getLanguageSelection(){\r\n    return `\r\n        <ion-select-option value=\"en\">English</ion-select-option>\r\n        <ion-select-option value=\"de\">Deutsch</ion-select-option>\r\n        <ion-select-option value=\"nl\">Nederlands</ion-select-option>\r\n        <ion-select-option value=\"hi\">हिन्दी, हिंदी</ion-select-option>\r\n    `\r\n}"]},"metadata":{},"sourceType":"module"}