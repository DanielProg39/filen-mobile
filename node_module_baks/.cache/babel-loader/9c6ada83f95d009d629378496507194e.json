{"ast":null,"code":"import { Capacitor, Plugins, FilesystemDirectory } from \"@capacitor/core\";\nimport { modalController, popoverController, menuController, alertController, loadingController, actionSheetController } from \"@ionic/core\";\nimport * as language from \"../utils/language\";\nimport * as Ionicons from 'ionicons/icons';\nimport { isPlatform, getPlatforms } from \"@ionic/react\";\n\nconst utils = require(\"../utils/utils\");\n\nconst safeAreaInsets = require('safe-area-insets');\n\nexport function windowRouter() {\n  window.onhashchange = async () => {\n    if (window.currentHref !== window.location.href) {\n      window.currentHref = window.location.href;\n      this.setState({\n        currentHref: window.currentHref\n      });\n      let routeEx = window.location.hash.split(\"/\");\n\n      if (this.state.isLoggedIn) {\n        if (routeEx[1] == \"base\" || routeEx[1] == \"shared-in\" || routeEx[1] == \"shared-out\" || routeEx[1] == \"trash\" || routeEx[1] == \"links\") {\n          await this.updateItemList();\n          let foldersInRoute = routeEx.slice(2);\n\n          if (foldersInRoute.length > 0) {\n            let lastFolderInRoute = foldersInRoute[foldersInRoute.length - 1];\n\n            if (window.customVariables.cachedFolders[lastFolderInRoute]) {\n              this.setState({\n                mainToolbarTitle: window.customVariables.cachedFolders[lastFolderInRoute].name,\n                showMainToolbarBackButton: true\n              });\n            } else {\n              this.setState({\n                mainToolbarTitle: language.get(this.state.lang, \"myCloud\"),\n                showMainToolbarBackButton: false\n              });\n            }\n          } else {\n            if (routeEx[1] == \"shared-in\") {\n              this.setState({\n                mainToolbarTitle: language.get(this.state.lang, \"sharedInTitle\"),\n                showMainToolbarBackButton: false\n              });\n            } else if (routeEx[1] == \"shared-out\") {\n              this.setState({\n                mainToolbarTitle: language.get(this.state.lang, \"sharedOutTitle\"),\n                showMainToolbarBackButton: false\n              });\n            } else if (routeEx[1] == \"trash\") {\n              this.setState({\n                mainToolbarTitle: language.get(this.state.lang, \"trashTitle\"),\n                showMainToolbarBackButton: false\n              });\n            } else if (routeEx[1] == \"links\") {\n              this.setState({\n                mainToolbarTitle: language.get(this.state.lang, \"linksTitle\"),\n                showMainToolbarBackButton: false\n              });\n            } else {\n              this.setState({\n                mainToolbarTitle: language.get(this.state.lang, \"myCloud\"),\n                showMainToolbarBackButton: false\n              });\n            }\n          }\n        }\n      }\n    }\n  };\n}\nexport function setupWindowFunctions() {\n  window.$ = undefined;\n  let jQueryScript = document.createElement(\"script\");\n  jQueryScript.type = \"text/javascript\";\n  jQueryScript.src = \"assets/jquery.js\";\n  document.getElementsByTagName(\"head\")[0].appendChild(jQueryScript);\n  let pdfJsScript = document.createElement(\"script\");\n  pdfJsScript.type = \"text/javascript\";\n  pdfJsScript.src = \"assets/pdf/build/pdf.js\";\n  document.getElementsByTagName(\"head\")[0].appendChild(pdfJsScript);\n  window.customFunctions = {};\n  window.customVariables = {};\n  window.customVariables.socket = undefined;\n  window.customVariables.socketPingInterval = undefined;\n  window.customVariables.itemList = [];\n  window.customVariables.lang = this.state.lang;\n  window.customVariables.cachedFolders = {};\n  window.customVariables.cachedFiles = {};\n  window.customVariables.cachedMetadata = {};\n  window.customVariables.keyUpdateInterval = undefined;\n  window.customVariables.usageUpdateInterval = undefined;\n  window.customVariables.apiKey = \"\";\n  window.customVariables.uploadSemaphore = new utils.Semaphore(3);\n  window.customVariables.uploadChunkSemaphore = new utils.Semaphore(5);\n  window.customVariables.downloadSemaphore = new utils.Semaphore(5);\n  window.customVariables.downloadChunkSemaphore = new utils.Semaphore(30);\n  window.customVariables.shareItemSemaphore = new utils.Semaphore(4);\n  window.customVariables.decryptShareItemSemaphore = new utils.Semaphore(128);\n  window.customVariables.uploads = {};\n  window.customVariables.downloads = {};\n  window.customVariables.reloadContentAfterUploadTimeout = undefined;\n  window.customVariables.offlineSavedFiles = {};\n  window.customVariables.urlCreator = window.URL || window.webkitURL;\n  window.customVariables.currentPreviewURL = undefined;\n  window.customVariables.reloadAfterActionTimeout = undefined;\n  window.customVariables.nextNativeToastAllowed = Math.floor(+new Date() / 1000);\n  window.customVariables.apiCache = {};\n  window.customVariables.selectLangInterval = undefined;\n  window.customVariables.stoppedUploads = {};\n  window.customVariables.stoppedDownloads = {};\n  window.customVariables.stoppedUploadsDone = {};\n  window.customVariables.stoppedDownloadsDone = {};\n  window.customVariables.lastCachedItemsLength = undefined;\n  window.customVariables.lastAPICacheLength = undefined;\n  window.customVariables.thumbnailCache = {};\n  window.customVariables.thumbnailBlobCache = {};\n  window.customVariables.currentThumbnailURL = undefined;\n  window.customVariables.lastThumbnailCacheLength = undefined;\n  window.customVariables.thumbnailSemaphore = new utils.Semaphore(2);\n  window.customVariables.updateItemsSemaphore = new utils.Semaphore(1);\n  window.customVariables.getNetworkInfoInterval = undefined;\n  window.customVariables.networkStatus = undefined;\n  window.customVariables.orderBy = \"nameAsc\";\n  window.customVariables.getThumbnailErrors = {};\n  window.customVariables.lastGetThumbnailErrorsLength = undefined;\n  window.customVariables.scrollToIndex = {};\n  window.customVariables.mainSearchbarTimeout = undefined;\n  window.customVariables.mainSearchbarInterval = undefined;\n  window.customVariables.lastMainSearchbarTerm = \"\";\n  window.customVariables.userMasterKeys = [];\n  window.customVariables.isGettingPreviewData = false;\n  window.customVariables.stopGettingPreviewData = false;\n  window.customVariables.cachedAPIItemListRequests = {};\n  window.customVariables.deviceHeightAndWidthInterval = undefined;\n  clearInterval(window.customVariables.mainSearchbarInterval);\n  window.customVariables.mainSearchbarInterval = setInterval(() => {\n    if (document.getElementById(\"main-searchbar\") !== null) {\n      let term = document.getElementById(\"main-searchbar\").value.trim();\n\n      if (typeof term == \"string\") {\n        if (term.length > 0) {\n          if (term !== window.customVariables.lastMainSearchbarTerm) {\n            window.customVariables.lastMainSearchbarTerm = term;\n            clearTimeout(window.customVariables.mainSearchbarTimeout);\n            window.customVariables.mainSearchbarTimeout = setTimeout(() => {\n              this.setMainSearchTerm(term);\n            }, 250);\n          }\n        } else {\n          clearTimeout(window.customVariables.mainSearchbarTimeout);\n          this.setMainSearchTerm(\"\");\n        }\n      } else {\n        clearTimeout(window.customVariables.mainSearchbarTimeout);\n        this.setMainSearchTerm(\"\");\n      }\n    } else {\n      clearTimeout(window.customVariables.mainSearchbarTimeout);\n    }\n  }, 100);\n\n  const updateHeightAndWidthState = () => {\n    this.setState({\n      windowHeight: window.innerHeight,\n      windowWidth: window.innerWidth\n    });\n  };\n\n  clearInterval(window.customVariables.deviceHeightAndWidthInterval);\n  window.customVariables.deviceHeightAndWidthInterval = setInterval(() => {\n    updateHeightAndWidthState();\n  }, 250);\n  window.addEventListener(\"orientationchange\", () => {\n    updateHeightAndWidthState();\n  }, false);\n  window.addEventListener(\"resize\", function () {\n    updateHeightAndWidthState();\n  }, false);\n\n  document.onclick = e => {\n    return window.customFunctions.togglePreviewHeader(e);\n  };\n\n  window.customFunctions.isPlatform = isPlatform;\n  window.customFunctions.safeAreaInsets = safeAreaInsets;\n\n  window.customFunctions.togglePreviewHeader = e => {\n    if (typeof e.target == \"undefined\") {\n      return;\n    }\n\n    if (e.target.innerHTML.indexOf(\"<ion-icon\") !== -1) {\n      return false;\n    }\n\n    if (document.getElementsByClassName(\"preview-header-hidden\").length > 0) {\n      let header = document.getElementsByClassName(\"preview-header-hidden\")[0];\n\n      if (header.style.display == \"none\") {\n        header.style.display = \"block\";\n      } else {\n        header.style.display = \"none\";\n      }\n    }\n  };\n\n  window.customFunctions.getNetworkInfo = async () => {\n    try {\n      window.customVariables.networkStatus = await Plugins.Network.getStatus();\n    } catch (e) {\n      console.log(e);\n    }\n  };\n\n  window.customFunctions.saveOfflineSavedFiles = async () => {\n    try {\n      await Plugins.Storage.set({\n        key: \"offlineSavedFiles\",\n        value: JSON.stringify(window.customVariables.offlineSavedFiles)\n      });\n    } catch (e) {\n      console.log(e);\n    }\n  };\n\n  window.customFunctions.saveGetThumbnailErrors = async () => {\n    if (typeof window.customVariables.lastGetThumbnailErrorsLength !== \"undefined\") {\n      let length = JSON.stringify(window.customVariables.getThumbnailErrors);\n      length = length.length;\n\n      if (length == window.customVariables.lastGetThumbnailErrorsLength) {\n        return false;\n      } else {\n        window.customVariables.lastGetThumbnailErrorsLength = length;\n      }\n    }\n\n    try {\n      await Plugins.Storage.set({\n        key: \"getThumbnailErrors\",\n        value: JSON.stringify(window.customVariables.getThumbnailErrors)\n      });\n    } catch (e) {\n      console.log(e);\n    }\n  };\n\n  window.customFunctions.saveAPICache = async () => {\n    if (typeof window.customVariables.lastAPICacheLength !== \"undefined\") {\n      let length = JSON.stringify(window.customVariables.apiCache);\n      length = length.length;\n\n      if (length == window.customVariables.lastAPICacheLength) {\n        return false;\n      } else {\n        window.customVariables.lastAPICacheLength = length;\n      }\n    }\n\n    try {\n      await Plugins.Storage.set({\n        key: \"apiCache\",\n        value: JSON.stringify(window.customVariables.apiCache)\n      });\n    } catch (e) {\n      console.log(e);\n    }\n  };\n\n  window.customFunctions.saveThumbnailCache = async () => {\n    if (typeof window.customVariables.lastThumbnailCacheLength !== \"undefined\") {\n      let length = JSON.stringify(window.customVariables.thumbnailCache);\n      length = length.length;\n\n      if (length == window.customVariables.lastThumbnailCacheLength) {\n        return false;\n      } else {\n        window.customVariables.lastThumbnailCacheLength = length;\n      }\n    }\n\n    try {\n      await Plugins.Storage.set({\n        key: \"thumbnailCache\",\n        value: JSON.stringify(window.customVariables.thumbnailCache)\n      });\n    } catch (e) {\n      console.log(e);\n    }\n  };\n\n  window.customFunctions.saveCachedItems = async () => {\n    if (typeof window.customVariables.lastCachedItemsLength !== \"undefined\") {\n      let length = JSON.stringify(window.customVariables.cachedFiles) + JSON.stringify(window.customVariables.cachedFolders);\n      length = length.length;\n\n      if (length == window.customVariables.lastCachedItemsLength) {\n        return false;\n      } else {\n        window.customVariables.lastCachedItemsLength = length;\n      }\n    }\n\n    try {\n      await Plugins.Storage.set({\n        key: \"cachedFiles\",\n        value: JSON.stringify(window.customVariables.cachedFiles)\n      });\n      await Plugins.Storage.set({\n        key: \"cachedFolders\",\n        value: JSON.stringify(window.customVariables.cachedFolders)\n      });\n    } catch (e) {\n      console.log(e);\n    }\n  };\n\n  window.customFunctions.dismissActionSheet = async (all = false) => {\n    if (all) {\n      try {\n        await actionSheetController.dismiss();\n        return true;\n      } catch (e) {\n        return console.log(e);\n      }\n    }\n\n    try {\n      let actionSheet = await actionSheetController.getTop();\n\n      if (typeof actionSheet !== \"undefined\") {\n        return actionSheet.dismiss();\n      }\n\n      return true;\n    } catch (e) {\n      return console.log(e);\n    }\n  };\n\n  window.customFunctions.dismissPopover = async (all = false) => {\n    if (all) {\n      try {\n        await popoverController.dismiss();\n        return true;\n      } catch (e) {\n        return console.log(e);\n      }\n    }\n\n    try {\n      let popover = await popoverController.getTop();\n\n      if (typeof popover !== \"undefined\") {\n        return popover.dismiss();\n      }\n\n      return true;\n    } catch (e) {\n      return console.log(e);\n    }\n  };\n\n  window.customFunctions.dismissModal = async (all = false) => {\n    if (all) {\n      try {\n        await modalController.dismiss();\n        return true;\n      } catch (e) {\n        return console.log(e);\n      }\n    }\n\n    try {\n      let modal = await modalController.getTop();\n\n      if (typeof modal !== \"undefined\") {\n        return modal.dismiss();\n      }\n\n      return true;\n    } catch (e) {\n      return console.log(e);\n    }\n  };\n\n  window.customFunctions.dismissLoader = async (all = false) => {\n    if (all) {\n      try {\n        await loadingController.dismiss();\n        return true;\n      } catch (e) {\n        return console.log(e);\n      }\n    }\n\n    try {\n      let loader = await loadingController.getTop();\n\n      if (typeof loader !== \"undefined\") {\n        return loader.dismiss();\n      }\n\n      return true;\n    } catch (e) {\n      return console.log(e);\n    }\n  };\n\n  window.customFunctions.dismissAlert = async (all = false) => {\n    if (all) {\n      try {\n        await alertController.dismiss();\n        return true;\n      } catch (e) {\n        return console.log(e);\n      }\n    }\n\n    try {\n      let alert = await alertController.getTop();\n\n      if (typeof alert !== \"undefined\") {\n        return alert.dismiss();\n      }\n\n      return true;\n    } catch (e) {\n      return console.log(e);\n    }\n  };\n\n  window.customFunctions.selectAllItems = () => {\n    let items = [];\n\n    for (let i = 0; i < this.state.itemList.length; i++) {\n      let item = this.state.itemList[i];\n      item.selected = true;\n      items.push(item);\n    }\n\n    this.setState({\n      itemList: items,\n      selectedItems: items.length\n    });\n    return window.customFunctions.dismissPopover();\n  };\n\n  window.customFunctions.unselectAllItems = () => {\n    let items = [];\n\n    for (let i = 0; i < this.state.itemList.length; i++) {\n      let item = this.state.itemList[i];\n      item.selected = false;\n      items.push(item);\n    }\n\n    this.setState({\n      itemList: items,\n      selectedItems: 0\n    });\n    return window.customFunctions.dismissPopover();\n  };\n\n  window.customFunctions.refreshItemList = () => {\n    this.updateItemList();\n    return window.customFunctions.dismissPopover();\n  };\n\n  window.customFunctions.hideSidebarMenu = async () => {\n    let mainMenu = await menuController.get(\"sideBarMenu\");\n    return mainMenu.close();\n  };\n\n  window.customFunctions.openRegisterModal = () => {\n    return this.showRegister();\n  };\n\n  window.customFunctions.doLogout = async () => {\n    await Plugins.Storage.set({\n      key: \"isLoggedIn\",\n      value: \"false\"\n    });\n    await Plugins.Storage.set({\n      key: \"userAPIKey\",\n      value: \"\"\n    });\n    await Plugins.Storage.set({\n      key: \"userEmail\",\n      value: \"\"\n    });\n    await Plugins.Storage.set({\n      key: \"userMasterKeys\",\n      value: JSON.stringify([])\n    });\n    await Plugins.Storage.set({\n      key: \"userPublicKey\",\n      value: \"\"\n    });\n    await Plugins.Storage.set({\n      key: \"userPrivateKey\",\n      value: \"\"\n    });\n    this.setState({\n      isLoggedIn: false\n    });\n    return this.showLogin();\n  };\n\n  window.customFunctions.doLogin = async () => {\n    let email = document.getElementById(\"login-email\").value;\n    let password = document.getElementById(\"login-password\").value;\n    let twoFactorKey = document.getElementById(\"login-2fa\").value;\n\n    if (!email || !password) {\n      let alert = await alertController.create({\n        header: \"\",\n        subHeader: \"\",\n        message: language.get(this.state.lang, \"loginInvalidInputs\"),\n        buttons: [language.get(this.state.lang, \"alertOkButton\").toUpperCase()]\n      });\n      return alert.present();\n    }\n\n    if (twoFactorKey.length == 0) {\n      twoFactorKey = \"XXXXXX\";\n    }\n\n    let loading = await loadingController.create({\n      message: \"\"\n    });\n    loading.present();\n\n    try {\n      var res = await utils.apiRequest(\"POST\", \"/v1/login\", {\n        email,\n        password,\n        twoFactorKey\n      });\n    } catch (e) {\n      document.getElementById(\"login-password\").value = \"\";\n      document.getElementById(\"login-2fa\").value = \"\";\n      console.log(e);\n      window.customFunctions.dismissLoader();\n      let alert = await alertController.create({\n        header: \"\",\n        subHeader: \"\",\n        message: language.get(this.state.lang, \"apiRequestError\"),\n        buttons: [language.get(this.state.lang, \"alertOkButton\").toUpperCase()]\n      });\n      return alert.present();\n    }\n\n    if (!res.status) {\n      if (res.message == \"Please enter your Two Factor Authentication code.\") {\n        window.customFunctions.dismissLoader();\n        document.getElementById(\"login-2fa-container\").style.display = \"block\";\n        let alert = await alertController.create({\n          header: \"\",\n          subHeader: \"\",\n          message: language.get(this.state.lang, \"loginWith2FACode\"),\n          buttons: [language.get(this.state.lang, \"alertOkButton\").toUpperCase()]\n        });\n        return alert.present();\n      } else {\n        document.getElementById(\"login-password\").value = \"\";\n        document.getElementById(\"login-2fa\").value = \"\";\n        window.customFunctions.dismissLoader();\n\n        if (res.message == \"Account not yet activated.\") {\n          let alert = await alertController.create({\n            header: \"\",\n            subHeader: \"\",\n            message: language.get(this.state.lang, \"loginAccountNotActivated\"),\n            buttons: [language.get(this.state.lang, \"alertOkButton\").toUpperCase()]\n          });\n          return alert.present();\n        } else if (res.message == \"Account not found.\") {\n          let alert = await alertController.create({\n            header: \"\",\n            subHeader: \"\",\n            message: language.get(this.state.lang, \"loginAccountNotFound\"),\n            buttons: [language.get(this.state.lang, \"alertOkButton\").toUpperCase()]\n          });\n          return alert.present();\n        }\n\n        let alert = await alertController.create({\n          header: \"\",\n          subHeader: \"\",\n          message: language.get(this.state.lang, \"loginWrongCredentials\"),\n          buttons: [language.get(this.state.lang, \"alertOkButton\").toUpperCase()]\n        });\n        return alert.present();\n      }\n    }\n\n    await Plugins.Storage.set({\n      key: \"isLoggedIn\",\n      value: \"true\"\n    });\n    await Plugins.Storage.set({\n      key: \"userAPIKey\",\n      value: res.data.apiKey\n    });\n    await Plugins.Storage.set({\n      key: \"userEmail\",\n      value: email\n    });\n    await Plugins.Storage.set({\n      key: \"userMasterKeys\",\n      value: JSON.stringify([utils.hashFn(password)])\n    });\n    /*window.customFunctions.dismissLoader(true)\r\n    window.customFunctions.dismissModal(true)\r\n    window.customFunctions.dismissLoader()\r\n      document.getElementById(\"login-email\").value = \"\"\r\n    document.getElementById(\"login-password\").value = \"\"\r\n    document.getElementById(\"login-2fa\").value = \"\"*/\n\n    return document.location.href = \"index.html\";\n  };\n\n  window.customFunctions.doRegister = async () => {\n    let email = document.getElementById(\"register-email\").value;\n    let password = document.getElementById(\"register-password\").value;\n    let passwordRepeat = document.getElementById(\"register-password-repeat\").value;\n\n    if (!email || !password || !passwordRepeat) {\n      let alert = await alertController.create({\n        header: \"\",\n        subHeader: \"\",\n        message: language.get(this.state.lang, \"registerInvalidInputs\"),\n        buttons: [language.get(this.state.lang, \"alertOkButton\").toUpperCase()]\n      });\n      return alert.present();\n    }\n\n    let loading = await loadingController.create({\n      message: \"\"\n    });\n    loading.present();\n\n    try {\n      var res = await utils.apiRequest(\"POST\", \"/v1/register\", {\n        email,\n        password,\n        passwordRepeat\n      });\n    } catch (e) {\n      document.getElementById(\"register-password\").value = \"\";\n      document.getElementById(\"register-password-repeat\").value = \"\";\n      console.log(e);\n      window.customFunctions.dismissLoader();\n      let alert = await alertController.create({\n        header: \"\",\n        subHeader: \"\",\n        message: language.get(this.state.lang, \"apiRequestError\"),\n        buttons: [language.get(this.state.lang, \"alertOkButton\").toUpperCase()]\n      });\n      return alert.present();\n    }\n\n    if (!res.status) {\n      document.getElementById(\"register-password\").value = \"\";\n      document.getElementById(\"register-password-repeat\").value = \"\";\n      window.customFunctions.dismissLoader();\n      let message = \"\";\n\n      if (res.message.toLowerCase().indexOf(\"invalid email\") !== -1 || res.message.toLowerCase().indexOf(\"invalid password\") !== -1 || res.message.toLowerCase().indexOf(\"invalid email\") !== -1) {\n        message = language.get(this.state.lang, \"registerInvalidFields\");\n      } else if (res.message.toLowerCase().indexOf(\"your password needs to be at least 10 characters long\") !== -1) {\n        message = language.get(this.state.lang, \"registerPasswordAtLeast10Chars\");\n      } else if (res.message.toLowerCase().indexOf(\"passwords do not match\") !== -1) {\n        message = language.get(this.state.lang, \"registerPasswordsDoNotMatch\");\n      } else if (res.message.toLowerCase().indexOf(\"invalid email\") !== -1) {\n        message = language.get(this.state.lang, \"registerInvalidEmail\");\n      } else if (res.message.toLowerCase().indexOf(\"database error\") !== -1) {\n        message = language.get(this.state.lang, \"apiRequestError\");\n      } else if (res.message.toLowerCase().indexOf(\"this email is already registered\") !== -1) {\n        message = language.get(this.state.lang, \"registerEmailAlreadyRegistered\");\n      } else if (res.message.toLowerCase().indexOf(\"we could not send an email at this time, please try again later\") !== -1) {\n        message = language.get(this.state.lang, \"registerCouldNotSendEmail\");\n      }\n\n      let alert = await alertController.create({\n        header: \"\",\n        subHeader: \"\",\n        message: message,\n        buttons: [language.get(this.state.lang, \"alertOkButton\").toUpperCase()]\n      });\n      return alert.present();\n    }\n\n    document.getElementById(\"register-email\").value = \"\";\n    document.getElementById(\"register-password\").value = \"\";\n    document.getElementById(\"register-password-repeat\").value = \"\";\n    window.customFunctions.dismissLoader();\n    let alert = await alertController.create({\n      header: \"\",\n      subHeader: \"\",\n      message: language.get(this.state.lang, \"registerSuccess\"),\n      buttons: [language.get(this.state.lang, \"alertOkButton\").toUpperCase()]\n    });\n    return alert.present();\n  };\n\n  window.customFunctions.openSettingsModal = async () => {\n    return this.openSettingsModal();\n  };\n\n  window.customFunctions.setLang = async (lang = \"en\") => {\n    await Plugins.Storage.set({\n      key: \"lang\",\n      value: lang\n    });\n    return document.location.href = \"index.html\";\n  };\n\n  window.customFunctions.openLanguageModal = async () => {\n    let appLang = this.state.lang;\n    let appDarkMode = this.state.darkMode;\n    let modalId = \"language-modal-\" + utils.generateRandomClassName();\n    let languagesHTML = \"\";\n    let langList = language.list();\n\n    for (let prop in langList) {\n      languagesHTML += `\n                <ion-item lines=\"none\" onClick=\"window.customFunctions.setLang('` + prop + `')\" button>\n                    <ion-label>` + language.name(prop) + `</ion-label>\n                    <ion-radio slot=\"end\" value=\"` + prop + `\"></ion-radio>\n                </ion-item>\n            `;\n    }\n\n    customElements.define(modalId, class ModalContent extends HTMLElement {\n      connectedCallback() {\n        this.innerHTML = `\n                    <ion-header style=\"margin-top: ` + (isPlatform(\"ipad\") ? safeAreaInsets.top : 0) + `px;\">\n                        <ion-toolbar>\n                            <ion-buttons slot=\"start\">\n                                <ion-button onClick=\"window.customFunctions.dismissModal()\">\n                                    <ion-icon slot=\"icon-only\" icon=\"` + Ionicons.arrowBack + `\"></ion-icon>\n                                </ion-button>\n                            </ion-buttons>\n                            <ion-title>\n                                ` + language.get(appLang, \"settingsLanguage\") + `\n                            </ion-title>\n                        </ion-toolbar>\n                    </ion-header>\n                    <ion-content style=\"--background: ` + (appDarkMode ? \"#1E1E1E\" : \"white\") + `\" fullscreen>\n                        <ion-list>\n                            <ion-radio-group value=\"` + appLang + `\">\n                                ` + languagesHTML + `\n                            </ion-radio-group>\n                        </ion-list>\n                    </ion-content>\n                `;\n      }\n\n    });\n    let modal = await modalController.create({\n      component: modalId,\n      swipeToClose: true,\n      showBackdrop: false,\n      backdropDismiss: false,\n      cssClass: \"modal-fullscreen\"\n    });\n    return modal.present();\n  };\n\n  window.customFunctions.openEncryptionModal = async () => {\n    let appLang = this.state.lang;\n    let appDarkMode = this.state.darkMode;\n    let modalId = \"encryption-modal-\" + utils.generateRandomClassName();\n    customElements.define(modalId, class ModalContent extends HTMLElement {\n      connectedCallback() {\n        this.innerHTML = `\n                    <ion-header style=\"margin-top: ` + (isPlatform(\"ipad\") ? safeAreaInsets.top : 0) + `px;\">\n                        <ion-toolbar>\n                            <ion-buttons slot=\"start\">\n                                <ion-button onClick=\"window.customFunctions.dismissModal()\">\n                                    <ion-icon slot=\"icon-only\" icon=\"` + Ionicons.arrowBack + `\"></ion-icon>\n                                </ion-button>\n                            </ion-buttons>\n                            <ion-title>\n                                ` + language.get(appLang, \"encryption\") + `\n                            </ion-title>\n                        </ion-toolbar>\n                    </ion-header>\n                    <ion-content style=\"--background: ` + (appDarkMode ? \"#1E1E1E\" : \"white\") + `\" fullscreen>\n                        <ion-list>\n                            <ion-item-divider style=\"--background: ` + (appDarkMode ? \"#1E1E1E\" : \"white\") + `\">\n                                <ion-label>\n                                    ` + language.get(appLang, \"encryptionModalHeader\") + `\n                                </ion-label>\n                            </ion-item-divider>\n                            <ion-item lines=\"none\" style=\"padding-top: 10px;\">\n                                ` + language.get(appLang, \"encryptionModalFirstText\") + `\n                            </ion-item>\n                            <ion-item-divider style=\"padding-top: 15px; --background: ` + (appDarkMode ? \"#1E1E1E\" : \"white\") + `\">\n                                <ion-label>\n                                    ` + language.get(appLang, \"encryptionModalHeaderHowItWorks\") + `\n                                </ion-label>\n                            </ion-item-divider>\n                            <ion-item lines=\"none\" style=\"padding-top: 10px;\">\n                                ` + language.get(appLang, \"encryptionModalHowItWorksText\") + `\n                            </ion-item>\n                        </ion-list>\n                    </ion-content>\n                `;\n      }\n\n    });\n    let modal = await modalController.create({\n      component: modalId,\n      swipeToClose: true,\n      showBackdrop: false,\n      backdropDismiss: false,\n      cssClass: \"modal-fullscreen\"\n    });\n    return modal.present();\n  };\n\n  window.customFunctions.openWebsiteModal = async () => {\n    let actionSheet = await actionSheetController.create({\n      header: language.get(this.state.lang, \"website\"),\n      buttons: [{\n        text: language.get(this.state.lang, \"website\"),\n        icon: Ionicons.globe,\n        handler: () => {\n          window.open(\"https://filen.io/\", \"_system\");\n          return false;\n        }\n      }, {\n        text: language.get(this.state.lang, \"onlineFM\"),\n        icon: Ionicons.grid,\n        handler: () => {\n          window.open(\"https://filen.io/my-account/file-manager/default\", \"_system\");\n          return false;\n        }\n      }, {\n        text: language.get(this.state.lang, \"cancel\"),\n        icon: \"close\",\n        role: \"cancel\"\n      }]\n    });\n    return actionSheet.present();\n  };\n\n  window.customFunctions.openHelpModal = async () => {\n    let btns = [{\n      text: language.get(this.state.lang, \"support\"),\n      icon: Ionicons.helpBuoyOutline,\n      handler: () => {\n        window.open(\"https://support.filen.io/\", \"_system\");\n        return false;\n      }\n    }, {\n      text: language.get(this.state.lang, \"faq\"),\n      icon: Ionicons.informationCircle,\n      handler: () => {\n        window.open(\"https://filen.io/faq\", \"_system\");\n        return false;\n      }\n    }, {\n      text: language.get(this.state.lang, \"tos\"),\n      icon: Ionicons.informationCircleOutline,\n      handler: () => {\n        window.open(\"https://filen.io/terms\", \"_system\");\n        return false;\n      }\n    }, {\n      text: language.get(this.state.lang, \"privacyPolicy\"),\n      icon: Ionicons.informationCircleOutline,\n      handler: () => {\n        window.open(\"https://filen.io/privacy\", \"_system\");\n        return false;\n      }\n    }, {\n      text: language.get(this.state.lang, \"cancel\"),\n      icon: \"close\",\n      role: \"cancel\"\n    }];\n\n    if (isPlatform(\"ios\")) {\n      btns = [{\n        text: language.get(this.state.lang, \"support\"),\n        icon: Ionicons.helpBuoyOutline,\n        handler: () => {\n          window.open(\"https://support.filen.io/\", \"_system\");\n          return false;\n        }\n      }, {\n        text: language.get(this.state.lang, \"cancel\"),\n        icon: \"close\",\n        role: \"cancel\"\n      }];\n    }\n\n    let actionSheet = await actionSheetController.create({\n      header: language.get(this.state.lang, \"help\"),\n      buttons: btns\n    });\n    return actionSheet.present();\n  };\n\n  window.customFunctions.queueFileUpload = this.queueFileUpload;\n  window.customFunctions.queueFileDownload = this.queueFileDownload;\n\n  window.customFunctions.openItemActionSheetFromJSON = itemJSON => {\n    let item = JSON.parse(window.atob(itemJSON));\n    return this.spawnItemActionSheet(item);\n  };\n\n  window.customFunctions.moveSelectedItems = () => {\n    return this.moveSelectedItems();\n  };\n\n  window.customFunctions.trashSelectedItems = () => {\n    return this.trashSelectedItems();\n  };\n\n  window.customFunctions.restoreSelectedItems = () => {\n    return this.restoreSelectedItems();\n  };\n\n  window.customFunctions.removeSelectedItemsFromSharedIn = () => {\n    return this.removeSelectedItemsFromSharedIn();\n  };\n\n  window.customFunctions.stopSharingSelectedItems = () => {\n    return this.stopSharingSelectedItems();\n  };\n\n  window.customFunctions.downloadSelectedItems = () => {\n    return this.downloadSelectedItems();\n  };\n\n  window.customFunctions.storeSelectedItemsOffline = () => {\n    return this.storeSelectedItemsOffline();\n  };\n\n  window.customFunctions.shareSelectedItems = () => {\n    return this.shareSelectedItems();\n  };\n\n  window.customFunctions.settingsToggleDarkMode = async () => {\n    if (this.state.darkMode) {\n      await Plugins.Storage.set({\n        key: \"darkMode\",\n        value: \"false\"\n      });\n      document.getElementById(\"settings-dark-mode-toggle\").checked = false;\n      return this.setState({\n        darkMode: false\n      }, () => {\n        document.location.href = \"index.html\";\n      });\n    } else {\n      await Plugins.Storage.set({\n        key: \"darkMode\",\n        value: \"true\"\n      });\n      document.getElementById(\"settings-dark-mode-toggle\").checked = true;\n      return this.setState({\n        darkMode: true\n      }, () => {\n        document.location.href = \"index.html\";\n      });\n    }\n  };\n\n  window.customFunctions.loginToggleDarkMode = async () => {\n    if (this.state.darkMode) {\n      await Plugins.Storage.set({\n        key: \"darkMode\",\n        value: \"false\"\n      });\n      return this.setState({\n        darkMode: false\n      }, () => {\n        document.location.href = \"index.html\";\n      });\n    } else {\n      await Plugins.Storage.set({\n        key: \"darkMode\",\n        value: \"true\"\n      });\n      return this.setState({\n        darkMode: true\n      }, () => {\n        document.location.href = \"index.html\";\n      });\n    }\n  };\n\n  window.customFunctions.saveSettings = async newSettings => {\n    await Plugins.Storage.set({\n      key: \"settings\",\n      value: JSON.stringify(newSettings)\n    });\n    return this.setState({\n      settings: newSettings\n    });\n  };\n\n  window.customFunctions.toggleOnlyWifi = () => {\n    let newSettings = this.state.settings;\n    let newVal = !newSettings.onlyWifi;\n    newSettings.onlyWifi = newVal;\n    document.getElementById(\"settings-only-wifi-toggle\").checked = !newVal;\n    return window.customFunctions.saveSettings(newSettings);\n  };\n\n  window.customFunctions.logoutUser = async () => {\n    await Plugins.Storage.remove({\n      key: \"isLoggedIn\"\n    });\n    await Plugins.Storage.remove({\n      key: \"userAPIKey\"\n    });\n    await Plugins.Storage.remove({\n      key: \"userEmail\"\n    });\n    await Plugins.Storage.remove({\n      key: \"userMasterKeys\"\n    });\n    await Plugins.Storage.remove({\n      key: \"userPublicKey\"\n    });\n    await Plugins.Storage.remove({\n      key: \"userPrivateKey\"\n    });\n    await Plugins.Storage.remove({\n      key: \"offlineSavedFiles\"\n    });\n    await Plugins.Storage.remove({\n      key: \"apiCache\"\n    });\n    return document.location.href = \"index.html\";\n  };\n\n  window.customFunctions.doLogout = async () => {\n    let alert = await alertController.create({\n      header: language.get(this.state.lang, \"logoutAlertHeader\"),\n      message: language.get(this.state.lang, \"logoutConfirmation\"),\n      buttons: [{\n        text: language.get(this.state.lang, \"cancel\"),\n        role: \"cancel\",\n        handler: () => {\n          return false;\n        }\n      }, {\n        text: language.get(this.state.lang, \"alertOkButton\"),\n        handler: () => {\n          return window.customFunctions.logoutUser();\n        }\n      }]\n    });\n    return alert.present();\n  };\n\n  window.customFunctions.emptyTrash = async () => {\n    let alert = await alertController.create({\n      header: language.get(this.state.lang, \"emptyTrashHeader\"),\n      message: language.get(this.state.lang, \"emptyTrashWarning\"),\n      buttons: [{\n        text: language.get(this.state.lang, \"cancel\"),\n        role: \"cancel\",\n        handler: () => {\n          return false;\n        }\n      }, {\n        text: language.get(this.state.lang, \"alertOkButton\"),\n        handler: async () => {\n          let loading = await loadingController.create({\n            message: \"\"\n          });\n          loading.present();\n\n          try {\n            var res = await utils.apiRequest(\"POST\", \"/v1/trash/empty\", {\n              apiKey: this.state.userAPIKey\n            });\n          } catch (e) {\n            console.log(e);\n            loading.dismiss();\n            return this.spawnToast(language.get(this.state.lang, \"apiRequestError\"));\n          }\n\n          if (!res.status) {\n            console.log(res.message);\n            loading.dismiss();\n            return this.spawnToast(res.message);\n          }\n\n          loading.dismiss();\n          this.updateItemList();\n          return this.spawnToast(language.get(this.state.lang, \"trashEmptied\"));\n        }\n      }]\n    });\n    return alert.present();\n  };\n\n  window.customFunctions.changeItemColor = async (itemJSON, color) => {\n    let item = JSON.parse(window.atob(itemJSON));\n    let loading = await loadingController.create({\n      message: \"\"\n    });\n    loading.present();\n\n    try {\n      var res = await utils.apiRequest(\"POST\", \"/v1/dir/color/change\", {\n        apiKey: this.state.userAPIKey,\n        uuid: item.uuid,\n        color: color\n      });\n    } catch (e) {\n      console.log(e);\n      loading.dismiss();\n      return this.spawnToast(language.get(this.state.lang, \"apiRequestError\"));\n    }\n\n    if (!res.status) {\n      console.log(res.message);\n      loading.dismiss();\n      return this.spawnToast(res.message);\n    }\n\n    loading.dismiss();\n\n    try {\n      await this.updateItemList();\n    } catch (e) {\n      console.log(e);\n    }\n\n    return window.customFunctions.dismissModal();\n  };\n\n  window.customFunctions.editItemPublicLink = async (itemJSON, type, isEdit = false, currentLinkUUID = \"\") => {\n    let item = JSON.parse(window.atob(itemJSON));\n    let linkUUID = utils.uuidv4();\n\n    if (isEdit && typeof currentLinkUUID == \"string\") {\n      if (currentLinkUUID.length > 1) {\n        linkUUID = currentLinkUUID;\n      }\n    }\n\n    let loading = await loadingController.create({\n      message: \"\"\n    });\n    loading.present();\n    let expires = \"never\";\n\n    if (typeof document.getElementById(\"public-link-expires-select\").value == \"string\") {\n      expires = document.getElementById(\"public-link-expires-select\").value;\n    }\n\n    let password = \"empty\";\n\n    if (typeof document.getElementById(\"public-link-password-input\").value == \"string\") {\n      if (document.getElementById(\"public-link-password-input\").value) {\n        password = document.getElementById(\"public-link-password-input\").value;\n      }\n    }\n\n    let downloadBtn = \"enable\";\n\n    if (document.getElementById(\"public-link-enable-download-btn-toggle\") !== null) {\n      if (!document.getElementById(\"public-link-enable-download-btn-toggle\").checked) {\n        downloadBtn = \"disable\";\n      }\n    }\n\n    if (item.type == \"file\") {\n      try {\n        var res = await utils.apiRequest(\"POST\", \"/v1/link/edit\", {\n          apiKey: this.state.userAPIKey,\n          uuid: linkUUID,\n          fileUUID: item.uuid,\n          expiration: expires,\n          password: password,\n          passwordHashed: utils.hashFn(password),\n          downloadBtn: downloadBtn,\n          type: type\n        });\n      } catch (e) {\n        console.log(e);\n        loading.dismiss();\n        return this.spawnToast(language.get(this.state.lang, \"apiRequestError\"));\n      }\n\n      if (!res.status) {\n        console.log(res.message);\n        loading.dismiss();\n        return this.spawnToast(res.message);\n      }\n\n      loading.dismiss();\n      document.getElementById(\"public-link-enabled-toggle\").checked = true;\n      document.getElementById(\"public-link-input\").value = \"https://filen.io/d/\" + linkUUID + \"#!\" + item.key;\n\n      if (type == \"enable\") {\n        document.getElementById(\"enable-public-link-content\").style.display = \"none\";\n        document.getElementById(\"public-link-enabled-content\").style.display = \"block\";\n      } else {\n        document.getElementById(\"enable-public-link-content\").style.display = \"block\";\n        document.getElementById(\"public-link-enabled-content\").style.display = \"none\";\n\n        try {\n          await this.updateItemList();\n        } catch (e) {\n          console.log(e);\n        }\n      }\n\n      return true;\n    } else {\n      const removeFolderLink = async callback => {\n        let removeLoading = await loadingController.create({\n          message: \"\"\n        });\n        removeLoading.present();\n\n        try {\n          var res = await utils.apiRequest(\"POST\", \"/v1/dir/link/remove\", {\n            apiKey: this.state.userAPIKey,\n            uuid: item.uuid\n          });\n        } catch (e) {\n          console.log(e);\n          removeLoading.dismiss();\n          return callback(language.get(this.state.lang, \"apiRequestError\"));\n        }\n\n        if (!res.status) {\n          console.log(res.message);\n          removeLoading.dismiss();\n          return callback(res.message);\n        }\n\n        removeLoading.dismiss();\n        return callback(null);\n      };\n\n      const editFolderLink = async callback => {\n        let editLoading = await loadingController.create({\n          message: \"\"\n        });\n        editLoading.present();\n\n        try {\n          var res = await utils.apiRequest(\"POST\", \"/v1/dir/link/edit\", {\n            apiKey: this.state.userAPIKey,\n            uuid: item.uuid,\n            expiration: expires,\n            password: password,\n            passwordHashed: utils.hashFn(password),\n            downloadBtn: downloadBtn\n          });\n        } catch (e) {\n          console.log(e);\n          editLoading.dismiss();\n          return callback(language.get(this.state.lang, \"apiRequestError\"));\n        }\n\n        if (!res.status) {\n          console.log(res.message);\n          editLoading.dismiss();\n          return callback(res.message);\n        }\n\n        editLoading.dismiss();\n        return callback(null);\n      };\n\n      const createFolderLink = async callback => {\n        let createLoading = await loadingController.create({\n          message: \"\",\n          backdropDismiss: false\n        });\n        createLoading.present();\n\n        try {\n          var res = await utils.apiRequest(\"POST\", \"/v1/download/dir\", {\n            apiKey: this.state.userAPIKey,\n            uuid: item.uuid\n          });\n        } catch (e) {\n          console.log(e);\n          createLoading.dismiss();\n          return callback(language.get(this.state.lang, \"apiRequestError\"));\n        }\n\n        if (!res.status) {\n          console.log(res.message);\n          createLoading.dismiss();\n          return callback(res.message);\n        }\n\n        let key = utils.generateRandomString(32);\n        let keyEnc = utils.cryptoJSEncrypt(key, this.state.userMasterKeys[this.state.userMasterKeys.length - 1]);\n        let newLinkUUID = utils.uuidv4();\n        let totalItems = res.data.folders.length + res.data.files.length;\n        let doneItems = 0;\n        let erroredItems = 0;\n\n        const itemAdded = () => {\n          doneItems += 1;\n          createLoading.message = language.get(this.state.lang, \"folderLinkAddedItemsCount\", true, [\"__ADDED__\", \"__TOTAL__\"], [doneItems, totalItems]);\n\n          if (doneItems >= totalItems) {\n            createLoading.dismiss();\n\n            if (erroredItems > 0) {\n              console.log(\"Errored items: \" + erroredItems);\n            }\n\n            linkUUID = newLinkUUID;\n            return callback(null, {\n              linkUUID: linkUUID,\n              linkKey: key\n            });\n          }\n        };\n\n        const addItemRequest = async (data, tries, maxTries, cb) => {\n          if (tries >= maxTries) {\n            return cb(language.get(this.state.lang, \"apiRequestError\"));\n          }\n\n          try {\n            var res = await utils.apiRequest(\"POST\", \"/v1/dir/link/add\", data);\n          } catch (e) {\n            console.log(e);\n            return setTimeout(() => {\n              addItemRequest(data, tries + 1, maxTries, cb);\n            }, 1000);\n          }\n\n          return cb(null);\n        };\n\n        const addItem = async (itemType, itemToAdd) => {\n          await window.customVariables.shareItemSemaphore.acquire();\n          let itemMetadata = \"\";\n\n          if (itemType == \"file\") {\n            itemMetadata = utils.cryptoJSEncrypt(JSON.stringify({\n              name: itemToAdd.name,\n              mime: itemToAdd.mime,\n              key: itemToAdd.key,\n              size: parseInt(itemToAdd.size)\n            }), key);\n          } else {\n            itemMetadata = utils.cryptoJSEncrypt(JSON.stringify({\n              name: itemToAdd.name\n            }), key);\n          }\n\n          addItemRequest({\n            apiKey: window.customVariables.apiKey,\n            uuid: itemToAdd.uuid,\n            parent: itemToAdd.parent,\n            linkUUID: newLinkUUID,\n            type: itemType,\n            metadata: itemMetadata,\n            key: keyEnc,\n            expiration: \"never\",\n            password: \"empty\",\n            passwordHashed: utils.hashFn(\"empty\"),\n            downloadBtn: \"enable\"\n          }, 0, 32, err => {\n            window.customVariables.shareItemSemaphore.release();\n\n            if (err) {\n              console.log(err);\n              erroredItems += 1;\n            }\n\n            itemAdded();\n          });\n        };\n\n        for (let i = 0; i < res.data.folders.length; i++) {\n          let folder = res.data.folders[i];\n          await window.customVariables.decryptShareItemSemaphore.acquire();\n          addItem(\"folder\", {\n            uuid: folder.uuid,\n            parent: folder.parent,\n            name: utils.decryptCryptoJSFolderName(folder.name, this.state.userMasterKeys, folder.uuid)\n          });\n          window.customVariables.decryptShareItemSemaphore.release();\n        }\n\n        for (let i = 0; i < res.data.files.length; i++) {\n          let file = res.data.files[i];\n          await window.customVariables.decryptShareItemSemaphore.acquire();\n          let fileMetadata = utils.decryptFileMetadata(file.metadata, this.state.userMasterKeys, file.uuid);\n          addItem(\"file\", {\n            uuid: file.uuid,\n            parent: file.parent,\n            name: fileMetadata.name,\n            mime: fileMetadata.mime,\n            key: fileMetadata.key,\n            size: fileMetadata.size\n          });\n          window.customVariables.decryptShareItemSemaphore.release();\n        }\n      };\n\n      loading.dismiss();\n\n      if (type == \"enable\") {\n        if (isEdit) {\n          editFolderLink(err => {\n            if (err) {\n              return this.spawnToast(language.get(this.state.lang, \"apiRequestError\"));\n            }\n          });\n        } else {\n          createFolderLink((err, linkData) => {\n            if (err) {\n              return this.spawnToast(language.get(this.state.lang, \"apiRequestError\"));\n            }\n\n            document.getElementById(\"public-link-enabled-toggle\").checked = true;\n            document.getElementById(\"public-link-input\").value = \"https://filen.io/f/\" + linkData.linkUUID + \"#!\" + linkData.linkKey;\n            document.getElementById(\"enable-public-link-content\").style.display = \"none\";\n            document.getElementById(\"public-link-enabled-content\").style.display = \"block\";\n          });\n        }\n      } else {\n        removeFolderLink(err => {\n          if (err) {\n            return this.spawnToast(language.get(this.state.lang, \"apiRequestError\"));\n          }\n\n          document.getElementById(\"enable-public-link-content\").style.display = \"block\";\n          document.getElementById(\"public-link-enabled-content\").style.display = \"none\";\n          this.updateItemList();\n        });\n      }\n\n      return true;\n    }\n  };\n\n  window.customFunctions.copyPublicLinkToClipboard = async () => {\n    if (!Capacitor.isNative) {\n      try {\n        utils.copyTextToClipboardWeb(document.getElementById(\"public-link-input\").value);\n      } catch (e) {\n        console.log(e);\n        return this.spawnToast(language.get(this.state.lang, \"couldNotCopyToClipboard\"));\n      }\n\n      return this.spawnToast(language.get(this.state.lang, \"copiedToClipboard\"));\n    }\n\n    try {\n      let link = document.getElementById(\"public-link-input\").value;\n      await Plugins.Clipboard.write({\n        url: link\n      });\n    } catch (e) {\n      console.log(e);\n      return this.spawnToast(language.get(this.state.lang, \"couldNotCopyToClipboard\"));\n    }\n\n    return this.spawnToast(language.get(this.state.lang, \"copiedToClipboard\"));\n  };\n\n  window.customFunctions.clearThumbnailCache = async () => {\n    let alert = await alertController.create({\n      header: language.get(this.state.lang, \"settingsClearThumbnailCacheHeader\"),\n      message: language.get(this.state.lang, \"settingsClearThumbnailCacheInfo\"),\n      buttons: [{\n        text: language.get(this.state.lang, \"cancel\"),\n        role: \"cancel\",\n        handler: () => {\n          return false;\n        }\n      }, {\n        text: language.get(this.state.lang, \"alertOkButton\"),\n        handler: async () => {\n          if (!Capacitor.isNative) {\n            return alert.dismiss();\n          }\n\n          let dirObj = {\n            path: \"ThumbnailCache/\",\n            directory: FilesystemDirectory.External\n          };\n          alert.dismiss();\n\n          try {\n            await Plugins.Filesystem.rmdir({\n              path: dirObj.path,\n              directory: dirObj.directory,\n              recursive: true\n            });\n            window.customVariables.thumbnailCache = {};\n            window.customVariables.thumbnailBlobCache = {};\n            window.customVariables.lastThumbnailCacheLength = undefined;\n            window.customFunctions.saveThumbnailCache();\n          } catch (e) {\n            console.log(e);\n          }\n\n          return this.spawnToast(language.get(this.state.lang, \"settingsClearThumbnailCacheDone\"));\n        }\n      }]\n    });\n    return alert.present();\n  };\n\n  window.customFunctions.openOrderBy = async () => {\n    let alert = await alertController.create({\n      header: language.get(this.state.lang, \"orderBy\"),\n      inputs: [{\n        type: \"radio\",\n        label: language.get(this.state.lang, \"orderByName\"),\n        value: \"name\",\n        checked: window.customVariables.orderBy.indexOf(\"name\") !== -1 ? true : false\n      }, {\n        type: \"radio\",\n        label: language.get(this.state.lang, \"orderBySize\"),\n        value: \"size\",\n        checked: window.customVariables.orderBy.indexOf(\"size\") !== -1 ? true : false\n      }, {\n        type: \"radio\",\n        label: language.get(this.state.lang, \"orderByDate\"),\n        value: \"date\",\n        checked: window.customVariables.orderBy.indexOf(\"date\") !== -1 ? true : false\n      }, {\n        type: \"radio\",\n        label: language.get(this.state.lang, \"orderByType\"),\n        value: \"type\",\n        checked: window.customVariables.orderBy.indexOf(\"type\") !== -1 ? true : false\n      }],\n      buttons: [{\n        text: language.get(this.state.lang, \"cancel\"),\n        role: \"cancel\",\n        handler: () => {\n          return false;\n        }\n      }, {\n        text: language.get(this.state.lang, \"orderByReset\"),\n        handler: () => {\n          let sortedItems = utils.orderItemsByType(this.state.itemList, \"dateDesc\");\n          window.customVariables.orderBy = \"nameAsc\";\n          window.customVariables.itemList = sortedItems;\n          return this.setState({\n            itemList: sortedItems\n          }, () => {\n            this.forceUpdate();\n          });\n        }\n      }, {\n        text: language.get(this.state.lang, \"alertOkButton\"),\n        handler: async type => {\n          let alert = await alertController.create({\n            header: language.get(this.state.lang, \"orderByDirection\"),\n            inputs: [{\n              type: \"radio\",\n              label: language.get(this.state.lang, \"orderByDirectionAsc\"),\n              value: \"Asc\",\n              checked: window.customVariables.orderBy.indexOf(\"Asc\") !== -1 ? true : false\n            }, {\n              type: \"radio\",\n              label: language.get(this.state.lang, \"orderByDirectionDesc\"),\n              value: \"Desc\",\n              checked: window.customVariables.orderBy.indexOf(\"Desc\") !== -1 ? true : false\n            }],\n            buttons: [{\n              text: language.get(this.state.lang, \"cancel\"),\n              role: \"cancel\",\n              handler: () => {\n                return false;\n              }\n            }, {\n              text: language.get(this.state.lang, \"alertOkButton\"),\n              handler: direction => {\n                let typeAndDirection = type + direction;\n                console.log(typeAndDirection);\n                let sortedItems = utils.orderItemsByType(this.state.itemList, typeAndDirection);\n                window.customVariables.orderBy = typeAndDirection;\n                window.customVariables.itemList = sortedItems;\n                return this.setState({\n                  itemList: sortedItems\n                }, () => {\n                  this.forceUpdate();\n                });\n              }\n            }]\n          });\n          return alert.present();\n        }\n      }]\n    });\n    window.customFunctions.dismissPopover();\n    return alert.present();\n  };\n}","map":{"version":3,"sources":["/Users/jan/Documents/filen/app/src/components/window.js"],"names":["Capacitor","Plugins","FilesystemDirectory","modalController","popoverController","menuController","alertController","loadingController","actionSheetController","language","Ionicons","isPlatform","getPlatforms","utils","require","safeAreaInsets","windowRouter","window","onhashchange","currentHref","location","href","setState","routeEx","hash","split","state","isLoggedIn","updateItemList","foldersInRoute","slice","length","lastFolderInRoute","customVariables","cachedFolders","mainToolbarTitle","name","showMainToolbarBackButton","get","lang","setupWindowFunctions","$","undefined","jQueryScript","document","createElement","type","src","getElementsByTagName","appendChild","pdfJsScript","customFunctions","socket","socketPingInterval","itemList","cachedFiles","cachedMetadata","keyUpdateInterval","usageUpdateInterval","apiKey","uploadSemaphore","Semaphore","uploadChunkSemaphore","downloadSemaphore","downloadChunkSemaphore","shareItemSemaphore","decryptShareItemSemaphore","uploads","downloads","reloadContentAfterUploadTimeout","offlineSavedFiles","urlCreator","URL","webkitURL","currentPreviewURL","reloadAfterActionTimeout","nextNativeToastAllowed","Math","floor","Date","apiCache","selectLangInterval","stoppedUploads","stoppedDownloads","stoppedUploadsDone","stoppedDownloadsDone","lastCachedItemsLength","lastAPICacheLength","thumbnailCache","thumbnailBlobCache","currentThumbnailURL","lastThumbnailCacheLength","thumbnailSemaphore","updateItemsSemaphore","getNetworkInfoInterval","networkStatus","orderBy","getThumbnailErrors","lastGetThumbnailErrorsLength","scrollToIndex","mainSearchbarTimeout","mainSearchbarInterval","lastMainSearchbarTerm","userMasterKeys","isGettingPreviewData","stopGettingPreviewData","cachedAPIItemListRequests","deviceHeightAndWidthInterval","clearInterval","setInterval","getElementById","term","value","trim","clearTimeout","setTimeout","setMainSearchTerm","updateHeightAndWidthState","windowHeight","innerHeight","windowWidth","innerWidth","addEventListener","onclick","e","togglePreviewHeader","target","innerHTML","indexOf","getElementsByClassName","header","style","display","getNetworkInfo","Network","getStatus","console","log","saveOfflineSavedFiles","Storage","set","key","JSON","stringify","saveGetThumbnailErrors","saveAPICache","saveThumbnailCache","saveCachedItems","dismissActionSheet","all","dismiss","actionSheet","getTop","dismissPopover","popover","dismissModal","modal","dismissLoader","loader","dismissAlert","alert","selectAllItems","items","i","item","selected","push","selectedItems","unselectAllItems","refreshItemList","hideSidebarMenu","mainMenu","close","openRegisterModal","showRegister","doLogout","showLogin","doLogin","email","password","twoFactorKey","create","subHeader","message","buttons","toUpperCase","present","loading","res","apiRequest","status","data","hashFn","doRegister","passwordRepeat","toLowerCase","openSettingsModal","setLang","openLanguageModal","appLang","appDarkMode","darkMode","modalId","generateRandomClassName","languagesHTML","langList","list","prop","customElements","define","ModalContent","HTMLElement","connectedCallback","top","arrowBack","component","swipeToClose","showBackdrop","backdropDismiss","cssClass","openEncryptionModal","openWebsiteModal","text","icon","globe","handler","open","grid","role","openHelpModal","btns","helpBuoyOutline","informationCircle","informationCircleOutline","queueFileUpload","queueFileDownload","openItemActionSheetFromJSON","itemJSON","parse","atob","spawnItemActionSheet","moveSelectedItems","trashSelectedItems","restoreSelectedItems","removeSelectedItemsFromSharedIn","stopSharingSelectedItems","downloadSelectedItems","storeSelectedItemsOffline","shareSelectedItems","settingsToggleDarkMode","checked","loginToggleDarkMode","saveSettings","newSettings","settings","toggleOnlyWifi","newVal","onlyWifi","logoutUser","remove","emptyTrash","userAPIKey","spawnToast","changeItemColor","color","uuid","editItemPublicLink","isEdit","currentLinkUUID","linkUUID","uuidv4","expires","downloadBtn","fileUUID","expiration","passwordHashed","removeFolderLink","callback","removeLoading","editFolderLink","editLoading","createFolderLink","createLoading","generateRandomString","keyEnc","cryptoJSEncrypt","newLinkUUID","totalItems","folders","files","doneItems","erroredItems","itemAdded","linkKey","addItemRequest","tries","maxTries","cb","addItem","itemType","itemToAdd","acquire","itemMetadata","mime","size","parseInt","parent","metadata","err","release","folder","decryptCryptoJSFolderName","file","fileMetadata","decryptFileMetadata","linkData","copyPublicLinkToClipboard","isNative","copyTextToClipboardWeb","link","Clipboard","write","url","clearThumbnailCache","dirObj","path","directory","External","Filesystem","rmdir","recursive","openOrderBy","inputs","label","sortedItems","orderItemsByType","forceUpdate","direction","typeAndDirection"],"mappings":"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","sourcesContent":["import { Capacitor, Plugins, FilesystemDirectory } from \"@capacitor/core\"\r\nimport { modalController, popoverController, menuController, alertController, loadingController, actionSheetController } from \"@ionic/core\"\r\nimport * as language from \"../utils/language\"\r\nimport * as Ionicons from 'ionicons/icons'\r\nimport { isPlatform, getPlatforms } from \"@ionic/react\"\r\n\r\nconst utils = require(\"../utils/utils\")\r\nconst safeAreaInsets = require('safe-area-insets')\r\n\r\nexport function windowRouter(){\r\n    window.onhashchange = async () => {\r\n        if(window.currentHref !== window.location.href){\r\n            window.currentHref = window.location.href\r\n\r\n            this.setState({\r\n                currentHref: window.currentHref\r\n            })\r\n\r\n            let routeEx = window.location.hash.split(\"/\")\r\n\r\n            if(this.state.isLoggedIn){\r\n                if(routeEx[1] == \"base\" || routeEx[1] == \"shared-in\" || routeEx[1] == \"shared-out\" || routeEx[1] == \"trash\" || routeEx[1] == \"links\"){\r\n                    await this.updateItemList()\r\n    \r\n                    let foldersInRoute = routeEx.slice(2)\r\n    \r\n                    if(foldersInRoute.length > 0){\r\n                        let lastFolderInRoute = foldersInRoute[foldersInRoute.length - 1]\r\n    \r\n                        if(window.customVariables.cachedFolders[lastFolderInRoute]){\r\n                            this.setState({\r\n                                mainToolbarTitle: window.customVariables.cachedFolders[lastFolderInRoute].name,\r\n                                showMainToolbarBackButton: true\r\n                            })\r\n                        }\r\n                        else{\r\n                            this.setState({\r\n                                mainToolbarTitle: language.get(this.state.lang, \"myCloud\"),\r\n                                showMainToolbarBackButton: false\r\n                            })\r\n                        }\r\n                    }\r\n                    else{\r\n                        if(routeEx[1] == \"shared-in\"){\r\n                            this.setState({\r\n                                mainToolbarTitle: language.get(this.state.lang, \"sharedInTitle\"),\r\n                                showMainToolbarBackButton: false\r\n                            })\r\n                        }\r\n                        else if(routeEx[1] == \"shared-out\"){\r\n                            this.setState({\r\n                                mainToolbarTitle: language.get(this.state.lang, \"sharedOutTitle\"),\r\n                                showMainToolbarBackButton: false\r\n                            })\r\n                        }\r\n                        else if(routeEx[1] == \"trash\"){\r\n                            this.setState({\r\n                                mainToolbarTitle: language.get(this.state.lang, \"trashTitle\"),\r\n                                showMainToolbarBackButton: false\r\n                            })\r\n                        }\r\n                        else if(routeEx[1] == \"links\"){\r\n                            this.setState({\r\n                                mainToolbarTitle: language.get(this.state.lang, \"linksTitle\"),\r\n                                showMainToolbarBackButton: false\r\n                            })\r\n                        }\r\n                        else{\r\n                            this.setState({\r\n                                mainToolbarTitle: language.get(this.state.lang, \"myCloud\"),\r\n                                showMainToolbarBackButton: false\r\n                            })\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nexport function setupWindowFunctions(){\r\n    window.$ = undefined\r\n\r\n    let jQueryScript = document.createElement(\"script\")\r\n\r\n    jQueryScript.type = \"text/javascript\"\r\n    jQueryScript.src = \"assets/jquery.js\"\r\n\r\n    document.getElementsByTagName(\"head\")[0].appendChild(jQueryScript)\r\n\r\n    let pdfJsScript = document.createElement(\"script\")\r\n\r\n    pdfJsScript.type = \"text/javascript\"\r\n    pdfJsScript.src = \"assets/pdf/build/pdf.js\"\r\n\r\n    document.getElementsByTagName(\"head\")[0].appendChild(pdfJsScript)\r\n\r\n    window.customFunctions = {}\r\n    window.customVariables = {}\r\n\r\n    window.customVariables.socket = undefined\r\n    window.customVariables.socketPingInterval = undefined\r\n    window.customVariables.itemList = []\r\n    window.customVariables.lang = this.state.lang\r\n    window.customVariables.cachedFolders = {}\r\n    window.customVariables.cachedFiles = {}\r\n    window.customVariables.cachedMetadata = {}\r\n    window.customVariables.keyUpdateInterval = undefined\r\n    window.customVariables.usageUpdateInterval = undefined\r\n    window.customVariables.apiKey = \"\"\r\n    window.customVariables.uploadSemaphore = new utils.Semaphore(3)\r\n    window.customVariables.uploadChunkSemaphore = new utils.Semaphore(5)\r\n    window.customVariables.downloadSemaphore = new utils.Semaphore(5)\r\n    window.customVariables.downloadChunkSemaphore = new utils.Semaphore(30)\r\n    window.customVariables.shareItemSemaphore = new utils.Semaphore(4)\r\n    window.customVariables.decryptShareItemSemaphore = new utils.Semaphore(128)\r\n    window.customVariables.uploads = {}\r\n    window.customVariables.downloads = {}\r\n    window.customVariables.reloadContentAfterUploadTimeout = undefined\r\n    window.customVariables.offlineSavedFiles = {}\r\n    window.customVariables.urlCreator = window.URL || window.webkitURL\r\n    window.customVariables.currentPreviewURL = undefined\r\n    window.customVariables.reloadAfterActionTimeout = undefined\r\n    window.customVariables.nextNativeToastAllowed = Math.floor((+new Date()) / 1000)\r\n    window.customVariables.apiCache = {}\r\n    window.customVariables.selectLangInterval = undefined\r\n    window.customVariables.stoppedUploads = {}\r\n    window.customVariables.stoppedDownloads = {}\r\n    window.customVariables.stoppedUploadsDone = {}\r\n    window.customVariables.stoppedDownloadsDone = {}\r\n    window.customVariables.lastCachedItemsLength = undefined\r\n    window.customVariables.lastAPICacheLength = undefined\r\n    window.customVariables.thumbnailCache = {}\r\n    window.customVariables.thumbnailBlobCache = {}\r\n    window.customVariables.currentThumbnailURL = undefined\r\n    window.customVariables.lastThumbnailCacheLength = undefined\r\n    window.customVariables.thumbnailSemaphore = new utils.Semaphore(2)\r\n    window.customVariables.updateItemsSemaphore = new utils.Semaphore(1)\r\n    window.customVariables.getNetworkInfoInterval = undefined\r\n    window.customVariables.networkStatus = undefined\r\n    window.customVariables.orderBy = \"nameAsc\"\r\n    window.customVariables.getThumbnailErrors = {}\r\n    window.customVariables.lastGetThumbnailErrorsLength = undefined\r\n    window.customVariables.scrollToIndex = {}\r\n    window.customVariables.mainSearchbarTimeout = undefined\r\n    window.customVariables.mainSearchbarInterval = undefined\r\n    window.customVariables.lastMainSearchbarTerm = \"\"\r\n    window.customVariables.userMasterKeys = []\r\n    window.customVariables.isGettingPreviewData = false\r\n    window.customVariables.stopGettingPreviewData = false\r\n    window.customVariables.cachedAPIItemListRequests = {}\r\n    window.customVariables.deviceHeightAndWidthInterval = undefined\r\n\r\n    clearInterval(window.customVariables.mainSearchbarInterval)\r\n\r\n    window.customVariables.mainSearchbarInterval = setInterval(() => {\r\n        if(document.getElementById(\"main-searchbar\") !== null){\r\n            let term = document.getElementById(\"main-searchbar\").value.trim()\r\n\r\n            if(typeof term == \"string\"){\r\n                if(term.length > 0){\r\n                    if(term !== window.customVariables.lastMainSearchbarTerm){\r\n                        window.customVariables.lastMainSearchbarTerm = term\r\n\r\n                        clearTimeout(window.customVariables.mainSearchbarTimeout)\r\n    \r\n                        window.customVariables.mainSearchbarTimeout = setTimeout(() => {\r\n                            this.setMainSearchTerm(term)\r\n                        }, 250)\r\n                    }\r\n                }\r\n                else{\r\n                    clearTimeout(window.customVariables.mainSearchbarTimeout)\r\n\r\n                    this.setMainSearchTerm(\"\")\r\n                }\r\n            }\r\n            else{\r\n                clearTimeout(window.customVariables.mainSearchbarTimeout)\r\n\r\n                this.setMainSearchTerm(\"\")\r\n            }\r\n        }\r\n        else{\r\n            clearTimeout(window.customVariables.mainSearchbarTimeout)\r\n        }\r\n    }, 100)\r\n\r\n    const updateHeightAndWidthState = () => {\r\n        this.setState({\r\n            windowHeight: window.innerHeight,\r\n            windowWidth: window.innerWidth\r\n        })\r\n    }\r\n\r\n    clearInterval(window.customVariables.deviceHeightAndWidthInterval)\r\n\r\n    window.customVariables.deviceHeightAndWidthInterval = setInterval(() => {\r\n        updateHeightAndWidthState()\r\n    }, 250)\r\n\r\n    window.addEventListener(\"orientationchange\", () => {\r\n        updateHeightAndWidthState()\r\n    }, false)\r\n\r\n    window.addEventListener(\"resize\", function() {\r\n        updateHeightAndWidthState()\r\n    }, false)\r\n\r\n    document.onclick = (e) => {\r\n        return window.customFunctions.togglePreviewHeader(e)\r\n    }\r\n\r\n    window.customFunctions.isPlatform = isPlatform\r\n    window.customFunctions.safeAreaInsets = safeAreaInsets\r\n\r\n    window.customFunctions.togglePreviewHeader = (e) => {\r\n        if(typeof e.target == \"undefined\"){\r\n            return\r\n        }\r\n\r\n        if(e.target.innerHTML.indexOf(\"<ion-icon\") !== -1){\r\n            return false\r\n        }\r\n\r\n        if(document.getElementsByClassName(\"preview-header-hidden\").length > 0){\r\n            let header = document.getElementsByClassName(\"preview-header-hidden\")[0]\r\n\r\n            if(header.style.display == \"none\"){\r\n                header.style.display = \"block\"\r\n            }\r\n            else{\r\n                header.style.display = \"none\"\r\n            }\r\n        }\r\n    }\r\n\r\n    window.customFunctions.getNetworkInfo = async () => {\r\n        try{\r\n            window.customVariables.networkStatus = await Plugins.Network.getStatus()\r\n        }\r\n        catch(e){\r\n            console.log(e)\r\n        }\r\n    }\r\n\r\n    window.customFunctions.saveOfflineSavedFiles = async () => {\r\n        try{\r\n            await Plugins.Storage.set({\r\n                key: \"offlineSavedFiles\",\r\n                value: JSON.stringify(window.customVariables.offlineSavedFiles)\r\n            })\r\n        }\r\n        catch(e){\r\n            console.log(e)\r\n        }\r\n    }\r\n\r\n    window.customFunctions.saveGetThumbnailErrors = async () => {\r\n        if(typeof window.customVariables.lastGetThumbnailErrorsLength !== \"undefined\"){\r\n            let length = JSON.stringify(window.customVariables.getThumbnailErrors)\r\n\r\n            length = length.length\r\n\r\n            if(length == window.customVariables.lastGetThumbnailErrorsLength){\r\n                return false\r\n            }\r\n            else{\r\n                window.customVariables.lastGetThumbnailErrorsLength = length\r\n            }\r\n        }\r\n\r\n        try{\r\n            await Plugins.Storage.set({\r\n                key: \"getThumbnailErrors\",\r\n                value: JSON.stringify(window.customVariables.getThumbnailErrors)\r\n            })\r\n        }\r\n        catch(e){\r\n            console.log(e)\r\n        }\r\n    }\r\n\r\n    window.customFunctions.saveAPICache = async () => {\r\n        if(typeof window.customVariables.lastAPICacheLength !== \"undefined\"){\r\n            let length = JSON.stringify(window.customVariables.apiCache)\r\n\r\n            length = length.length\r\n\r\n            if(length == window.customVariables.lastAPICacheLength){\r\n                return false\r\n            }\r\n            else{\r\n                window.customVariables.lastAPICacheLength = length\r\n            }\r\n        }\r\n\r\n        try{\r\n            await Plugins.Storage.set({\r\n                key: \"apiCache\",\r\n                value: JSON.stringify(window.customVariables.apiCache)\r\n            })\r\n        }\r\n        catch(e){\r\n            console.log(e)\r\n        }\r\n    }\r\n\r\n    window.customFunctions.saveThumbnailCache = async () => {\r\n        if(typeof window.customVariables.lastThumbnailCacheLength !== \"undefined\"){\r\n            let length = JSON.stringify(window.customVariables.thumbnailCache)\r\n\r\n            length = length.length\r\n\r\n            if(length == window.customVariables.lastThumbnailCacheLength){\r\n                return false\r\n            }\r\n            else{\r\n                window.customVariables.lastThumbnailCacheLength = length\r\n            }\r\n        }\r\n\r\n        try{\r\n            await Plugins.Storage.set({\r\n                key: \"thumbnailCache\",\r\n                value: JSON.stringify(window.customVariables.thumbnailCache)\r\n            })\r\n        }\r\n        catch(e){\r\n            console.log(e)\r\n        }\r\n    }\r\n\r\n    window.customFunctions.saveCachedItems = async () => {\r\n        if(typeof window.customVariables.lastCachedItemsLength !== \"undefined\"){\r\n            let length = JSON.stringify(window.customVariables.cachedFiles) + JSON.stringify(window.customVariables.cachedFolders)\r\n\r\n            length = length.length\r\n\r\n            if(length == window.customVariables.lastCachedItemsLength){\r\n                return false\r\n            }\r\n            else{\r\n                window.customVariables.lastCachedItemsLength = length\r\n            }\r\n        }\r\n\r\n        try{\r\n            await Plugins.Storage.set({\r\n                key: \"cachedFiles\",\r\n                value: JSON.stringify(window.customVariables.cachedFiles)\r\n            })\r\n\r\n            await Plugins.Storage.set({\r\n                key: \"cachedFolders\",\r\n                value: JSON.stringify(window.customVariables.cachedFolders)\r\n            })\r\n        }\r\n        catch(e){\r\n            console.log(e)\r\n        }\r\n    }\r\n\r\n    window.customFunctions.dismissActionSheet = async (all = false) => {\r\n        if(all){\r\n            try{\r\n                await actionSheetController.dismiss()\r\n\r\n                return true\r\n            }\r\n            catch(e){\r\n                return console.log(e)\r\n            }\r\n        }\r\n\r\n        try{\r\n            let actionSheet = await actionSheetController.getTop()\r\n\r\n            if(typeof actionSheet !== \"undefined\"){\r\n                return actionSheet.dismiss()\r\n            }\r\n            \r\n            return true\r\n        }\r\n        catch(e){\r\n            return console.log(e)\r\n        }\r\n    }\r\n\r\n    window.customFunctions.dismissPopover = async (all = false) => {\r\n        if(all){\r\n            try{\r\n                await popoverController.dismiss()\r\n\r\n                return true\r\n            }\r\n            catch(e){\r\n                return console.log(e)\r\n            }\r\n        }\r\n\r\n        try{\r\n            let popover = await popoverController.getTop()\r\n\r\n            if(typeof popover !== \"undefined\"){\r\n                return popover.dismiss()\r\n            }\r\n\r\n            return true\r\n        }\r\n        catch(e){\r\n            return console.log(e)\r\n        }\r\n    }\r\n\r\n    window.customFunctions.dismissModal = async (all = false) => {\r\n        if(all){\r\n            try{\r\n                await modalController.dismiss()\r\n\r\n                return true\r\n            }\r\n            catch(e){\r\n                return console.log(e)\r\n            }\r\n        }\r\n\r\n        try{\r\n            let modal = await modalController.getTop()\r\n\r\n            if(typeof modal !== \"undefined\"){\r\n                return modal.dismiss()\r\n            }\r\n\r\n            return true\r\n        }\r\n        catch(e){\r\n            return console.log(e)\r\n        }\r\n    }\r\n\r\n    window.customFunctions.dismissLoader = async (all = false) => {\r\n        if(all){\r\n            try{\r\n                await loadingController.dismiss()\r\n\r\n                return true\r\n            }\r\n            catch(e){\r\n                return console.log(e)\r\n            }\r\n        }\r\n\r\n        try{\r\n            let loader = await loadingController.getTop()\r\n\r\n            if(typeof loader !== \"undefined\"){\r\n                return loader.dismiss()\r\n            }\r\n\r\n            return true\r\n        }\r\n        catch(e){\r\n            return console.log(e)\r\n        }\r\n    }\r\n\r\n    window.customFunctions.dismissAlert = async (all = false) => {\r\n        if(all){\r\n            try{\r\n                await alertController.dismiss()\r\n\r\n                return true\r\n            }\r\n            catch(e){\r\n                return console.log(e)\r\n            }\r\n        }\r\n\r\n        try{\r\n            let alert = await alertController.getTop()\r\n\r\n            if(typeof alert !== \"undefined\"){\r\n                return alert.dismiss()\r\n            }\r\n\r\n            return true\r\n        }\r\n        catch(e){\r\n            return console.log(e)\r\n        }\r\n    }\r\n\r\n    window.customFunctions.selectAllItems = () => {\r\n        let items = []\r\n\r\n        for(let i = 0; i < this.state.itemList.length; i++){\r\n            let item = this.state.itemList[i]\r\n\r\n            item.selected = true\r\n\r\n            items.push(item)\r\n        }\r\n\r\n        this.setState({\r\n            itemList: items,\r\n            selectedItems: items.length\r\n        })\r\n\r\n        return window.customFunctions.dismissPopover()\r\n    }\r\n\r\n    window.customFunctions.unselectAllItems = () => {\r\n        let items = []\r\n\r\n        for(let i = 0; i < this.state.itemList.length; i++){\r\n            let item = this.state.itemList[i]\r\n\r\n            item.selected = false\r\n\r\n            items.push(item)\r\n        }\r\n\r\n        this.setState({\r\n            itemList: items,\r\n            selectedItems: 0\r\n        })\r\n\r\n        return window.customFunctions.dismissPopover()\r\n    }\r\n\r\n    window.customFunctions.refreshItemList = () => {\r\n        this.updateItemList()\r\n\r\n        return window.customFunctions.dismissPopover()\r\n    }\r\n\r\n    window.customFunctions.hideSidebarMenu = async () => {\r\n        let mainMenu = await menuController.get(\"sideBarMenu\")\r\n\r\n        return mainMenu.close()\r\n    }\r\n\r\n    window.customFunctions.openRegisterModal = () => {\r\n        return this.showRegister()\r\n    }\r\n\r\n    window.customFunctions.doLogout = async () => {\r\n        await Plugins.Storage.set({ key: \"isLoggedIn\", value: \"false\" })\r\n        await Plugins.Storage.set({ key: \"userAPIKey\", value: \"\" })\r\n        await Plugins.Storage.set({ key: \"userEmail\", value: \"\" })\r\n        await Plugins.Storage.set({ key: \"userMasterKeys\", value: JSON.stringify([]) })\r\n        await Plugins.Storage.set({ key: \"userPublicKey\", value: \"\" })\r\n        await Plugins.Storage.set({ key: \"userPrivateKey\", value: \"\" })\r\n\r\n        this.setState({ isLoggedIn: false })\r\n\r\n        return this.showLogin()\r\n    }\r\n\r\n    window.customFunctions.doLogin = async () => {\r\n        let email = document.getElementById(\"login-email\").value\r\n        let password = document.getElementById(\"login-password\").value\r\n        let twoFactorKey = document.getElementById(\"login-2fa\").value\r\n\r\n        if(!email || !password){\r\n            let alert = await alertController.create({\r\n                header: \"\",\r\n                subHeader: \"\",\r\n                message: language.get(this.state.lang, \"loginInvalidInputs\"),\r\n                buttons: [language.get(this.state.lang, \"alertOkButton\").toUpperCase()]\r\n            })\r\n\r\n            return alert.present()\r\n        }\r\n\r\n        if(twoFactorKey.length == 0){\r\n            twoFactorKey = \"XXXXXX\"\r\n        }\r\n\r\n        let loading = await loadingController.create({\r\n            message: \"\"\r\n        })\r\n    \r\n        loading.present()\r\n\r\n        try{\r\n            var res = await utils.apiRequest(\"POST\", \"/v1/login\", {\r\n                email,\r\n                password,\r\n                twoFactorKey\r\n            })\r\n        }\r\n        catch(e){\r\n            document.getElementById(\"login-password\").value = \"\"\r\n            document.getElementById(\"login-2fa\").value = \"\"\r\n\r\n            console.log(e)\r\n\r\n            window.customFunctions.dismissLoader()\r\n\r\n            let alert = await alertController.create({\r\n                header: \"\",\r\n                subHeader: \"\",\r\n                message: language.get(this.state.lang, \"apiRequestError\"),\r\n                buttons: [language.get(this.state.lang, \"alertOkButton\").toUpperCase()]\r\n            })\r\n\r\n            return alert.present()\r\n        }\r\n\r\n        if(!res.status){\r\n            if(res.message == \"Please enter your Two Factor Authentication code.\"){\r\n                window.customFunctions.dismissLoader()\r\n\r\n                document.getElementById(\"login-2fa-container\").style.display = \"block\"\r\n\r\n                let alert = await alertController.create({\r\n                    header: \"\",\r\n                    subHeader: \"\",\r\n                    message: language.get(this.state.lang, \"loginWith2FACode\"),\r\n                    buttons: [language.get(this.state.lang, \"alertOkButton\").toUpperCase()]\r\n                })\r\n\r\n                return alert.present()\r\n            }\r\n            else{\r\n                document.getElementById(\"login-password\").value = \"\"\r\n                document.getElementById(\"login-2fa\").value = \"\"\r\n\r\n                window.customFunctions.dismissLoader()\r\n\r\n                if(res.message == \"Account not yet activated.\"){\r\n                    let alert = await alertController.create({\r\n                        header: \"\",\r\n                        subHeader: \"\",\r\n                        message: language.get(this.state.lang, \"loginAccountNotActivated\"),\r\n                        buttons: [language.get(this.state.lang, \"alertOkButton\").toUpperCase()]\r\n                    })\r\n        \r\n                    return alert.present()\r\n                }\r\n                else if(res.message == \"Account not found.\"){\r\n                    let alert = await alertController.create({\r\n                        header: \"\",\r\n                        subHeader: \"\",\r\n                        message: language.get(this.state.lang, \"loginAccountNotFound\"),\r\n                        buttons: [language.get(this.state.lang, \"alertOkButton\").toUpperCase()]\r\n                    })\r\n        \r\n                    return alert.present()\r\n                }\r\n\r\n                let alert = await alertController.create({\r\n                    header: \"\",\r\n                    subHeader: \"\",\r\n                    message: language.get(this.state.lang, \"loginWrongCredentials\"),\r\n                    buttons: [language.get(this.state.lang, \"alertOkButton\").toUpperCase()]\r\n                })\r\n\r\n                return alert.present()\r\n            }\r\n        }\r\n\r\n        await Plugins.Storage.set({ key: \"isLoggedIn\", value: \"true\" })\r\n        await Plugins.Storage.set({ key: \"userAPIKey\", value: res.data.apiKey })\r\n        await Plugins.Storage.set({ key: \"userEmail\", value: email })\r\n        await Plugins.Storage.set({ key: \"userMasterKeys\", value: JSON.stringify([utils.hashFn(password)]) })\r\n\r\n        /*window.customFunctions.dismissLoader(true)\r\n        window.customFunctions.dismissModal(true)\r\n        window.customFunctions.dismissLoader()\r\n\r\n        document.getElementById(\"login-email\").value = \"\"\r\n        document.getElementById(\"login-password\").value = \"\"\r\n        document.getElementById(\"login-2fa\").value = \"\"*/\r\n\r\n        return document.location.href = \"index.html\"\r\n    }\r\n\r\n    window.customFunctions.doRegister = async () => {\r\n        let email = document.getElementById(\"register-email\").value\r\n        let password = document.getElementById(\"register-password\").value\r\n        let passwordRepeat = document.getElementById(\"register-password-repeat\").value\r\n\r\n        if(!email || !password || !passwordRepeat){\r\n            let alert = await alertController.create({\r\n                header: \"\",\r\n                subHeader: \"\",\r\n                message: language.get(this.state.lang, \"registerInvalidInputs\"),\r\n                buttons: [language.get(this.state.lang, \"alertOkButton\").toUpperCase()]\r\n            })\r\n\r\n            return alert.present()\r\n        }\r\n\r\n        let loading = await loadingController.create({\r\n            message: \"\"\r\n        })\r\n    \r\n        loading.present()\r\n\r\n        try{\r\n            var res = await utils.apiRequest(\"POST\", \"/v1/register\", {\r\n                email,\r\n                password,\r\n                passwordRepeat\r\n            })\r\n        }\r\n        catch(e){\r\n            document.getElementById(\"register-password\").value = \"\"\r\n            document.getElementById(\"register-password-repeat\").value = \"\"\r\n\r\n            console.log(e)\r\n\r\n            window.customFunctions.dismissLoader()\r\n\r\n            let alert = await alertController.create({\r\n                header: \"\",\r\n                subHeader: \"\",\r\n                message: language.get(this.state.lang, \"apiRequestError\"),\r\n                buttons: [language.get(this.state.lang, \"alertOkButton\").toUpperCase()]\r\n            })\r\n\r\n            return alert.present()\r\n        }\r\n\r\n        if(!res.status){\r\n            document.getElementById(\"register-password\").value = \"\"\r\n            document.getElementById(\"register-password-repeat\").value = \"\"\r\n\r\n            window.customFunctions.dismissLoader()\r\n\r\n            let message = \"\"\r\n\r\n            if(res.message.toLowerCase().indexOf(\"invalid email\") !== -1 || res.message.toLowerCase().indexOf(\"invalid password\") !== -1 || res.message.toLowerCase().indexOf(\"invalid email\") !== -1){\r\n                message = language.get(this.state.lang, \"registerInvalidFields\")\r\n            }\r\n            else if(res.message.toLowerCase().indexOf(\"your password needs to be at least 10 characters long\") !== -1){\r\n                message = language.get(this.state.lang, \"registerPasswordAtLeast10Chars\")\r\n            }\r\n            else if(res.message.toLowerCase().indexOf(\"passwords do not match\") !== -1){\r\n                message = language.get(this.state.lang, \"registerPasswordsDoNotMatch\")\r\n            }\r\n            else if(res.message.toLowerCase().indexOf(\"invalid email\") !== -1){\r\n                message = language.get(this.state.lang, \"registerInvalidEmail\")\r\n            }\r\n            else if(res.message.toLowerCase().indexOf(\"database error\") !== -1){\r\n                message = language.get(this.state.lang, \"apiRequestError\")\r\n            }\r\n            else if(res.message.toLowerCase().indexOf(\"this email is already registered\") !== -1){\r\n                message = language.get(this.state.lang, \"registerEmailAlreadyRegistered\")\r\n            }\r\n            else if(res.message.toLowerCase().indexOf(\"we could not send an email at this time, please try again later\") !== -1){\r\n                message = language.get(this.state.lang, \"registerCouldNotSendEmail\")\r\n            }\r\n\r\n            let alert = await alertController.create({\r\n                header: \"\",\r\n                subHeader: \"\",\r\n                message: message,\r\n                buttons: [language.get(this.state.lang, \"alertOkButton\").toUpperCase()]\r\n            })\r\n\r\n            return alert.present()\r\n        }\r\n\r\n        document.getElementById(\"register-email\").value = \"\"\r\n        document.getElementById(\"register-password\").value = \"\"\r\n        document.getElementById(\"register-password-repeat\").value = \"\"\r\n\r\n        window.customFunctions.dismissLoader()\r\n\r\n        let alert = await alertController.create({\r\n            header: \"\",\r\n            subHeader: \"\",\r\n            message: language.get(this.state.lang, \"registerSuccess\"),\r\n            buttons: [language.get(this.state.lang, \"alertOkButton\").toUpperCase()]\r\n        })\r\n\r\n        return alert.present()\r\n    }\r\n\r\n    window.customFunctions.openSettingsModal = async () => {\r\n        return this.openSettingsModal()\r\n    }\r\n\r\n    window.customFunctions.setLang = async (lang = \"en\") => {\r\n        await Plugins.Storage.set({ key: \"lang\", value: lang })\r\n\r\n        return document.location.href = \"index.html\"\r\n    }\r\n\r\n    window.customFunctions.openLanguageModal = async () => {\r\n        let appLang = this.state.lang\r\n        let appDarkMode = this.state.darkMode\r\n        let modalId = \"language-modal-\" + utils.generateRandomClassName()\r\n\r\n        let languagesHTML = \"\"\r\n        let langList = language.list()\r\n\r\n        for(let prop in langList){\r\n            languagesHTML += `\r\n                <ion-item lines=\"none\" onClick=\"window.customFunctions.setLang('` + prop + `')\" button>\r\n                    <ion-label>` + language.name(prop) + `</ion-label>\r\n                    <ion-radio slot=\"end\" value=\"` + prop + `\"></ion-radio>\r\n                </ion-item>\r\n            `\r\n        }\r\n\r\n        customElements.define(modalId, class ModalContent extends HTMLElement {\r\n            connectedCallback(){\r\n                this.innerHTML = `\r\n                    <ion-header style=\"margin-top: ` + (isPlatform(\"ipad\") ? safeAreaInsets.top : 0) + `px;\">\r\n                        <ion-toolbar>\r\n                            <ion-buttons slot=\"start\">\r\n                                <ion-button onClick=\"window.customFunctions.dismissModal()\">\r\n                                    <ion-icon slot=\"icon-only\" icon=\"` + Ionicons.arrowBack + `\"></ion-icon>\r\n                                </ion-button>\r\n                            </ion-buttons>\r\n                            <ion-title>\r\n                                ` + language.get(appLang, \"settingsLanguage\") + `\r\n                            </ion-title>\r\n                        </ion-toolbar>\r\n                    </ion-header>\r\n                    <ion-content style=\"--background: ` + (appDarkMode ? \"#1E1E1E\" : \"white\") + `\" fullscreen>\r\n                        <ion-list>\r\n                            <ion-radio-group value=\"` + appLang + `\">\r\n                                ` + languagesHTML + `\r\n                            </ion-radio-group>\r\n                        </ion-list>\r\n                    </ion-content>\r\n                `\r\n            }\r\n        })\r\n\r\n        let modal = await modalController.create({\r\n            component: modalId,\r\n            swipeToClose: true,\r\n            showBackdrop: false,\r\n            backdropDismiss: false,\r\n            cssClass: \"modal-fullscreen\"\r\n        })\r\n\r\n        return modal.present()\r\n    }\r\n\r\n    window.customFunctions.openEncryptionModal = async () => {\r\n        let appLang = this.state.lang\r\n        let appDarkMode = this.state.darkMode\r\n        let modalId = \"encryption-modal-\" + utils.generateRandomClassName()\r\n\r\n        customElements.define(modalId, class ModalContent extends HTMLElement {\r\n            connectedCallback(){\r\n                this.innerHTML = `\r\n                    <ion-header style=\"margin-top: ` + (isPlatform(\"ipad\") ? safeAreaInsets.top : 0) + `px;\">\r\n                        <ion-toolbar>\r\n                            <ion-buttons slot=\"start\">\r\n                                <ion-button onClick=\"window.customFunctions.dismissModal()\">\r\n                                    <ion-icon slot=\"icon-only\" icon=\"` + Ionicons.arrowBack + `\"></ion-icon>\r\n                                </ion-button>\r\n                            </ion-buttons>\r\n                            <ion-title>\r\n                                ` + language.get(appLang, \"encryption\") + `\r\n                            </ion-title>\r\n                        </ion-toolbar>\r\n                    </ion-header>\r\n                    <ion-content style=\"--background: ` + (appDarkMode ? \"#1E1E1E\" : \"white\") + `\" fullscreen>\r\n                        <ion-list>\r\n                            <ion-item-divider style=\"--background: ` + (appDarkMode ? \"#1E1E1E\" : \"white\") + `\">\r\n                                <ion-label>\r\n                                    ` + language.get(appLang, \"encryptionModalHeader\") + `\r\n                                </ion-label>\r\n                            </ion-item-divider>\r\n                            <ion-item lines=\"none\" style=\"padding-top: 10px;\">\r\n                                ` + language.get(appLang, \"encryptionModalFirstText\") + `\r\n                            </ion-item>\r\n                            <ion-item-divider style=\"padding-top: 15px; --background: ` + (appDarkMode ? \"#1E1E1E\" : \"white\") + `\">\r\n                                <ion-label>\r\n                                    ` + language.get(appLang, \"encryptionModalHeaderHowItWorks\") + `\r\n                                </ion-label>\r\n                            </ion-item-divider>\r\n                            <ion-item lines=\"none\" style=\"padding-top: 10px;\">\r\n                                ` + language.get(appLang, \"encryptionModalHowItWorksText\") + `\r\n                            </ion-item>\r\n                        </ion-list>\r\n                    </ion-content>\r\n                `\r\n            }\r\n        })\r\n\r\n        let modal = await modalController.create({\r\n            component: modalId,\r\n            swipeToClose: true,\r\n            showBackdrop: false,\r\n            backdropDismiss: false,\r\n            cssClass: \"modal-fullscreen\"\r\n        })\r\n\r\n        return modal.present()\r\n    }\r\n\r\n    window.customFunctions.openWebsiteModal = async () => {\r\n        let actionSheet = await actionSheetController.create({\r\n            header: language.get(this.state.lang, \"website\"),\r\n            buttons: [\r\n                {\r\n                    text: language.get(this.state.lang, \"website\"),\r\n                    icon: Ionicons.globe,\r\n                    handler: () => {\r\n                        window.open(\"https://filen.io/\", \"_system\")\r\n\r\n                        return false\r\n                    }\r\n                },\r\n                {\r\n                    text: language.get(this.state.lang, \"onlineFM\"),\r\n                    icon: Ionicons.grid,\r\n                    handler: () => {\r\n                        window.open(\"https://filen.io/my-account/file-manager/default\", \"_system\")\r\n\r\n                        return false\r\n                    }\r\n                },\r\n                {\r\n                    text: language.get(this.state.lang, \"cancel\"),\r\n                    icon: \"close\",\r\n                    role: \"cancel\"\r\n                }\r\n            ]\r\n        })\r\n\r\n        return actionSheet.present()\r\n    }\r\n\r\n    window.customFunctions.openHelpModal = async () => {\r\n        let btns = [\r\n            {\r\n                text: language.get(this.state.lang, \"support\"),\r\n                icon: Ionicons.helpBuoyOutline,\r\n                handler: () => {\r\n                    window.open(\"https://support.filen.io/\", \"_system\")\r\n\r\n                    return false\r\n                }\r\n            },\r\n            {\r\n                text: language.get(this.state.lang, \"faq\"),\r\n                icon: Ionicons.informationCircle,\r\n                handler: () => {\r\n                    window.open(\"https://filen.io/faq\", \"_system\")\r\n\r\n                    return false\r\n                }\r\n            },\r\n            {\r\n                text: language.get(this.state.lang, \"tos\"),\r\n                icon: Ionicons.informationCircleOutline,\r\n                handler: () => {\r\n                    window.open(\"https://filen.io/terms\", \"_system\")\r\n\r\n                    return false\r\n                }\r\n            },\r\n            {\r\n                text: language.get(this.state.lang, \"privacyPolicy\"),\r\n                icon: Ionicons.informationCircleOutline,\r\n                handler: () => {\r\n                    window.open(\"https://filen.io/privacy\", \"_system\")\r\n\r\n                    return false\r\n                }\r\n            },\r\n            {\r\n                text: language.get(this.state.lang, \"cancel\"),\r\n                icon: \"close\",\r\n                role: \"cancel\"\r\n            }\r\n        ]\r\n\r\n        if(isPlatform(\"ios\")){\r\n            btns = [\r\n                {\r\n                    text: language.get(this.state.lang, \"support\"),\r\n                    icon: Ionicons.helpBuoyOutline,\r\n                    handler: () => {\r\n                        window.open(\"https://support.filen.io/\", \"_system\")\r\n\r\n                        return false\r\n                    }\r\n                },\r\n                {\r\n                    text: language.get(this.state.lang, \"cancel\"),\r\n                    icon: \"close\",\r\n                    role: \"cancel\"\r\n                }\r\n            ]\r\n        }\r\n\r\n        let actionSheet = await actionSheetController.create({\r\n            header: language.get(this.state.lang, \"help\"),\r\n            buttons: btns\r\n        })\r\n\r\n        return actionSheet.present()\r\n    }\r\n\r\n    window.customFunctions.queueFileUpload = this.queueFileUpload\r\n    window.customFunctions.queueFileDownload = this.queueFileDownload\r\n\r\n    window.customFunctions.openItemActionSheetFromJSON = (itemJSON) => {\r\n        let item = JSON.parse(window.atob(itemJSON))\r\n\r\n        return this.spawnItemActionSheet(item)\r\n    }\r\n\r\n    window.customFunctions.moveSelectedItems = () => {\r\n        return this.moveSelectedItems()\r\n    }\r\n\r\n    window.customFunctions.trashSelectedItems = () => {\r\n        return this.trashSelectedItems()\r\n    }\r\n\r\n    window.customFunctions.restoreSelectedItems = () => {\r\n        return this.restoreSelectedItems()\r\n    }\r\n\r\n    window.customFunctions.removeSelectedItemsFromSharedIn = () => {\r\n        return this.removeSelectedItemsFromSharedIn()\r\n    }\r\n\r\n    window.customFunctions.stopSharingSelectedItems = () => {\r\n        return this.stopSharingSelectedItems()\r\n    }\r\n\r\n    window.customFunctions.downloadSelectedItems = () => {\r\n        return this.downloadSelectedItems()\r\n    }\r\n\r\n    window.customFunctions.storeSelectedItemsOffline = () => {\r\n        return this.storeSelectedItemsOffline()\r\n    }\r\n\r\n    window.customFunctions.shareSelectedItems = () => {\r\n        return this.shareSelectedItems()\r\n    }\r\n\r\n    window.customFunctions.settingsToggleDarkMode = async () => {\r\n        if(this.state.darkMode){\r\n            await Plugins.Storage.set({ key: \"darkMode\", value: \"false\" })\r\n\r\n            document.getElementById(\"settings-dark-mode-toggle\").checked = false\r\n\r\n            return this.setState({\r\n                darkMode: false\r\n            }, () => {\r\n                document.location.href = \"index.html\"\r\n            })\r\n        }\r\n        else{\r\n            await Plugins.Storage.set({ key: \"darkMode\", value: \"true\" })\r\n\r\n            document.getElementById(\"settings-dark-mode-toggle\").checked = true\r\n\r\n            return this.setState({\r\n                darkMode: true\r\n            }, () => {\r\n                document.location.href = \"index.html\"\r\n            })\r\n        }\r\n    }\r\n\r\n    window.customFunctions.loginToggleDarkMode = async () => {\r\n        if(this.state.darkMode){\r\n            await Plugins.Storage.set({ key: \"darkMode\", value: \"false\" })\r\n\r\n            return this.setState({\r\n                darkMode: false\r\n            }, () => {\r\n                document.location.href = \"index.html\"\r\n            })\r\n        }\r\n        else{\r\n            await Plugins.Storage.set({ key: \"darkMode\", value: \"true\" })\r\n\r\n            return this.setState({\r\n                darkMode: true\r\n            }, () => {\r\n                document.location.href = \"index.html\"\r\n            })\r\n        }\r\n    }\r\n\r\n    window.customFunctions.saveSettings = async (newSettings) => {\r\n        await Plugins.Storage.set({ key: \"settings\", value: JSON.stringify(newSettings) })\r\n\r\n        return this.setState({\r\n            settings: newSettings\r\n        })\r\n    }\r\n\r\n    window.customFunctions.toggleOnlyWifi = () => {\r\n        let newSettings = this.state.settings\r\n        let newVal = !newSettings.onlyWifi\r\n\r\n        newSettings.onlyWifi = newVal\r\n\r\n        document.getElementById(\"settings-only-wifi-toggle\").checked = !newVal\r\n\r\n        return window.customFunctions.saveSettings(newSettings)\r\n    }\r\n\r\n    window.customFunctions.logoutUser = async () => {\r\n        await Plugins.Storage.remove({ key: \"isLoggedIn\" })\r\n        await Plugins.Storage.remove({ key: \"userAPIKey\" })\r\n        await Plugins.Storage.remove({ key: \"userEmail\" })\r\n        await Plugins.Storage.remove({ key: \"userMasterKeys\" })\r\n        await Plugins.Storage.remove({ key: \"userPublicKey\" })\r\n        await Plugins.Storage.remove({ key: \"userPrivateKey\" })\r\n        await Plugins.Storage.remove({ key: \"offlineSavedFiles\" })\r\n        await Plugins.Storage.remove({ key: \"apiCache\" })\r\n\r\n        return document.location.href = \"index.html\"\r\n    }\r\n\r\n    window.customFunctions.doLogout = async () => {\r\n        let alert = await alertController.create({\r\n            header: language.get(this.state.lang, \"logoutAlertHeader\"),\r\n            message: language.get(this.state.lang, \"logoutConfirmation\"),\r\n            buttons: [\r\n                {\r\n                    text: language.get(this.state.lang, \"cancel\"),\r\n                    role: \"cancel\",\r\n                    handler: () => {\r\n                        return false\r\n                    }\r\n                },\r\n                {\r\n                    text: language.get(this.state.lang, \"alertOkButton\"),\r\n                    handler: () => {\r\n                        return window.customFunctions.logoutUser()\r\n                    }\r\n                }\r\n            ]\r\n        })\r\n\r\n        return alert.present()\r\n    }\r\n\r\n    window.customFunctions.emptyTrash = async () => {\r\n        let alert = await alertController.create({\r\n            header: language.get(this.state.lang, \"emptyTrashHeader\"),\r\n            message: language.get(this.state.lang, \"emptyTrashWarning\"),\r\n            buttons: [\r\n                {\r\n                    text: language.get(this.state.lang, \"cancel\"),\r\n                    role: \"cancel\",\r\n                    handler: () => {\r\n                        return false\r\n                    }\r\n                },\r\n                {\r\n                    text: language.get(this.state.lang, \"alertOkButton\"),\r\n                    handler: async () => {\r\n                        let loading = await loadingController.create({\r\n                            message: \"\"\r\n                        })\r\n\r\n                        loading.present()\r\n\r\n                        try{\r\n                            var res = await utils.apiRequest(\"POST\", \"/v1/trash/empty\", {\r\n                                apiKey: this.state.userAPIKey\r\n                            })\r\n                        }\r\n                        catch(e){\r\n                            console.log(e)\r\n\r\n                            loading.dismiss()\r\n\r\n                            return this.spawnToast(language.get(this.state.lang, \"apiRequestError\"))\r\n                        }\r\n\r\n                        if(!res.status){\r\n                            console.log(res.message)\r\n\r\n                            loading.dismiss()\r\n\r\n                            return this.spawnToast(res.message)\r\n                        }\r\n\r\n                        loading.dismiss()\r\n\r\n                        this.updateItemList()\r\n\r\n                        return this.spawnToast(language.get(this.state.lang, \"trashEmptied\"))\r\n                    }\r\n                }\r\n            ]\r\n        })\r\n\r\n        return alert.present()\r\n    }\r\n\r\n    window.customFunctions.changeItemColor = async (itemJSON, color) => {\r\n        let item = JSON.parse(window.atob(itemJSON))\r\n\r\n        let loading = await loadingController.create({\r\n            message: \"\"\r\n        })\r\n    \r\n        loading.present()\r\n\r\n        try{\r\n            var res = await utils.apiRequest(\"POST\", \"/v1/dir/color/change\", {\r\n                apiKey: this.state.userAPIKey,\r\n                uuid: item.uuid,\r\n                color: color\r\n            })\r\n        }\r\n        catch(e){\r\n            console.log(e)\r\n    \r\n            loading.dismiss()\r\n    \r\n            return this.spawnToast(language.get(this.state.lang, \"apiRequestError\"))\r\n        }\r\n    \r\n        if(!res.status){\r\n            console.log(res.message)\r\n    \r\n            loading.dismiss()\r\n    \r\n            return this.spawnToast(res.message)\r\n        }\r\n\r\n        loading.dismiss()\r\n\r\n        try{\r\n            await this.updateItemList()\r\n        }\r\n        catch(e){\r\n            console.log(e)\r\n        }\r\n\r\n        return window.customFunctions.dismissModal()\r\n    }\r\n\r\n    window.customFunctions.editItemPublicLink = async (itemJSON, type, isEdit = false, currentLinkUUID = \"\") => {\r\n        let item = JSON.parse(window.atob(itemJSON))\r\n        let linkUUID = utils.uuidv4()\r\n\r\n        if(isEdit && typeof currentLinkUUID == \"string\"){\r\n            if(currentLinkUUID.length > 1){\r\n                linkUUID = currentLinkUUID\r\n            }\r\n        }\r\n\r\n        let loading = await loadingController.create({\r\n            message: \"\"\r\n        })\r\n    \r\n        loading.present()\r\n\r\n        let expires = \"never\"\r\n\r\n        if(typeof document.getElementById(\"public-link-expires-select\").value == \"string\"){\r\n            expires = document.getElementById(\"public-link-expires-select\").value\r\n        }\r\n\r\n        let password = \"empty\"\r\n\r\n        if(typeof document.getElementById(\"public-link-password-input\").value == \"string\"){\r\n            if(document.getElementById(\"public-link-password-input\").value){\r\n                password = document.getElementById(\"public-link-password-input\").value\r\n            }\r\n        }\r\n\r\n        let downloadBtn = \"enable\"\r\n\r\n        if(document.getElementById(\"public-link-enable-download-btn-toggle\") !== null){\r\n            if(!document.getElementById(\"public-link-enable-download-btn-toggle\").checked){\r\n                downloadBtn = \"disable\"\r\n            }\r\n        }\r\n        \r\n        if(item.type == \"file\"){\r\n            try{\r\n                var res = await utils.apiRequest(\"POST\", \"/v1/link/edit\", {\r\n                    apiKey: this.state.userAPIKey,\r\n                    uuid: linkUUID,\r\n                    fileUUID: item.uuid,\r\n                    expiration: expires,\r\n                    password: password,\r\n                    passwordHashed: utils.hashFn(password),\r\n                    downloadBtn: downloadBtn,\r\n                    type: type\r\n                })\r\n            }\r\n            catch(e){\r\n                console.log(e)\r\n        \r\n                loading.dismiss()\r\n        \r\n                return this.spawnToast(language.get(this.state.lang, \"apiRequestError\"))\r\n            }\r\n        \r\n            if(!res.status){\r\n                console.log(res.message)\r\n        \r\n                loading.dismiss()\r\n        \r\n                return this.spawnToast(res.message)\r\n            }\r\n\r\n            loading.dismiss()\r\n\r\n            document.getElementById(\"public-link-enabled-toggle\").checked = true\r\n            document.getElementById(\"public-link-input\").value = \"https://filen.io/d/\" + linkUUID + \"#!\" + item.key\r\n\r\n            if(type == \"enable\"){\r\n                document.getElementById(\"enable-public-link-content\").style.display = \"none\"\r\n                document.getElementById(\"public-link-enabled-content\").style.display = \"block\"\r\n            }\r\n            else{\r\n                document.getElementById(\"enable-public-link-content\").style.display = \"block\"\r\n                document.getElementById(\"public-link-enabled-content\").style.display = \"none\"\r\n\r\n                try{\r\n                    await this.updateItemList()\r\n                }\r\n                catch(e){\r\n                    console.log(e)\r\n                }\r\n            }\r\n\r\n            return true\r\n        }\r\n        else{\r\n            const removeFolderLink = async (callback) => {\r\n                let removeLoading = await loadingController.create({\r\n                    message: \"\"\r\n                })\r\n\r\n                removeLoading.present()\r\n\r\n                try{\r\n                    var res = await utils.apiRequest(\"POST\", \"/v1/dir/link/remove\", {\r\n                        apiKey: this.state.userAPIKey,\r\n                        uuid: item.uuid\r\n                    })\r\n                }\r\n                catch(e){\r\n                    console.log(e)\r\n            \r\n                    removeLoading.dismiss()\r\n            \r\n                    return callback(language.get(this.state.lang, \"apiRequestError\"))\r\n                }\r\n            \r\n                if(!res.status){\r\n                    console.log(res.message)\r\n            \r\n                    removeLoading.dismiss()\r\n            \r\n                    return callback(res.message)\r\n                }\r\n\r\n                removeLoading.dismiss()\r\n                \r\n                return callback(null)\r\n            }\r\n\r\n            const editFolderLink = async (callback) => {\r\n                let editLoading = await loadingController.create({\r\n                    message: \"\"\r\n                })\r\n\r\n                editLoading.present()\r\n\r\n                try{\r\n                    var res = await utils.apiRequest(\"POST\", \"/v1/dir/link/edit\", {\r\n                        apiKey: this.state.userAPIKey,\r\n                        uuid: item.uuid,\r\n                        expiration: expires,\r\n                        password: password,\r\n                        passwordHashed: utils.hashFn(password),\r\n                        downloadBtn: downloadBtn\r\n                    })\r\n                }\r\n                catch(e){\r\n                    console.log(e)\r\n            \r\n                    editLoading.dismiss()\r\n            \r\n                    return callback(language.get(this.state.lang, \"apiRequestError\"))\r\n                }\r\n            \r\n                if(!res.status){\r\n                    console.log(res.message)\r\n            \r\n                    editLoading.dismiss()\r\n            \r\n                    return callback(res.message)\r\n                }\r\n\r\n                editLoading.dismiss()\r\n                \r\n                return callback(null)\r\n            }\r\n\r\n            const createFolderLink = async (callback) => {\r\n                let createLoading = await loadingController.create({\r\n                    message: \"\",\r\n                    backdropDismiss: false\r\n                })\r\n\r\n                createLoading.present()\r\n\r\n                try{\r\n                    var res = await utils.apiRequest(\"POST\", \"/v1/download/dir\", {\r\n                        apiKey: this.state.userAPIKey,\r\n                        uuid: item.uuid\r\n                    })\r\n                }\r\n                catch(e){\r\n                    console.log(e)\r\n            \r\n                    createLoading.dismiss()\r\n            \r\n                    return callback(language.get(this.state.lang, \"apiRequestError\"))\r\n                }\r\n            \r\n                if(!res.status){\r\n                    console.log(res.message)\r\n            \r\n                    createLoading.dismiss()\r\n            \r\n                    return callback(res.message)\r\n                }\r\n\r\n                let key = utils.generateRandomString(32)\r\n                let keyEnc = utils.cryptoJSEncrypt(key, this.state.userMasterKeys[this.state.userMasterKeys.length - 1])\r\n                let newLinkUUID = utils.uuidv4()\r\n                let totalItems = (res.data.folders.length + res.data.files.length)\r\n                let doneItems = 0\r\n                let erroredItems = 0\r\n\r\n                const itemAdded = () => {\r\n                    doneItems += 1\r\n\r\n                    createLoading.message = language.get(this.state.lang, \"folderLinkAddedItemsCount\", true, [\"__ADDED__\", \"__TOTAL__\"], [doneItems, totalItems])\r\n\r\n                    if(doneItems >= totalItems){\r\n                        createLoading.dismiss()\r\n\r\n                        if(erroredItems > 0){\r\n                            console.log(\"Errored items: \" + erroredItems)\r\n                        }\r\n\r\n                        linkUUID = newLinkUUID\r\n            \r\n                        return callback(null , {\r\n                            linkUUID: linkUUID,\r\n                            linkKey: key\r\n                        })\r\n                    }\r\n                }\r\n\r\n                const addItemRequest = async (data, tries, maxTries, cb) => {\r\n                    if(tries >= maxTries){\r\n\t\t\t\t\t\treturn cb(language.get(this.state.lang, \"apiRequestError\"))\r\n                    }\r\n                    \r\n                    try{\r\n                        var res = await utils.apiRequest(\"POST\", \"/v1/dir/link/add\", data)\r\n                    }\r\n                    catch(e){\r\n                        console.log(e)\r\n                \r\n                        return setTimeout(() => {\r\n                            addItemRequest(data, (tries + 1), maxTries, cb)\r\n                        }, 1000)\r\n                    }\r\n                \r\n                    return cb(null)\r\n                }\r\n\r\n                const addItem = async (itemType, itemToAdd) => {\r\n                    await window.customVariables.shareItemSemaphore.acquire()\r\n\r\n                    let itemMetadata = \"\"\r\n\r\n\t\t\t\t\tif(itemType == \"file\"){\r\n\t\t\t\t\t\titemMetadata = utils.cryptoJSEncrypt(JSON.stringify({\r\n\t\t\t\t\t\t\tname: itemToAdd.name,\r\n\t\t\t\t\t\t\tmime: itemToAdd.mime,\r\n\t\t\t\t\t\t\tkey: itemToAdd.key,\r\n\t\t\t\t\t\t\tsize: parseInt(itemToAdd.size)\r\n\t\t\t\t\t\t}), key)\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\titemMetadata = utils.cryptoJSEncrypt(JSON.stringify({\r\n\t\t\t\t\t\t\tname: itemToAdd.name\r\n\t\t\t\t\t\t}), key)\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\taddItemRequest({\r\n\t\t\t\t\t\tapiKey: window.customVariables.apiKey,\r\n\t\t\t\t\t\tuuid: itemToAdd.uuid,\r\n\t\t\t\t\t\tparent: itemToAdd.parent,\r\n\t\t\t\t\t\tlinkUUID: newLinkUUID,\r\n\t\t\t\t\t\ttype: itemType,\r\n\t\t\t\t\t\tmetadata: itemMetadata,\r\n\t\t\t\t\t\tkey: keyEnc,\r\n\t\t\t\t\t\texpiration: \"never\",\r\n\t\t\t\t\t\tpassword: \"empty\",\r\n\t\t\t\t\t\tpasswordHashed: utils.hashFn(\"empty\"),\r\n\t\t\t\t\t\tdownloadBtn: \"enable\"\r\n\t\t\t\t\t}, 0, 32, (err) => {\r\n\t\t\t\t\t\twindow.customVariables.shareItemSemaphore.release()\r\n\r\n\t\t\t\t\t\tif(err){\r\n\t\t\t\t\t\t\tconsole.log(err)\r\n\r\n\t\t\t\t\t\t\terroredItems += 1\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\titemAdded()\r\n\t\t\t\t\t}) \r\n                }\r\n\r\n                for(let i = 0; i < res.data.folders.length; i++){\r\n\t\t\t\t\tlet folder = res.data.folders[i]\r\n\r\n                    await window.customVariables.decryptShareItemSemaphore.acquire()\r\n\r\n\t\t\t\t\taddItem(\"folder\", {\r\n\t\t\t\t\t\tuuid: folder.uuid,\r\n\t\t\t\t\t\tparent: folder.parent,\r\n\t\t\t\t\t\tname: utils.decryptCryptoJSFolderName(folder.name, this.state.userMasterKeys, folder.uuid)\r\n\t\t\t\t\t})\r\n\r\n\t\t\t\t\twindow.customVariables.decryptShareItemSemaphore.release()\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor(let i = 0; i < res.data.files.length; i++){\r\n\t\t\t\t\tlet file = res.data.files[i]\r\n\r\n\t\t\t\t\tawait window.customVariables.decryptShareItemSemaphore.acquire()\r\n\r\n\t\t\t\t\tlet fileMetadata = utils.decryptFileMetadata(file.metadata, this.state.userMasterKeys, file.uuid)\r\n\r\n\t\t\t\t\taddItem(\"file\", {\r\n\t\t\t\t\t\tuuid: file.uuid,\r\n\t\t\t\t\t\tparent: file.parent,\r\n\t\t\t\t\t\tname: fileMetadata.name,\r\n\t\t\t\t\t\tmime: fileMetadata.mime,\r\n\t\t\t\t\t\tkey: fileMetadata.key,\r\n\t\t\t\t\t\tsize: fileMetadata.size\r\n\t\t\t\t\t})\r\n\r\n\t\t\t\t\twindow.customVariables.decryptShareItemSemaphore.release()\r\n\t\t\t\t}\r\n            }\r\n\r\n            loading.dismiss()\r\n\r\n            if(type == \"enable\"){\r\n                if(isEdit){\r\n                    editFolderLink((err) => {\r\n                        if(err){\r\n                            return this.spawnToast(language.get(this.state.lang, \"apiRequestError\"))\r\n                        }\r\n                    })\r\n                }\r\n                else{\r\n                    createFolderLink((err, linkData) => {\r\n                        if(err){\r\n                            return this.spawnToast(language.get(this.state.lang, \"apiRequestError\"))\r\n                        }\r\n    \r\n                        document.getElementById(\"public-link-enabled-toggle\").checked = true\r\n                        document.getElementById(\"public-link-input\").value = \"https://filen.io/f/\" + linkData.linkUUID + \"#!\" + linkData.linkKey\r\n\r\n                        document.getElementById(\"enable-public-link-content\").style.display = \"none\"\r\n                        document.getElementById(\"public-link-enabled-content\").style.display = \"block\"\r\n                    })\r\n                }\r\n            }\r\n            else{\r\n                removeFolderLink((err) => {\r\n                    if(err){\r\n                        return this.spawnToast(language.get(this.state.lang, \"apiRequestError\"))\r\n                    }\r\n\r\n                    document.getElementById(\"enable-public-link-content\").style.display = \"block\"\r\n                    document.getElementById(\"public-link-enabled-content\").style.display = \"none\"\r\n\r\n                    this.updateItemList()\r\n                })\r\n            }\r\n\r\n            return true\r\n        }\r\n    }\r\n\r\n    window.customFunctions.copyPublicLinkToClipboard = async () => {\r\n        if(!Capacitor.isNative){\r\n            try{\r\n                utils.copyTextToClipboardWeb(document.getElementById(\"public-link-input\").value)\r\n            }\r\n            catch(e){\r\n                console.log(e)\r\n    \r\n                return this.spawnToast(language.get(this.state.lang, \"couldNotCopyToClipboard\")) \r\n            }\r\n    \r\n            return this.spawnToast(language.get(this.state.lang, \"copiedToClipboard\"))\r\n        }\r\n\r\n        try{\r\n            let link = document.getElementById(\"public-link-input\").value\r\n\r\n            await Plugins.Clipboard.write({\r\n                url: link\r\n            })\r\n        }\r\n        catch(e){\r\n            console.log(e)\r\n\r\n            return this.spawnToast(language.get(this.state.lang, \"couldNotCopyToClipboard\")) \r\n        }\r\n\r\n        return this.spawnToast(language.get(this.state.lang, \"copiedToClipboard\")) \r\n    }\r\n\r\n    window.customFunctions.clearThumbnailCache = async () => {\r\n        let alert = await alertController.create({\r\n            header: language.get(this.state.lang, \"settingsClearThumbnailCacheHeader\"),\r\n            message: language.get(this.state.lang, \"settingsClearThumbnailCacheInfo\"),\r\n            buttons: [\r\n                {\r\n                    text: language.get(this.state.lang, \"cancel\"),\r\n                    role: \"cancel\",\r\n                    handler: () => {\r\n                        return false\r\n                    }\r\n                },\r\n                {\r\n                    text: language.get(this.state.lang, \"alertOkButton\"),\r\n                    handler: async () => {\r\n                        if(!Capacitor.isNative){\r\n                            return alert.dismiss()\r\n                        }\r\n\r\n                        let dirObj = {\r\n                            path: \"ThumbnailCache/\",\r\n                            directory: FilesystemDirectory.External\r\n                        }\r\n\r\n                        alert.dismiss()\r\n\r\n                        try{\r\n                            await Plugins.Filesystem.rmdir({\r\n                                path: dirObj.path,\r\n                                directory: dirObj.directory,\r\n                                recursive: true\r\n                            })\r\n\r\n                            window.customVariables.thumbnailCache = {}\r\n                            window.customVariables.thumbnailBlobCache = {}\r\n                            window.customVariables.lastThumbnailCacheLength = undefined\r\n\r\n                            window.customFunctions.saveThumbnailCache()\r\n                        }\r\n                        catch(e){\r\n                            console.log(e)\r\n                        }\r\n\r\n                        return this.spawnToast(language.get(this.state.lang, \"settingsClearThumbnailCacheDone\"))\r\n                    }\r\n                }\r\n            ]\r\n        })\r\n\r\n        return alert.present()\r\n    }\r\n\r\n    window.customFunctions.openOrderBy = async () => {\r\n        let alert = await alertController.create({\r\n            header: language.get(this.state.lang, \"orderBy\"),\r\n            inputs: [\r\n                {\r\n                    type: \"radio\",\r\n                    label: language.get(this.state.lang, \"orderByName\"),\r\n                    value: \"name\",\r\n                    checked: (window.customVariables.orderBy.indexOf(\"name\") !== -1 ? true : false)\r\n                },\r\n                {\r\n                    type: \"radio\",\r\n                    label: language.get(this.state.lang, \"orderBySize\"),\r\n                    value: \"size\",\r\n                    checked: (window.customVariables.orderBy.indexOf(\"size\") !== -1 ? true : false)\r\n                },\r\n                {\r\n                    type: \"radio\",\r\n                    label: language.get(this.state.lang, \"orderByDate\"),\r\n                    value: \"date\",\r\n                    checked: (window.customVariables.orderBy.indexOf(\"date\") !== -1 ? true : false)\r\n                },\r\n                {\r\n                    type: \"radio\",\r\n                    label: language.get(this.state.lang, \"orderByType\"),\r\n                    value: \"type\",\r\n                    checked: (window.customVariables.orderBy.indexOf(\"type\") !== -1 ? true : false)\r\n                }\r\n            ],\r\n            buttons: [\r\n                {\r\n                    text: language.get(this.state.lang, \"cancel\"),\r\n                    role: \"cancel\",\r\n                    handler: () => {\r\n                        return false\r\n                    }\r\n                },\r\n                {\r\n                    text: language.get(this.state.lang, \"orderByReset\"),\r\n                    handler: () => {\r\n                        let sortedItems = utils.orderItemsByType(this.state.itemList, \"dateDesc\")\r\n\r\n                        window.customVariables.orderBy = \"nameAsc\"\r\n                        window.customVariables.itemList = sortedItems\r\n\r\n                        return this.setState({\r\n                            itemList: sortedItems\r\n                        }, () => {\r\n                            this.forceUpdate()\r\n                        })\r\n                    }\r\n                },\r\n                {\r\n                    text: language.get(this.state.lang, \"alertOkButton\"),\r\n                    handler: async (type) => {\r\n                        let alert = await alertController.create({\r\n                            header: language.get(this.state.lang, \"orderByDirection\"),\r\n                            inputs: [\r\n                                {\r\n                                    type: \"radio\",\r\n                                    label: language.get(this.state.lang, \"orderByDirectionAsc\"),\r\n                                    value: \"Asc\",\r\n                                    checked: (window.customVariables.orderBy.indexOf(\"Asc\") !== -1 ? true : false)\r\n                                },\r\n                                {\r\n                                    type: \"radio\",\r\n                                    label: language.get(this.state.lang, \"orderByDirectionDesc\"),\r\n                                    value: \"Desc\",\r\n                                    checked: (window.customVariables.orderBy.indexOf(\"Desc\") !== -1 ? true : false)\r\n                                }\r\n                            ],\r\n                            buttons: [\r\n                                {\r\n                                    text: language.get(this.state.lang, \"cancel\"),\r\n                                    role: \"cancel\",\r\n                                    handler: () => {\r\n                                        return false\r\n                                    }\r\n                                },\r\n                                {\r\n                                    text: language.get(this.state.lang, \"alertOkButton\"),\r\n                                    handler: (direction) => {\r\n                                        let typeAndDirection = type + direction\r\n\r\n                                        console.log(typeAndDirection)\r\n\r\n                                        let sortedItems = utils.orderItemsByType(this.state.itemList, typeAndDirection)\r\n                \r\n                                        window.customVariables.orderBy = typeAndDirection\r\n                                        window.customVariables.itemList = sortedItems\r\n                \r\n                                        return this.setState({\r\n                                            itemList: sortedItems\r\n                                        }, () => {\r\n                                            this.forceUpdate()\r\n                                        })\r\n                                    }\r\n                                }\r\n                            ]\r\n                        })\r\n\r\n                        return alert.present()\r\n                    }\r\n                }\r\n            ]\r\n        })\r\n\r\n        window.customFunctions.dismissPopover()\r\n\r\n        return alert.present()\r\n    }\r\n}"]},"metadata":{},"sourceType":"module"}